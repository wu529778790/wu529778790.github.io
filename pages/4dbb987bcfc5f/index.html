<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>从实战出发，从 0 到 1 构建一个符合标准的公共库 | 神族九帝&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="web前端技术博客,简洁至上,专注web前端学习与总结。JavaScript,js,ES6,TypeScript,vue,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="code-yywEP2q5jK">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.acf465bc.css" as="style"><link rel="preload" href="/assets/js/app.6f32355a.js" as="script"><link rel="preload" href="/assets/js/3.1b204256.js" as="script"><link rel="preload" href="/assets/js/162.13cca27d.js" as="script"><link rel="prefetch" href="/assets/js/1.b79f6464.js"><link rel="prefetch" href="/assets/js/10.8c55266b.js"><link rel="prefetch" href="/assets/js/100.88faff32.js"><link rel="prefetch" href="/assets/js/101.1592c682.js"><link rel="prefetch" href="/assets/js/102.6518ceb0.js"><link rel="prefetch" href="/assets/js/103.cd5065a6.js"><link rel="prefetch" href="/assets/js/104.1123b4e9.js"><link rel="prefetch" href="/assets/js/105.ccd5a63c.js"><link rel="prefetch" href="/assets/js/106.81988c57.js"><link rel="prefetch" href="/assets/js/107.8a646636.js"><link rel="prefetch" href="/assets/js/108.b7afe936.js"><link rel="prefetch" href="/assets/js/109.b0752e30.js"><link rel="prefetch" href="/assets/js/11.10fafd8c.js"><link rel="prefetch" href="/assets/js/110.5a308e48.js"><link rel="prefetch" href="/assets/js/111.189b5a54.js"><link rel="prefetch" href="/assets/js/112.db870ac5.js"><link rel="prefetch" href="/assets/js/113.bf1ebc68.js"><link rel="prefetch" href="/assets/js/114.7860efc0.js"><link rel="prefetch" href="/assets/js/115.34c51867.js"><link rel="prefetch" href="/assets/js/116.97be8bba.js"><link rel="prefetch" href="/assets/js/117.4d5a10bf.js"><link rel="prefetch" href="/assets/js/118.6c6a76f4.js"><link rel="prefetch" href="/assets/js/119.dc3c2ea1.js"><link rel="prefetch" href="/assets/js/12.141c6a7c.js"><link rel="prefetch" href="/assets/js/120.92eecb8c.js"><link rel="prefetch" href="/assets/js/121.7b9c3657.js"><link rel="prefetch" href="/assets/js/122.f6b5d289.js"><link rel="prefetch" href="/assets/js/123.61c25c57.js"><link rel="prefetch" href="/assets/js/124.302ee0b5.js"><link rel="prefetch" href="/assets/js/125.975de502.js"><link rel="prefetch" href="/assets/js/126.45b64331.js"><link rel="prefetch" href="/assets/js/127.763c2a56.js"><link rel="prefetch" href="/assets/js/128.88ee6335.js"><link rel="prefetch" href="/assets/js/129.a58a64b9.js"><link rel="prefetch" href="/assets/js/13.da863508.js"><link rel="prefetch" href="/assets/js/130.54121522.js"><link rel="prefetch" href="/assets/js/131.aca2d708.js"><link rel="prefetch" href="/assets/js/132.1756e101.js"><link rel="prefetch" href="/assets/js/133.12db2891.js"><link rel="prefetch" href="/assets/js/134.757602d2.js"><link rel="prefetch" href="/assets/js/135.fb98f363.js"><link rel="prefetch" href="/assets/js/136.3cff0f4d.js"><link rel="prefetch" href="/assets/js/137.36fd107d.js"><link rel="prefetch" href="/assets/js/138.49509f7e.js"><link rel="prefetch" href="/assets/js/139.5d534c03.js"><link rel="prefetch" href="/assets/js/14.8ca70db2.js"><link rel="prefetch" href="/assets/js/140.e89f2f4d.js"><link rel="prefetch" href="/assets/js/141.e829b906.js"><link rel="prefetch" href="/assets/js/142.98e7aaee.js"><link rel="prefetch" href="/assets/js/143.1a65ec12.js"><link rel="prefetch" href="/assets/js/144.fc2c801e.js"><link rel="prefetch" href="/assets/js/145.ecd75a5b.js"><link rel="prefetch" href="/assets/js/146.69cc2143.js"><link rel="prefetch" href="/assets/js/147.a6021905.js"><link rel="prefetch" href="/assets/js/148.37a4f153.js"><link rel="prefetch" href="/assets/js/149.0a2441a8.js"><link rel="prefetch" href="/assets/js/15.dc33b636.js"><link rel="prefetch" href="/assets/js/150.e8388075.js"><link rel="prefetch" href="/assets/js/151.a4ebf84b.js"><link rel="prefetch" href="/assets/js/152.15e23325.js"><link rel="prefetch" href="/assets/js/153.57e02e73.js"><link rel="prefetch" href="/assets/js/154.ba69127e.js"><link rel="prefetch" href="/assets/js/155.98ebe21a.js"><link rel="prefetch" href="/assets/js/156.113ec037.js"><link rel="prefetch" href="/assets/js/157.fa80da63.js"><link rel="prefetch" href="/assets/js/158.b1b74414.js"><link rel="prefetch" href="/assets/js/159.40b68f4f.js"><link rel="prefetch" href="/assets/js/16.c098c1fa.js"><link rel="prefetch" href="/assets/js/160.3830ac97.js"><link rel="prefetch" href="/assets/js/161.9d4f7012.js"><link rel="prefetch" href="/assets/js/163.df4a6f84.js"><link rel="prefetch" href="/assets/js/164.bf27f0b0.js"><link rel="prefetch" href="/assets/js/165.c7b8cafa.js"><link rel="prefetch" href="/assets/js/166.3f217dd7.js"><link rel="prefetch" href="/assets/js/167.735e05d9.js"><link rel="prefetch" href="/assets/js/168.c575d903.js"><link rel="prefetch" href="/assets/js/169.3e8adc50.js"><link rel="prefetch" href="/assets/js/17.7437eb7d.js"><link rel="prefetch" href="/assets/js/170.f6d2e13d.js"><link rel="prefetch" href="/assets/js/171.d14168d4.js"><link rel="prefetch" href="/assets/js/172.16bd452f.js"><link rel="prefetch" href="/assets/js/173.c37e1e0f.js"><link rel="prefetch" href="/assets/js/174.15963486.js"><link rel="prefetch" href="/assets/js/175.975777ee.js"><link rel="prefetch" href="/assets/js/176.2517981a.js"><link rel="prefetch" href="/assets/js/177.1358e1ee.js"><link rel="prefetch" href="/assets/js/178.ab5f3594.js"><link rel="prefetch" href="/assets/js/179.09ba373d.js"><link rel="prefetch" href="/assets/js/18.835bef0b.js"><link rel="prefetch" href="/assets/js/180.9a7ec7cb.js"><link rel="prefetch" href="/assets/js/181.c79e50d9.js"><link rel="prefetch" href="/assets/js/182.23755a00.js"><link rel="prefetch" href="/assets/js/183.4449a6de.js"><link rel="prefetch" href="/assets/js/184.f83dc12a.js"><link rel="prefetch" href="/assets/js/185.65cf0c33.js"><link rel="prefetch" href="/assets/js/186.36ff7e5d.js"><link rel="prefetch" href="/assets/js/187.5472a769.js"><link rel="prefetch" href="/assets/js/188.988e7dba.js"><link rel="prefetch" href="/assets/js/189.31359ed4.js"><link rel="prefetch" href="/assets/js/19.4c3c8195.js"><link rel="prefetch" href="/assets/js/190.fdd64806.js"><link rel="prefetch" href="/assets/js/191.92498652.js"><link rel="prefetch" href="/assets/js/192.4834fa75.js"><link rel="prefetch" href="/assets/js/193.add31334.js"><link rel="prefetch" href="/assets/js/194.f12564a1.js"><link rel="prefetch" href="/assets/js/195.ffe31af5.js"><link rel="prefetch" href="/assets/js/196.6e446bf2.js"><link rel="prefetch" href="/assets/js/197.3a41a0a8.js"><link rel="prefetch" href="/assets/js/198.641bae3d.js"><link rel="prefetch" href="/assets/js/199.ebd03ef7.js"><link rel="prefetch" href="/assets/js/2.7266734b.js"><link rel="prefetch" href="/assets/js/20.ec5e4cf7.js"><link rel="prefetch" href="/assets/js/200.5cb868f3.js"><link rel="prefetch" href="/assets/js/201.19a87590.js"><link rel="prefetch" href="/assets/js/202.b618c8f5.js"><link rel="prefetch" href="/assets/js/203.0fbc9ac5.js"><link rel="prefetch" href="/assets/js/204.1457be89.js"><link rel="prefetch" href="/assets/js/205.a86b5230.js"><link rel="prefetch" href="/assets/js/206.881c82dc.js"><link rel="prefetch" href="/assets/js/207.3b0206d0.js"><link rel="prefetch" href="/assets/js/208.ed47ec02.js"><link rel="prefetch" href="/assets/js/209.99f97bdb.js"><link rel="prefetch" href="/assets/js/21.9188d311.js"><link rel="prefetch" href="/assets/js/210.bb7acf71.js"><link rel="prefetch" href="/assets/js/211.2e81be95.js"><link rel="prefetch" href="/assets/js/212.89ab703d.js"><link rel="prefetch" href="/assets/js/213.50276242.js"><link rel="prefetch" href="/assets/js/214.7f108614.js"><link rel="prefetch" href="/assets/js/215.6574a133.js"><link rel="prefetch" href="/assets/js/216.af9e8210.js"><link rel="prefetch" href="/assets/js/217.76057d83.js"><link rel="prefetch" href="/assets/js/218.55f67111.js"><link rel="prefetch" href="/assets/js/219.ffacadfe.js"><link rel="prefetch" href="/assets/js/22.37e5e389.js"><link rel="prefetch" href="/assets/js/220.5a5c5787.js"><link rel="prefetch" href="/assets/js/221.4eb8395e.js"><link rel="prefetch" href="/assets/js/222.62e527e3.js"><link rel="prefetch" href="/assets/js/223.1f1e7b4b.js"><link rel="prefetch" href="/assets/js/224.2259db70.js"><link rel="prefetch" href="/assets/js/225.91a5f216.js"><link rel="prefetch" href="/assets/js/226.a13c50f9.js"><link rel="prefetch" href="/assets/js/227.de470de3.js"><link rel="prefetch" href="/assets/js/228.5a80e5fb.js"><link rel="prefetch" href="/assets/js/229.efff5960.js"><link rel="prefetch" href="/assets/js/23.d9976b2c.js"><link rel="prefetch" href="/assets/js/230.5fbb8bb7.js"><link rel="prefetch" href="/assets/js/231.95c8ff44.js"><link rel="prefetch" href="/assets/js/232.19219fac.js"><link rel="prefetch" href="/assets/js/233.8b78e75a.js"><link rel="prefetch" href="/assets/js/234.3f914b2e.js"><link rel="prefetch" href="/assets/js/235.95ddd74d.js"><link rel="prefetch" href="/assets/js/236.7c4a59be.js"><link rel="prefetch" href="/assets/js/237.57371aaf.js"><link rel="prefetch" href="/assets/js/238.392a568c.js"><link rel="prefetch" href="/assets/js/239.f14d65f8.js"><link rel="prefetch" href="/assets/js/24.55ad5b7c.js"><link rel="prefetch" href="/assets/js/240.ebf3009f.js"><link rel="prefetch" href="/assets/js/241.5fb81b73.js"><link rel="prefetch" href="/assets/js/242.a7e25549.js"><link rel="prefetch" href="/assets/js/243.f74b3d4e.js"><link rel="prefetch" href="/assets/js/244.f95f77a7.js"><link rel="prefetch" href="/assets/js/245.53678547.js"><link rel="prefetch" href="/assets/js/246.39ebec6c.js"><link rel="prefetch" href="/assets/js/247.d6a2a18e.js"><link rel="prefetch" href="/assets/js/248.07736c3d.js"><link rel="prefetch" href="/assets/js/249.c8fd3339.js"><link rel="prefetch" href="/assets/js/25.011fc197.js"><link rel="prefetch" href="/assets/js/250.ba6ef5e1.js"><link rel="prefetch" href="/assets/js/251.3aa84692.js"><link rel="prefetch" href="/assets/js/252.38cdae28.js"><link rel="prefetch" href="/assets/js/253.041ddb67.js"><link rel="prefetch" href="/assets/js/254.9053aa71.js"><link rel="prefetch" href="/assets/js/255.86ccc408.js"><link rel="prefetch" href="/assets/js/256.b8365b1d.js"><link rel="prefetch" href="/assets/js/257.7f3fb60b.js"><link rel="prefetch" href="/assets/js/258.48a58ecf.js"><link rel="prefetch" href="/assets/js/259.edc72a7a.js"><link rel="prefetch" href="/assets/js/26.3cb3c5af.js"><link rel="prefetch" href="/assets/js/260.c78cbad0.js"><link rel="prefetch" href="/assets/js/261.b7c3d231.js"><link rel="prefetch" href="/assets/js/262.d7bcdae5.js"><link rel="prefetch" href="/assets/js/263.db764fa1.js"><link rel="prefetch" href="/assets/js/264.6a94bf4f.js"><link rel="prefetch" href="/assets/js/265.5f0e9c03.js"><link rel="prefetch" href="/assets/js/266.ff6b094d.js"><link rel="prefetch" href="/assets/js/267.04e7cb80.js"><link rel="prefetch" href="/assets/js/268.38b5f5a6.js"><link rel="prefetch" href="/assets/js/269.9ee4cd2e.js"><link rel="prefetch" href="/assets/js/27.7e232e2c.js"><link rel="prefetch" href="/assets/js/270.16a33f1e.js"><link rel="prefetch" href="/assets/js/271.f4d164b0.js"><link rel="prefetch" href="/assets/js/272.791fecfb.js"><link rel="prefetch" href="/assets/js/273.22a788bf.js"><link rel="prefetch" href="/assets/js/274.03fc79c3.js"><link rel="prefetch" href="/assets/js/275.7bd56154.js"><link rel="prefetch" href="/assets/js/276.2de6a69e.js"><link rel="prefetch" href="/assets/js/277.7ca05f6c.js"><link rel="prefetch" href="/assets/js/278.f0ee63c0.js"><link rel="prefetch" href="/assets/js/279.609eb7d9.js"><link rel="prefetch" href="/assets/js/28.32f1341e.js"><link rel="prefetch" href="/assets/js/280.e0e3a930.js"><link rel="prefetch" href="/assets/js/281.abad37c8.js"><link rel="prefetch" href="/assets/js/282.1501b44f.js"><link rel="prefetch" href="/assets/js/283.0558a3c4.js"><link rel="prefetch" href="/assets/js/284.756846db.js"><link rel="prefetch" href="/assets/js/285.bf31d51d.js"><link rel="prefetch" href="/assets/js/286.defd2a92.js"><link rel="prefetch" href="/assets/js/287.c67805d0.js"><link rel="prefetch" href="/assets/js/288.c457a47a.js"><link rel="prefetch" href="/assets/js/289.0afb1f12.js"><link rel="prefetch" href="/assets/js/29.f6301882.js"><link rel="prefetch" href="/assets/js/290.837b3179.js"><link rel="prefetch" href="/assets/js/291.8ca62fcf.js"><link rel="prefetch" href="/assets/js/292.e9a93680.js"><link rel="prefetch" href="/assets/js/293.cf0a52c6.js"><link rel="prefetch" href="/assets/js/294.0cdd1975.js"><link rel="prefetch" href="/assets/js/295.c8c7a0e2.js"><link rel="prefetch" href="/assets/js/296.4710615a.js"><link rel="prefetch" href="/assets/js/297.7e434981.js"><link rel="prefetch" href="/assets/js/298.27800acc.js"><link rel="prefetch" href="/assets/js/299.94524a20.js"><link rel="prefetch" href="/assets/js/30.457633e7.js"><link rel="prefetch" href="/assets/js/31.7ec68579.js"><link rel="prefetch" href="/assets/js/32.eef7ba01.js"><link rel="prefetch" href="/assets/js/33.80351101.js"><link rel="prefetch" href="/assets/js/34.16c10f0d.js"><link rel="prefetch" href="/assets/js/35.9f765814.js"><link rel="prefetch" href="/assets/js/36.2ebf9dea.js"><link rel="prefetch" href="/assets/js/37.1fc1164f.js"><link rel="prefetch" href="/assets/js/38.b6adb462.js"><link rel="prefetch" href="/assets/js/39.d93e83cf.js"><link rel="prefetch" href="/assets/js/4.2ac0ca3e.js"><link rel="prefetch" href="/assets/js/40.d706107a.js"><link rel="prefetch" href="/assets/js/41.fc02d2b6.js"><link rel="prefetch" href="/assets/js/42.7cab86d5.js"><link rel="prefetch" href="/assets/js/43.ef9cd246.js"><link rel="prefetch" href="/assets/js/44.a0569c2e.js"><link rel="prefetch" href="/assets/js/45.5fafe2cf.js"><link rel="prefetch" href="/assets/js/46.03f46ad7.js"><link rel="prefetch" href="/assets/js/47.df256cdb.js"><link rel="prefetch" href="/assets/js/48.65a60760.js"><link rel="prefetch" href="/assets/js/49.04fe57d4.js"><link rel="prefetch" href="/assets/js/5.a6226436.js"><link rel="prefetch" href="/assets/js/50.8651dd04.js"><link rel="prefetch" href="/assets/js/51.7662caaf.js"><link rel="prefetch" href="/assets/js/52.166e0a74.js"><link rel="prefetch" href="/assets/js/53.4afd7699.js"><link rel="prefetch" href="/assets/js/54.9a917c2c.js"><link rel="prefetch" href="/assets/js/55.5fa482d9.js"><link rel="prefetch" href="/assets/js/56.f6d194cf.js"><link rel="prefetch" href="/assets/js/57.a784f860.js"><link rel="prefetch" href="/assets/js/58.dd4202bd.js"><link rel="prefetch" href="/assets/js/59.25fbb8f7.js"><link rel="prefetch" href="/assets/js/6.b0755d77.js"><link rel="prefetch" href="/assets/js/60.d1e2af36.js"><link rel="prefetch" href="/assets/js/61.61571afd.js"><link rel="prefetch" href="/assets/js/62.1f1a3b47.js"><link rel="prefetch" href="/assets/js/63.6bfff3b4.js"><link rel="prefetch" href="/assets/js/64.71d4a416.js"><link rel="prefetch" href="/assets/js/65.617890e7.js"><link rel="prefetch" href="/assets/js/66.65920bca.js"><link rel="prefetch" href="/assets/js/67.001f760c.js"><link rel="prefetch" href="/assets/js/68.82192159.js"><link rel="prefetch" href="/assets/js/69.d4cb8bca.js"><link rel="prefetch" href="/assets/js/7.20d8bda4.js"><link rel="prefetch" href="/assets/js/70.24090621.js"><link rel="prefetch" href="/assets/js/71.405a13d9.js"><link rel="prefetch" href="/assets/js/72.dd8add1c.js"><link rel="prefetch" href="/assets/js/73.2bd91ddf.js"><link rel="prefetch" href="/assets/js/74.17ff1ebb.js"><link rel="prefetch" href="/assets/js/75.24e8d319.js"><link rel="prefetch" href="/assets/js/76.2414719f.js"><link rel="prefetch" href="/assets/js/77.77779e67.js"><link rel="prefetch" href="/assets/js/78.b262a06e.js"><link rel="prefetch" href="/assets/js/79.f02d599e.js"><link rel="prefetch" href="/assets/js/80.a1114b22.js"><link rel="prefetch" href="/assets/js/81.348cdb2b.js"><link rel="prefetch" href="/assets/js/82.957cb300.js"><link rel="prefetch" href="/assets/js/83.5c997e13.js"><link rel="prefetch" href="/assets/js/84.1274a110.js"><link rel="prefetch" href="/assets/js/85.a6e36a7f.js"><link rel="prefetch" href="/assets/js/86.9436b1a1.js"><link rel="prefetch" href="/assets/js/87.4e607f33.js"><link rel="prefetch" href="/assets/js/88.9a83dc3a.js"><link rel="prefetch" href="/assets/js/89.b0499d00.js"><link rel="prefetch" href="/assets/js/90.495af3b2.js"><link rel="prefetch" href="/assets/js/91.29907c15.js"><link rel="prefetch" href="/assets/js/92.5c148247.js"><link rel="prefetch" href="/assets/js/93.0e481e18.js"><link rel="prefetch" href="/assets/js/94.85777854.js"><link rel="prefetch" href="/assets/js/95.2baa77e2.js"><link rel="prefetch" href="/assets/js/96.a641e6ee.js"><link rel="prefetch" href="/assets/js/97.9ec64eb5.js"><link rel="prefetch" href="/assets/js/98.fb1e8cdc.js"><link rel="prefetch" href="/assets/js/99.39208b0d.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.3894b547.js">
    <link rel="stylesheet" href="/assets/css/0.styles.acf465bc.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="神族九帝's blog" class="logo"> <span class="site-name can-hide">神族九帝's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="导航" class="dropdown-title"><!----> <span class="title" style="display:;">导航</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://docs.qq.com/sheet/DV09NbXlvQW5QVHpp?tab=BB08J2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  神卡套餐
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://wallpaper.shenzjd.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  壁纸
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://alist.shenzjd.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  网盘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试题" class="dropdown-title"><!----> <span class="title" style="display:;">面试题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/d4fd303b96708/" class="nav-link">面试突击</a></li><li class="dropdown-item"><!----> <a href="/pages/92a3d01d007d4/" class="nav-link">复习指导</a></li><li class="dropdown-item"><!----> <a href="/pages/41925dd005aac/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/pages/b7bfe8372b67a/" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/pages/873bcbd19d49b/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/pages/d35a839d5b4b6/" class="nav-link">设计模式</a></li><li class="dropdown-item"><!----> <a href="/pages/62502f3dd8041/" class="nav-link">浏览器</a></li><li class="dropdown-item"><!----> <a href="/pages/462a20be0048a/" class="nav-link">手写系列</a></li><li class="dropdown-item"><!----> <a href="/pages/7860f2c6dd001/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/pages/b9014c6cc5abc/" class="nav-link">Webpack</a></li><li class="dropdown-item"><!----> <a href="/pages/5ff5a12bd4bd2/" class="nav-link">Http</a></li><li class="dropdown-item"><!----> <a href="/pages/274217c7c2876/" class="nav-link">前端优化</a></li><li class="dropdown-item"><!----> <a href="/pages/318726d3f6062/" class="nav-link">项目</a></li><li class="dropdown-item"><!----> <a href="/pages/0d28ab62c07b1/" class="nav-link">面试真题</a></li><li class="dropdown-item"><!----> <a href="/pages/9eaae444f0d5b/" class="nav-link">算法</a></li><li class="dropdown-item"><!----> <a href="/pages/96c5de658a426/" class="nav-link">精选文章</a></li><li class="dropdown-item"><!----> <a href="/pages/11309122e2911/" class="nav-link">八股文</a></li><li class="dropdown-item"><!----> <a href="/pages/294378a3e4f4/" class="nav-link">前端工程化</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记" class="dropdown-title"><!----> <span class="title" style="display:;">笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/b7de4855154b1/" class="nav-link">工作笔记</a></li><li class="dropdown-item"><!----> <a href="/pages/664ab7712895e/" class="nav-link">前端基础建设与架构 30 讲</a></li><li class="dropdown-item"><!----> <a href="/pages/de5e42d9aade5/" class="nav-link">vue2源码学习</a></li><li class="dropdown-item"><!----> <a href="/pages/9a973ad8de378/" class="nav-link">剖析vuejs内部运行机制</a></li><li class="dropdown-item"><!----> <a href="/pages/7b9593fc1d246/" class="nav-link">TypeScript 入门实战笔记</a></li><li class="dropdown-item"><!----> <a href="/pages/1b26a2a3224ed/" class="nav-link">vue3源码学习</a></li><li class="dropdown-item"><!----> <a href="/pages/6840ffe53b64e/" class="nav-link">2周刷完100道前端优质面试真题</a></li><li class="dropdown-item"><!----> <a href="/pages/b2402e45f8434/" class="nav-link">思维导图</a></li><li class="dropdown-item"><!----> <a href="/pages/df8208be80149/" class="nav-link">npm发包</a></li><li class="dropdown-item"><!----> <a href="/pages/9d3cce63f5b1f/" class="nav-link">重学node</a></li><li class="dropdown-item"><!----> <a href="/pages/82d13321f862e/" class="nav-link">前端性能优化方法与实战</a></li><li class="dropdown-item"><!----> <a href="/pages/70523322e3de7/" class="nav-link">webpack原理与实战</a></li><li class="dropdown-item"><!----> <a href="/pages/201ade54239a8/" class="nav-link">webGl</a></li><li class="dropdown-item"><!----> <a href="/pages/493b3e94e222f/" class="nav-link">前端优化</a></li><li class="dropdown-item"><!----> <a href="/pages/9215dd598cf2f/" class="nav-link">Web3</a></li><li class="dropdown-item"><!----> <a href="/pages/654a66a46648a/" class="nav-link">更多</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="服务器" class="dropdown-title"><!----> <span class="title" style="display:;">服务器</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/559a89ed185a/" class="nav-link">未来要做的事</a></li><li class="dropdown-item"><!----> <a href="/pages/3643ef45ec2df/" class="nav-link">Stirling-PDF</a></li><li class="dropdown-item"><!----> <a href="/pages/84b570b268311/" class="nav-link">ComfyUI</a></li><li class="dropdown-item"><!----> <a href="/pages/266a6e0607e5b/" class="nav-link">富强</a></li><li class="dropdown-item"><!----> <a href="/pages/48f2f48705e84/" class="nav-link">宝塔面板+青龙面板</a></li><li class="dropdown-item"><!----> <a href="/pages/fd345053693da/" class="nav-link">安卓手机当服务器使用</a></li><li class="dropdown-item"><!----> <a href="/pages/fabb9a071e3ab/" class="nav-link">京东自动评价代码</a></li><li class="dropdown-item"><!----> <a href="/pages/4e2e100aa5bc3/" class="nav-link">搭建x-ui免流服务器(已失效)</a></li><li class="dropdown-item"><!----> <a href="/pages/1ec52a9aef382/" class="nav-link">海外联盟</a></li><li class="dropdown-item"><!----> <a href="/pages/4f8522f268cc3/" class="nav-link">好玩的docker</a></li><li class="dropdown-item"><!----> <a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏夹</a></li><li class="dropdown-item"><!----> <a href="/pages/f9ef4c6a6f4e/" class="nav-link">更多</a></li></ul></div></div> <a href="https://github.com/wu529778790/wu529778790.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/logo.png"> <div class="blogger-info"><h3>神族九帝,永不言弃</h3> <span></span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="导航" class="dropdown-title"><!----> <span class="title" style="display:;">导航</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://docs.qq.com/sheet/DV09NbXlvQW5QVHpp?tab=BB08J2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  神卡套餐
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://wallpaper.shenzjd.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  壁纸
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://alist.shenzjd.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  网盘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试题" class="dropdown-title"><!----> <span class="title" style="display:;">面试题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/d4fd303b96708/" class="nav-link">面试突击</a></li><li class="dropdown-item"><!----> <a href="/pages/92a3d01d007d4/" class="nav-link">复习指导</a></li><li class="dropdown-item"><!----> <a href="/pages/41925dd005aac/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/pages/b7bfe8372b67a/" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/pages/873bcbd19d49b/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/pages/d35a839d5b4b6/" class="nav-link">设计模式</a></li><li class="dropdown-item"><!----> <a href="/pages/62502f3dd8041/" class="nav-link">浏览器</a></li><li class="dropdown-item"><!----> <a href="/pages/462a20be0048a/" class="nav-link">手写系列</a></li><li class="dropdown-item"><!----> <a href="/pages/7860f2c6dd001/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/pages/b9014c6cc5abc/" class="nav-link">Webpack</a></li><li class="dropdown-item"><!----> <a href="/pages/5ff5a12bd4bd2/" class="nav-link">Http</a></li><li class="dropdown-item"><!----> <a href="/pages/274217c7c2876/" class="nav-link">前端优化</a></li><li class="dropdown-item"><!----> <a href="/pages/318726d3f6062/" class="nav-link">项目</a></li><li class="dropdown-item"><!----> <a href="/pages/0d28ab62c07b1/" class="nav-link">面试真题</a></li><li class="dropdown-item"><!----> <a href="/pages/9eaae444f0d5b/" class="nav-link">算法</a></li><li class="dropdown-item"><!----> <a href="/pages/96c5de658a426/" class="nav-link">精选文章</a></li><li class="dropdown-item"><!----> <a href="/pages/11309122e2911/" class="nav-link">八股文</a></li><li class="dropdown-item"><!----> <a href="/pages/294378a3e4f4/" class="nav-link">前端工程化</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记" class="dropdown-title"><!----> <span class="title" style="display:;">笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/b7de4855154b1/" class="nav-link">工作笔记</a></li><li class="dropdown-item"><!----> <a href="/pages/664ab7712895e/" class="nav-link">前端基础建设与架构 30 讲</a></li><li class="dropdown-item"><!----> <a href="/pages/de5e42d9aade5/" class="nav-link">vue2源码学习</a></li><li class="dropdown-item"><!----> <a href="/pages/9a973ad8de378/" class="nav-link">剖析vuejs内部运行机制</a></li><li class="dropdown-item"><!----> <a href="/pages/7b9593fc1d246/" class="nav-link">TypeScript 入门实战笔记</a></li><li class="dropdown-item"><!----> <a href="/pages/1b26a2a3224ed/" class="nav-link">vue3源码学习</a></li><li class="dropdown-item"><!----> <a href="/pages/6840ffe53b64e/" class="nav-link">2周刷完100道前端优质面试真题</a></li><li class="dropdown-item"><!----> <a href="/pages/b2402e45f8434/" class="nav-link">思维导图</a></li><li class="dropdown-item"><!----> <a href="/pages/df8208be80149/" class="nav-link">npm发包</a></li><li class="dropdown-item"><!----> <a href="/pages/9d3cce63f5b1f/" class="nav-link">重学node</a></li><li class="dropdown-item"><!----> <a href="/pages/82d13321f862e/" class="nav-link">前端性能优化方法与实战</a></li><li class="dropdown-item"><!----> <a href="/pages/70523322e3de7/" class="nav-link">webpack原理与实战</a></li><li class="dropdown-item"><!----> <a href="/pages/201ade54239a8/" class="nav-link">webGl</a></li><li class="dropdown-item"><!----> <a href="/pages/493b3e94e222f/" class="nav-link">前端优化</a></li><li class="dropdown-item"><!----> <a href="/pages/9215dd598cf2f/" class="nav-link">Web3</a></li><li class="dropdown-item"><!----> <a href="/pages/654a66a46648a/" class="nav-link">更多</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="服务器" class="dropdown-title"><!----> <span class="title" style="display:;">服务器</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/559a89ed185a/" class="nav-link">未来要做的事</a></li><li class="dropdown-item"><!----> <a href="/pages/3643ef45ec2df/" class="nav-link">Stirling-PDF</a></li><li class="dropdown-item"><!----> <a href="/pages/84b570b268311/" class="nav-link">ComfyUI</a></li><li class="dropdown-item"><!----> <a href="/pages/266a6e0607e5b/" class="nav-link">富强</a></li><li class="dropdown-item"><!----> <a href="/pages/48f2f48705e84/" class="nav-link">宝塔面板+青龙面板</a></li><li class="dropdown-item"><!----> <a href="/pages/fd345053693da/" class="nav-link">安卓手机当服务器使用</a></li><li class="dropdown-item"><!----> <a href="/pages/fabb9a071e3ab/" class="nav-link">京东自动评价代码</a></li><li class="dropdown-item"><!----> <a href="/pages/4e2e100aa5bc3/" class="nav-link">搭建x-ui免流服务器(已失效)</a></li><li class="dropdown-item"><!----> <a href="/pages/1ec52a9aef382/" class="nav-link">海外联盟</a></li><li class="dropdown-item"><!----> <a href="/pages/4f8522f268cc3/" class="nav-link">好玩的docker</a></li><li class="dropdown-item"><!----> <a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏夹</a></li><li class="dropdown-item"><!----> <a href="/pages/f9ef4c6a6f4e/" class="nav-link">更多</a></li></ul></div></div> <a href="https://github.com/wu529778790/wu529778790.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工作笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>前端基础建设与架构 30 讲</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/664ab7712895e/" class="sidebar-link">开篇词  像架构师一样思考，突破技术成长瓶颈</a></li><li><a href="/pages/49cd9ababc9a1/" class="sidebar-link">npm 安装机制及企业级部署私服原理</a></li><li><a href="/pages/09fbf8a1156b8/" class="sidebar-link">Yarn 的安装理念及如何破解依赖管理困境</a></li><li><a href="/pages/10f2ebc91b73c/" class="sidebar-link">CI 环境上的 npm 优化及更多工程化问题解析</a></li><li><a href="/pages/245300f457539/" class="sidebar-link">横向对比主流构建工具，了解构建工具的设计考量</a></li><li><a href="/pages/a094da54e65f/" class="sidebar-link">Vite 实现：从源码分析出发，构建 bundlele 开发工程</a></li><li><a href="/pages/3bbfdc8e7cf4/" class="sidebar-link">core-j 及垫片理念：设计一个“最完美”的 Polyfill 方案</a></li><li><a href="/pages/a0e586d6898f9/" class="sidebar-link">梳理混乱的 Babel，不再被编译报错困扰</a></li><li><a href="/pages/3caede772e761/" class="sidebar-link">探索前端工具链生态，制定一个统一标准化 babel-preet</a></li><li><a href="/pages/4dbb987bcfc5f/" aria-current="page" class="active sidebar-link">从实战出发，从 0 到 1 构建一个符合标准的公共库</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/7f9d7786e6aa1/" class="sidebar-link">代码拆分和按需加载：缩减 bundle ize，把性能做到极致</a></li><li><a href="/pages/d7a25227c33fc/" class="sidebar-link">Tree Shaking：移除 JavaScript 上下文中的未引用代码</a></li><li><a href="/pages/d0d381c1e284e/" class="sidebar-link">如何理解 AST 实现和编译原理？</a></li><li><a href="/pages/773169c96a412/" class="sidebar-link">工程化思维处理方案：如何实现应用主题切换功能？</a></li><li><a href="/pages/943231620daa3/" class="sidebar-link">解析 Webpack 源码，实现自己的构建工具</a></li><li><a href="/pages/12102b0892053/" class="sidebar-link">从编译到运行，跨端解析小程序多端方案</a></li><li><a href="/pages/22b509db57f1a/" class="sidebar-link">原生跨平台技术：移动端跨平台到 Flutter 的技术变革</a></li><li><a href="/pages/20b426615a1c8/" class="sidebar-link">学习 axio：封装一个结构清晰的 Fetch 库</a></li><li><a href="/pages/3c41f5dcb7811/" class="sidebar-link">对比 Koa 和 Redux：分析前端中的中间件理念</a></li><li><a href="/pages/328eaba5cae39/" class="sidebar-link">如何理解软件开发灵活性和高定制性？</a></li><li><a href="/pages/8df5b32829fc9/" class="sidebar-link">如何理解前端中面向对象的思想？</a></li><li><a href="/pages/55d7058b01d3d/" class="sidebar-link">如何利用 JavaScript 实现经典数据结构？</a></li><li><a href="/pages/073be8a8552d5/" class="sidebar-link">剖析前端中的数据结构应用场景</a></li><li><a href="/pages/8fad03ebb05b2/" class="sidebar-link">npm cript：打造一体化的构建和部署流程</a></li><li><a href="/pages/d07bdbfe6f9ce/" class="sidebar-link">自动化代码检查：剖析 Lint 工具和工程化接入&amp;优化方案</a></li><li><a href="/pages/378f678a7284b/" class="sidebar-link">如何设计一个前端 + 移动端离线包方案？</a></li><li><a href="/pages/c4145a056135d/" class="sidebar-link">如何设计一个“万能”项目脚手架？</a></li><li><a href="/pages/c78977462af88/" class="sidebar-link">同构渲染架构：实现一个 SSR 应用</a></li><li><a href="/pages/6287d534540ad/" class="sidebar-link">设计性能守卫系统：完善 CICD 流程</a></li><li><a href="/pages/5418c92e818e/" class="sidebar-link">实践打造网关：改造企业 BFF 方案</a></li><li><a href="/pages/eeb2a33385edd/" class="sidebar-link">实现高可用：使用 Puppeteer 生成性能最优的海报系统</a></li><li><a href="/pages/b559221c07262/" class="sidebar-link">结束语  再谈项目的基建和架构，个人的价值和方向</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>vue2源码学习</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>剖析vuejs内部运行机制</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript 入门实战笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>vue3源码学习</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2周刷完100道前端优质面试真题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>思维导图</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>npm发包</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>重学node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端性能优化方法与实战</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webpack原理与实战</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webGl</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端优化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Web3</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>更多</span> <span class="arrow right"></span></p> <!----></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- 正方形 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-071ed482><div class="articleInfo" data-v-071ed482><ul class="breadcrumbs" data-v-071ed482><li data-v-071ed482><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-071ed482></a></li> <li data-v-071ed482><a href="/categories/?category=%E7%AC%94%E8%AE%B0" title="分类" data-v-071ed482>笔记</a></li> <li data-v-071ed482><a href="/categories/?category=%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E5%BB%BA%E8%AE%BE%E4%B8%8E%E6%9E%B6%E6%9E%84%2030%20%E8%AE%B2" title="分类" data-v-071ed482>前端基础建设与架构 30 讲</a></li> <!----></ul> <div class="info" data-v-071ed482><div title="作者" class="author iconfont icon-touxiang" data-v-071ed482><a href="https://shenzjd.com" target="_blank" title="作者" class="beLink" data-v-071ed482>wu529778790</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-071ed482><a href="javascript:;" data-v-071ed482>2024-04-07</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">
          从实战出发，从 0 到 1 构建一个符合标准的公共库
        </h1> <div class="page-slot page-slot-top"><!-- 固定100% * 90px可显示，max-height:90px未见显示-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><p data-nodeid="1489">上一讲我们从 Babel 编译预设的角度理清了前端生态中的公共库和应用的丝缕关联，这一讲我们就从实战出发，动手剖析一个公共库从设计到完成的过程。</p> <p data-nodeid="1490">（源码出处：<a href="https://github.com/intricatecloud/reusable-js-demo" data-nodeid="1608">Creating a simple npm library to use in and out of the browser）</a></p> <h3 data-nodeid="1491">实战打造一个公共库</h3> <p data-nodeid="1492">下面我们从实战出发，从 0 到 1 构建一个符合标准的公共库。我们的目标是，借助 <a href="https://github.com/public-apis/public-apis" data-nodeid="1613">Public APIs</a>，通过网络请求获取 dogs/cats/goats 三种动物的随机图像，并进行展示。更重要的是，将整个逻辑过程抽象成可以在浏览器端和 Node.js 端复用的 npm 包，编译构建使用 Webpack 和 Babel。</p> <p data-nodeid="1493">首先创建文件：</p> <pre data-nodeid="1494" class="lang-java"><code data-language="java">$ mkdir animal-api
$ cd animal-api
$ npm init
</code></pre> <p data-nodeid="1495">并通过 npm init 初始化一个 package.json 文件：</p> <pre data-nodeid="1496" class="lang-java"><code data-language="java">{
  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;animal-api&quot;</span>,
  <span class="hljs-string">&quot;version&quot;</span>: <span class="hljs-string">&quot;1.0.0&quot;</span>,
  <span class="hljs-string">&quot;description&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,
  <span class="hljs-string">&quot;main&quot;</span>: <span class="hljs-string">&quot;index.js&quot;</span>,
  <span class="hljs-string">&quot;scripts&quot;</span>: {
    <span class="hljs-string">&quot;test&quot;</span>: <span class="hljs-string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>
  },
  <span class="hljs-string">&quot;author&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,
  <span class="hljs-string">&quot;license&quot;</span>: <span class="hljs-string">&quot;ISC&quot;</span>
}
</code></pre> <p data-nodeid="1497">编写<code data-backticks="1" data-nodeid="1618">index.js</code>代码逻辑非常简单，如下：</p> <pre data-nodeid="1498" class="lang-java"><code data-language="java"><span class="hljs-keyword">import</span> axios from <span class="hljs-string">'axios'</span>;
<span class="hljs-keyword">const</span> getCat = () =&gt; {
    <span class="hljs-comment">// 发送请求</span>
    <span class="hljs-keyword">return</span> axios.get(<span class="hljs-string">'https://aws.random.cat/meow'</span>).then((response) =&gt; {
        <span class="hljs-keyword">const</span> imageSrc = response.data.file
        <span class="hljs-keyword">const</span> text = <span class="hljs-string">'CAT'</span>
        <span class="hljs-keyword">return</span> {imageSrc, text}
    })
}
<span class="hljs-keyword">const</span> getDog = () =&gt; {
    <span class="hljs-keyword">return</span> axios.get(<span class="hljs-string">'https://random.dog/woof.json'</span>).then((response) =&gt; {
        <span class="hljs-keyword">const</span> imageSrc = response.data.url
        <span class="hljs-keyword">const</span> text = <span class="hljs-string">'DOG'</span>
        <span class="hljs-keyword">return</span> {imageSrc, text}
    })
}
<span class="hljs-keyword">const</span> getGoat = () =&gt; {
    <span class="hljs-keyword">const</span> imageSrc = <span class="hljs-string">'http://placegoat.com/200'</span>
    <span class="hljs-keyword">const</span> text = <span class="hljs-string">'GOAT'</span>
    <span class="hljs-keyword">return</span> Promise.resolve({imageSrc, text})
}
export <span class="hljs-keyword">default</span> {
    getDog,
    getCat,
    getGoat
}
</code></pre> <p data-nodeid="1499">我们通过三个接口：</p> <ul data-nodeid="1500"><li data-nodeid="1501"><p data-nodeid="1502">https://aws.random.cat/meow</p></li> <li data-nodeid="1503"><p data-nodeid="1504">https://random.dog/woof.json</p></li> <li data-nodeid="1505"><p data-nodeid="1506">http://placegoat.com/200</p></li></ul> <p data-nodeid="1507">封装了三个获取图片地址的函数：</p> <ul data-nodeid="1508"><li data-nodeid="1509"><p data-nodeid="1510">getDog()</p></li> <li data-nodeid="1511"><p data-nodeid="1512">getCat()</p></li> <li data-nodeid="1513"><p data-nodeid="1514">getGoat()</p></li></ul> <p data-nodeid="1515"><a href="https://github.com/intricatecloud/reusable-js-demo" data-nodeid="1630">源码</a>通过 ESM 的方式提供对外接口，请你注意这里的模块化方式，这是一个公共库设计的关键点之一，后文会更详细解析。</p> <p data-nodeid="1516">对公共库来说，质量保证至关重要。我们使用 Jest 来进行 animal-api 这个公共库的单元测试。Jest 作为 devDependecies 被安装，代码如下：</p> <pre data-nodeid="1517" class="lang-java"><code data-language="java">npm install --save-dev jest
</code></pre> <p data-nodeid="1518">编写测试脚本<code data-backticks="1" data-nodeid="1634">animal-api/spec/index.spec.js</code>：</p> <pre data-nodeid="1519" class="lang-java"><code data-language="java"><span class="hljs-keyword">import</span> AnimalApi from <span class="hljs-string">'../index'</span>
describe(<span class="hljs-string">'animal-api'</span>, () =&gt; {
    it(<span class="hljs-string">'gets dogs'</span>, () =&gt; {
        <span class="hljs-keyword">return</span> AnimalApi.getDog()
            .then((animal) =&gt; {
                expect(animal.imageSrc).not.toBeUndefined()
                expect(animal.text).toEqual(<span class="hljs-string">'DOG'</span>)
            })
   })
})
</code></pre> <p data-nodeid="1520">改写 package.json 中 test script 为 &quot;test&quot;: &quot;jest&quot;，我们通过运行<code data-backticks="1" data-nodeid="1645">npm run test</code>来测试。</p> <p data-nodeid="1521">这时候会得到报错：SyntaxError: Unexpected identifier，如下图所示：</p> <p data-nodeid="1522"><img src="https://s0.lgstatic.com/i/image/M00/8D/0B/Ciqc1F_4C52AbkzPAAJt3nzLhAo939.png" alt="Drawing 0.png" data-nodeid="1650"></p> <p data-nodeid="1523">不要慌，这是因为 Jest 并不“认识”import 这样的关键字。Jest 运行在 Node.js 环境中，大部分 Node.js 版本（v10 以下）运行时并不支持 ESM，为了可以使用 ESM 方式编写测试脚本，我们需要<strong data-nodeid="1656">安装 babel-jest 和 Babel 相关依赖到开发环境中</strong>：</p> <pre data-nodeid="1524" class="lang-java"><code data-language="java">npm install --save-dev babel-jest <span class="hljs-meta">@babel</span>/core <span class="hljs-meta">@babel</span>/preset-env
</code></pre> <p data-nodeid="1525">同时创建<code data-backticks="1" data-nodeid="1658">babel.config.js</code>，内容如下：</p> <pre data-nodeid="1526" class="lang-java"><code data-language="java"><span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {
  presets: [
    [
      <span class="hljs-string">'@babel/preset-env'</span>,
      {
        targets: {
          node: <span class="hljs-string">'current'</span>,
        },
      },
    ],
  ],
};
</code></pre> <p data-nodeid="1527">注意上述代码，我们将 @babel/preset-env 的 targets.node 属性设置为当前环境 current。再次执行<code data-backticks="1" data-nodeid="1661">npm run test</code>，得到报错如下：Cannot find module 'axios' from 'index.js'。</p> <p data-nodeid="1528"><img src="https://s0.lgstatic.com/i/image/M00/8D/0B/Ciqc1F_4C6iABmVIAAGxme4pZVw996.png" alt="Drawing 1.png" data-nodeid="1673"></p> <p data-nodeid="1529">原因看报错信息即可得到，我们需要安装 axios。注意：axios 应该作为生产依赖被安装：</p> <pre data-nodeid="1530" class="lang-java"><code data-language="java">npm install --save axios
</code></pre> <p data-nodeid="1531">现在，我们的测试脚本就可以正常运行了。如下图：</p> <p data-nodeid="1532"><img src="https://s0.lgstatic.com/i/image/M00/8D/16/CgqCHl_4C7CAd4ITAAJD5qJ-Ziw380.png" alt="Drawing 2.png" data-nodeid="1678"></p> <p data-nodeid="1533">当然，这只是给公共库接入测试，“万里长征”才开始第一步。接下来我们按照各种场景进行更多探索。</p> <h3 data-nodeid="1534">打造公共库，支持 script 标签引入</h3> <p data-nodeid="1535">在大部分不支持 import 语法特性的浏览器中，为了让我们的脚本直接在浏览器中使用 script 标签引入代码，首先我们<strong data-nodeid="1686">需要将已有公共库脚本编译为 UMD 方式</strong>。类似上面使用 babel-jest 将测试脚本编译降级为当前 Node.js 版本支持的代码，我们还是需要 Babel 进行降级。</p> <p data-nodeid="1536">注意这次不同之处在于：<strong data-nodeid="1694">这里的降级需要输出代码内容到一个 output 目录中，浏览器即可直接引入该 output 目录中的编译后资源</strong>。我们使用<code data-backticks="1" data-nodeid="1692">@babel/plugin-transform-modules-umd</code>来完成对代码的降级编译：</p> <pre data-nodeid="1537" class="lang-java"><code data-language="java">$ npm install --save-dev <span class="hljs-meta">@babel</span>/plugin-transform-modules-umd <span class="hljs-meta">@babel</span>/core <span class="hljs-meta">@babel</span>/cli
</code></pre> <p data-nodeid="1538">同时在 package.json 中加入相关 script 内容：<code data-backticks="1" data-nodeid="1696">&quot;build&quot;: &quot;babel index.js -d lib&quot;</code>，执行<code data-backticks="1" data-nodeid="1698">npm run build</code>，得到产出（如下图）：</p> <p data-nodeid="1539"><img src="https://s0.lgstatic.com/i/image/M00/8D/0B/Ciqc1F_4C7iARwtEAAEQS1jliOM385.png" alt="Drawing 3.png" data-nodeid="1702"></p> <p data-nodeid="1540">我们在浏览器中验证产出：</p> <pre data-nodeid="1541" class="lang-java"><code data-language="java">&lt;script src=&quot;./lib/index.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
    AnimalApi.getDog().then(function(animal) {
        document.querySelector('#imageSrc').textContent = animal.imageSrc
        document.querySelector('#text').textContent = animal.text
    })
&lt;/script&gt;
</code></pre> <p data-nodeid="1542">结果出现了报错：</p> <pre data-nodeid="1543" class="lang-java"><code data-language="java">index.html:<span class="hljs-number">11</span> Uncaught ReferenceError: AnimalApi is not defined
    at index.html:<span class="hljs-number">11</span>
</code></pre> <p data-nodeid="1544">并没有找到 AnimalApi 这个对象，重新翻看编译产出源码：</p> <pre data-nodeid="1545" class="lang-java"><code data-language="java"><span class="hljs-string">&quot;use strict&quot;</span>;
Object.defineProperty(<span class="hljs-keyword">exports</span>, <span class="hljs-string">&quot;__esModule&quot;</span>, {
  value: <span class="hljs-keyword">true</span>
});
<span class="hljs-keyword">exports</span>.<span class="hljs-keyword">default</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;
<span class="hljs-comment">// 引入 axios</span>
<span class="hljs-keyword">var</span> _axios = _interopRequireDefault(require(<span class="hljs-string">&quot;axios&quot;</span>));
<span class="hljs-comment">//  兼容 default 导出</span>
<span class="hljs-function">function <span class="hljs-title">_interopRequireDefault</span><span class="hljs-params">(obj)</span> </span>{ <span class="hljs-keyword">return</span> obj &amp;&amp; obj.__esModule ? obj : { <span class="hljs-keyword">default</span>: obj }; }
<span class="hljs-comment">// 原 getCat 方法</span>
<span class="hljs-keyword">const</span> getCat = () =&gt; {
  <span class="hljs-keyword">return</span> _axios.<span class="hljs-keyword">default</span>.get(<span class="hljs-string">'https://aws.random.cat/meow'</span>).then(response =&gt; {
    <span class="hljs-keyword">const</span> imageSrc = response.data.file;
    <span class="hljs-keyword">const</span> text = <span class="hljs-string">'CAT'</span>;
    <span class="hljs-keyword">return</span> {
      imageSrc,
      text
    };
  });
};
<span class="hljs-comment">// 原 getDog 方法</span>
<span class="hljs-keyword">const</span> getDog = () =&gt; {
  <span class="hljs-keyword">return</span> _axios.<span class="hljs-keyword">default</span>.get(<span class="hljs-string">'https://random.dog/woof.json'</span>).then(response =&gt; {
    <span class="hljs-keyword">const</span> imageSrc = response.data.url;
    <span class="hljs-keyword">const</span> text = <span class="hljs-string">'DOG'</span>;
    <span class="hljs-keyword">return</span> {
      imageSrc,
      text
    };
  });
};
<span class="hljs-comment">// 原 getGoat 方法</span>
<span class="hljs-keyword">const</span> getGoat = () =&gt; {
  <span class="hljs-keyword">const</span> imageSrc = <span class="hljs-string">'http://placegoat.com/200'</span>;
  <span class="hljs-keyword">const</span> text = <span class="hljs-string">'GOAT'</span>;
  <span class="hljs-keyword">return</span> Promise.resolve({
    imageSrc,
    text
  });
};
<span class="hljs-comment">// 默认导出对象</span>
<span class="hljs-keyword">var</span> _default = {
  getDog,
  getCat,
  getGoat
};
<span class="hljs-keyword">exports</span>.<span class="hljs-keyword">default</span> = _default;
</code></pre> <p data-nodeid="1546">发现出现报错是因为 Babel 的编译产出如果要支持全局命名（AnimalApi）空间，需要添加以下配置：</p> <pre data-nodeid="1547" class="lang-java"><code data-language="java">  plugins: [
      [<span class="hljs-string">&quot;@babel/plugin-transform-modules-umd&quot;</span>, {
      exactGlobals: <span class="hljs-keyword">true</span>,
      globals: {
        index: <span class="hljs-string">'AnimalApi'</span>
      }
    }]
  ],
</code></pre> <p data-nodeid="1548">调整后再运行编译，得到源码：</p> <pre data-nodeid="1549" class="lang-java"><code data-language="java"><span class="hljs-comment">// umd 导出格式</span>
(function (global, factory) {
  <span class="hljs-comment">// 兼容 amd 方式</span>
  <span class="hljs-keyword">if</span> (typeof define === <span class="hljs-string">&quot;function&quot;</span> &amp;&amp; define.amd) {
    define([<span class="hljs-string">&quot;exports&quot;</span>, <span class="hljs-string">&quot;axios&quot;</span>], factory);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (typeof <span class="hljs-keyword">exports</span> !== <span class="hljs-string">&quot;undefined&quot;</span>) {
    factory(<span class="hljs-keyword">exports</span>, require(<span class="hljs-string">&quot;axios&quot;</span>));
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> mod = {
      <span class="hljs-keyword">exports</span>: {}
    };
    factory(mod.<span class="hljs-keyword">exports</span>, global.axios);
    <span class="hljs-comment">// 挂载 AnimalApi 对象</span>
    global.AnimalApi = mod.<span class="hljs-keyword">exports</span>;
  }
})(typeof globalThis !== <span class="hljs-string">&quot;undefined&quot;</span> ? globalThis : typeof self !== <span class="hljs-string">&quot;undefined&quot;</span> ? self : <span class="hljs-keyword">this</span>, function (_exports, _axios) {
  <span class="hljs-string">&quot;use strict&quot;</span>;
  Object.defineProperty(_exports, <span class="hljs-string">&quot;__esModule&quot;</span>, {
    value: <span class="hljs-keyword">true</span>
  });
  _exports.<span class="hljs-keyword">default</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;
  _axios = _interopRequireDefault(_axios);
  <span class="hljs-comment">// 兼容 default 导出</span>
  <span class="hljs-function">function <span class="hljs-title">_interopRequireDefault</span><span class="hljs-params">(obj)</span> </span>{ <span class="hljs-keyword">return</span> obj &amp;&amp; obj.__esModule ? obj : { <span class="hljs-keyword">default</span>: obj }; }
  <span class="hljs-keyword">const</span> getCat = () =&gt; {
    <span class="hljs-keyword">return</span> _axios.<span class="hljs-keyword">default</span>.get(<span class="hljs-string">'https://aws.random.cat/meow'</span>).then(response =&gt; {
      <span class="hljs-keyword">const</span> imageSrc = response.data.file;
      <span class="hljs-keyword">const</span> text = <span class="hljs-string">'CAT'</span>;
      <span class="hljs-keyword">return</span> {
        imageSrc,
        text
      };
    });
  };
  <span class="hljs-keyword">const</span> getDog = () =&gt; {
    <span class="hljs-comment">// ... 省略</span>
  };
  <span class="hljs-keyword">const</span> getGoat = () =&gt; {
    <span class="hljs-comment">// ... 省略</span>
  };
  <span class="hljs-keyword">var</span> _default = {
    getDog,
    getCat,
    getGoat
  };
  _exports.<span class="hljs-keyword">default</span> = _default;
});
</code></pre> <p data-nodeid="1550">这时，<strong data-nodeid="1713">编译源码产出内容改为了由一个 IIFE 形式实现的命名空间</strong>。同时观察源码：</p> <pre data-nodeid="1551" class="lang-java"><code data-language="java">global.AnimalApi = mod.<span class="hljs-keyword">exports</span>;
...
<span class="hljs-keyword">var</span> _default = {
    getDog,
    getCat,
    getGoat
  };
  _exports.<span class="hljs-keyword">default</span> = _default;
</code></pre> <p data-nodeid="1552">为了兼容 ESM 特性，导出内容全部挂在了 default 属性中（可以通过 libraryExport 属性来切换），我们的引用方式需要改为：</p> <pre data-nodeid="1553" class="lang-java"><code data-language="java">AnimalApi.<span class="hljs-keyword">default</span>.getDog().then(function(animal) {
    ...
})
</code></pre> <p data-nodeid="1554">解决了以上所有问题，看似大功告成了，但是工程的设计没有这么简单。事实上，<strong data-nodeid="1724">在源码中，我们没有使用引入并编译 index.js 所需要的依赖</strong>，比如 axios 并没有被引入处理。正确的方式应该是<strong data-nodeid="1725">把公共库需要的依赖，一并按照依赖关系进行打包和引入</strong>。</p> <p data-nodeid="1555">为了解决上面这个问题，此时需要引入 Webpack：</p> <pre data-nodeid="1556" class="lang-java"><code data-language="java">npm install --save-dev webpack webpack-cli
</code></pre> <p data-nodeid="1557">同时添加<code data-backticks="1" data-nodeid="1728">webpack.config.js</code>，内容为：</p> <pre data-nodeid="1558" class="lang-java"><code data-language="java"><span class="hljs-keyword">const</span> path = require(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {
  entry: <span class="hljs-string">'./index.js'</span>,
  output: {
    path: path.resolve(__dirname, <span class="hljs-string">'lib'</span>),
    filename: <span class="hljs-string">'animal-api.js'</span>,
    library: <span class="hljs-string">'AnimalApi'</span>,
    libraryTarget: <span class="hljs-string">'var'</span>
  },
};
</code></pre> <p data-nodeid="1559">我们设置入口为<code data-backticks="1" data-nodeid="1731">./index.js</code>，构建产出为<code data-backticks="1" data-nodeid="1733">./lib/animal-api.js</code>，同时通过设置 library 和 libraryTarget 将 AnimalApi 作为公共库对外暴露的命名空间。修改<code data-backticks="1" data-nodeid="1735">package.json</code>中的 build script 为<code data-backticks="1" data-nodeid="1737">&quot;build&quot;: &quot;webpack&quot;</code>，执行<code data-backticks="1" data-nodeid="1739">npm run build</code>，得到产出，如下图：</p> <p data-nodeid="1560"><img src="https://s0.lgstatic.com/i/image2/M01/04/EE/Cip5yF_4C9GAfFJAAAYFu4ci4cM274.png" alt="Drawing 4.png" data-nodeid="1743"></p> <p data-nodeid="1561">至此，我们终于构造出了能够在浏览器中通过 script 标签引入的公共库。当然，一个现代化的公共库还需要支持更多场景，请继续阅读。</p> <h3 data-nodeid="1562">打造公共库，支持 Node.js 环境</h3> <p data-nodeid="1563">现在已经完成了公共库的浏览器端支持，下面我们要集中精力适配一下 Node.js 环境了。</p> <p data-nodeid="1564">首先编写一个<code data-backticks="1" data-nodeid="1748">node.test.js</code>文件，进行 Node.js 环境的验证：</p> <pre data-nodeid="1565" class="lang-java"><code data-language="java"><span class="hljs-keyword">const</span> AnimalApi = require(<span class="hljs-string">'./index.js'</span>)
AnimalApi.getCat().then(animal =&gt; {
    console.log(animal)
})
</code></pre> <p data-nodeid="1566">这个文件的意义在于<strong data-nodeid="1757">测试公共库是否能在 Node.js 环境下使用</strong>。执行<code data-backticks="1" data-nodeid="1755">node node-test.js</code>，不出意料得到报错，如下图：</p> <p data-nodeid="1567"><img src="https://s0.lgstatic.com/i/image2/M01/04/EE/Cip5yF_4C9iAVDQkAANk3PGzLdI933.png" alt="Drawing 5.png" data-nodeid="1760"></p> <p data-nodeid="1568">这个错误我们并不陌生，在 Node.js 环境中，我们不能通过 require 来引入一个通过 ESM 编写的模块化文件。上面的操作中，我们通过 Webpack 编译出来了符合 UMD 规范的代码，尝试修改<code data-backticks="1" data-nodeid="1762">node.test.js</code>文件为：</p> <pre data-nodeid="1569" class="lang-java"><code data-language="java"><span class="hljs-keyword">const</span> AnimalApi = require(<span class="hljs-string">'./lib/index'</span>).<span class="hljs-keyword">default</span>
AnimalApi.getCat().then((animal) =&gt; {
    console.log(animal)
})
</code></pre> <p data-nodeid="1570">如上代码，我们按照<code data-backticks="1" data-nodeid="1765">require('./lib/index').default</code>的方式引用，就可以愉快地在 Node.js 环境中运行了。</p> <p data-nodeid="1571">事实上，依赖上一步的构建产出，我们只需要按照正确的引用路径，就可以轻松地支持 Node.js 环境了。是不是有些恍恍惚惚：“基本什么都没做，这就搞定了”，下面，我们从代码原理上阐述说明。</p> <p data-nodeid="1572">符合 UMD 规范的代码，形如：</p> <pre data-nodeid="1573" class="lang-java"><code data-language="java">(function (root, factory) {
    <span class="hljs-keyword">if</span> (typeof define === <span class="hljs-string">'function'</span> &amp;&amp; define.amd) {
        <span class="hljs-comment">// AMD. Register as an anonymous module.</span>
        define([<span class="hljs-string">'b'</span>], factory);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (typeof <span class="hljs-keyword">module</span> === <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span>) {
        <span class="hljs-comment">// Node.</span>
        <span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = factory(require(<span class="hljs-string">'b'</span>));
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// Browser globals (root is window)</span>
        root.returnExports = factory(root.b);
    }
}(typeof self !== <span class="hljs-string">'undefined'</span> ? self : <span class="hljs-keyword">this</span>, function (b) {
    <span class="hljs-comment">// Use b in some fashion.</span>
    <span class="hljs-comment">// Just return a value to define the module export.</span>
    <span class="hljs-comment">// This example returns an object, but the module</span>
    <span class="hljs-comment">// can return a function as the exported value.</span>
    <span class="hljs-keyword">return</span> {};
}));
</code></pre> <p data-nodeid="1574">如上结构，通过 if...else 判断是否根据环境加载代码。我们的编译产出类似上面 UMD 格式，因此是天然支持浏览器和 Node.js 环境的。</p> <p data-nodeid="1575">但是这样的设计将 Node.js 和浏览器环境融合在了一个 bundle 当中，并不优雅，也不利于使用方优化。另外一个常见的做法是<strong data-nodeid="1775">将公共库按环境区分，分别产出两个 bundle，分别支持 Node.js 和浏览器环境</strong>。如下图架构：</p> <p data-nodeid="1576"><img src="https://s0.lgstatic.com/i/image2/M01/04/F0/CgpVE1_4C-KADRY4AAFZJiKE29s142.png" alt="Drawing 6.png" data-nodeid="1778"></p> <div data-nodeid="1577"><p style="text-align:center;">公共库支持浏览器/Node.js 环境方式示意图</p></div> <p data-nodeid="7198" class="te-preview-highlight">当然，如果编译和产出为两种不同环境的资源，还得需要设置 package.json 中的相关字段。事实上，<strong data-nodeid="7217">如果一个 npm 需要在不同环境下加载 npm 包不同的入口文件，就会牵扯到</strong><code data-backticks="1" data-nodeid="7203">main</code><strong data-nodeid="7218">字段</strong>、<code data-backticks="1" data-nodeid="7208">module</code><strong data-nodeid="7219">以及</strong><code data-backticks="1" data-nodeid="7212">browser</code><strong data-nodeid="7220">字段</strong>。简单来说：</p> <ul data-nodeid="1579"><li data-nodeid="1580"><p data-nodeid="1581"><code data-backticks="1" data-nodeid="1798">main</code>定义了<code data-backticks="1" data-nodeid="1800">npm</code>包的入口文件，Browser 环境和 Node 环境均可使用；</p></li> <li data-nodeid="1582"><p data-nodeid="1583"><code data-backticks="1" data-nodeid="1802">module</code>定义<code data-backticks="1" data-nodeid="1804">npm</code>包的 ESM 规范的入口文件，Browser 环境和 Node 环境均可使用；</p></li> <li data-nodeid="1584"><p data-nodeid="1585"><code data-backticks="1" data-nodeid="1806">browser</code>定义<code data-backticks="1" data-nodeid="1808">npm</code>包在 Browser 环境下的入口文件。</p></li></ul> <p data-nodeid="1586">而这三个字段也需要区分优先级，打包工具对于不同环境适配不同入口的字段在选择上还是要以实际情况为准。经我测试后，在目前状态，<strong data-nodeid="1815">Webpack 在 Web 浏览器环境配置下，优先选择：browser &gt; module &gt; main，在 Node.js 环境下 module &gt; main</strong>。</p> <h3 data-nodeid="1587">从开源库总结生态设计</h3> <p data-nodeid="1588">最后一部分，我们针对一个真正的公共库，来总结一下编译适配不同环境的“公共库最佳实践”。<a href="https://www.npmjs.com/package/@riversun/simple-date-format" data-nodeid="1820">simple-date-format</a> 可以将 Date 类型转换为标准定义格式的字符串类型，它支持了多种环境：</p> <pre data-nodeid="1589" class="lang-java"><code data-language="java">import SimpleDateFormat from &quot;@riversun/simple-date-format&quot;;
const SimpleDateFormat = require('@riversun/simple-date-format');
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/@riversun/simple-date-format@1.1.2/lib/simple-date-format.js&quot;&gt;&lt;/script&gt;
</code></pre> <p data-nodeid="1590">使用方式也很简单：</p> <pre data-nodeid="1591" class="lang-java"><code data-language="java"><span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> Date(<span class="hljs-string">'2018/07/17 12:08:56'</span>);
<span class="hljs-keyword">const</span> sdf = <span class="hljs-keyword">new</span> SimpleDateFormat();
console.log(sdf.formatWith(<span class="hljs-string">&quot;yyyy-MM-dd'T'HH:mm:ssXXX&quot;</span>, date));<span class="hljs-comment">//to be &quot;2018-07-17T12:08:56+09:00&quot;</span>
</code></pre> <p data-nodeid="1592">我们看这个公共库的相关设计，<a href="https://github.com/riversun/simple-date-format/blob/master/webpack.config.js#L24" data-nodeid="1826">源码</a>如下：</p> <pre data-nodeid="1593" class="lang-java"><code data-language="java"><span class="hljs-comment">// 入口配置</span>
entry: {
  <span class="hljs-string">'simple-date-format'</span>: [<span class="hljs-string">'./src/simple-date-format.js'</span>],
},
<span class="hljs-comment">// 产出配置</span>
output: {
  path: path.join(__dirname, <span class="hljs-string">'lib'</span>),
  publicPath: <span class="hljs-string">'/'</span>,
  <span class="hljs-comment">// 根据环境产出不同的文件名</span>
  filename: argv.mode === <span class="hljs-string">'production'</span> ? `[name].js` : `[name].js`,  <span class="hljs-comment">//`[name].min.js`</span>
  library: <span class="hljs-string">'SimpleDateFormat'</span>,
  libraryExport: <span class="hljs-string">'default'</span>,
  <span class="hljs-comment">// umd 模块化方式</span>
  libraryTarget: <span class="hljs-string">'umd'</span>,
  globalObject: <span class="hljs-string">'this'</span>,<span class="hljs-comment">//for both browser and node.js</span>
  umdNamedDefine: <span class="hljs-keyword">true</span>,
  <span class="hljs-comment">// 在和 output.library 和 output.libraryTarget 一起使用时，auxiliaryComment 选项允许用户向导出文件中插入注释</span>
  auxiliaryComment: {
    root: <span class="hljs-string">'for Root'</span>,
    commonjs: <span class="hljs-string">'for CommonJS environment'</span>,
    commonjs2: <span class="hljs-string">'for CommonJS2 environment'</span>,
    amd: <span class="hljs-string">'for AMD environment'</span>
  }
},
</code></pre> <p data-nodeid="1594">设计方式与前文类似，因为这个库的目标就是：<strong data-nodeid="1833">作为一个函数 helper 库，同时支持浏览器和 Node.js 环境</strong>。它采取了比较“偷懒”的方式，使用了 UMD 规范来输出代码。</p> <p data-nodeid="1595">我们再看另一个例子，在 <a href="https://github.com/lodash/lodash/blob/master/package.json#L12" data-nodeid="1837">Lodash</a> 的构建脚本中，分为了：</p> <pre data-nodeid="1596" class="lang-java"><code data-language="java"><span class="hljs-string">&quot;build&quot;</span>: <span class="hljs-string">&quot;npm run build:main &amp;&amp; npm run build:fp&quot;</span>,
<span class="hljs-string">&quot;build:fp&quot;</span>: <span class="hljs-string">&quot;node lib/fp/build-dist.js&quot;</span>,
<span class="hljs-string">&quot;build:fp-modules&quot;</span>: <span class="hljs-string">&quot;node lib/fp/build-modules.js&quot;</span>,
<span class="hljs-string">&quot;build:main&quot;</span>: <span class="hljs-string">&quot;node lib/main/build-dist.js&quot;</span>,
<span class="hljs-string">&quot;build:main-modules&quot;</span>: <span class="hljs-string">&quot;node lib/main/build-modules.js&quot;</span>,
</code></pre> <p data-nodeid="1597">其中主命令为 build，同时按照编译所需，提供：ES 版本、FP 版本等（build:fp/build:fp-modules/build:main/build:main-modules）。官方甚至提供了 <a href="https://www.npmjs.com/package/lodash-cli" data-nodeid="1842">lodash-cli</a> 支持开发者自定义构建，更多相关内容可以参考 <a href="https://lodash.com/custom-builds" data-nodeid="1846">Custom Builds</a>。</p> <p data-nodeid="1598">我们在构建环节“颇费笔墨”，目的是让你理解前端生态天生“混乱”，不统一的运行环境使得公共库的架构，尤其是相关的构建设计更加复杂。更多构建相关内容，我们会在后续章节继续讨论，这里先到此为止。</p> <h3 data-nodeid="1599">总结</h3> <p data-nodeid="1600">这两节课我们从公共库的设计和使用方接入两个方面进行了梳理。当前前端生态多种规范并行、多类环境共存，因此使得“启用或设计一个公共库”并不简单，单纯的 'npm install' 后，才是一系列工程化问题的开始。</p> <p data-nodeid="1601">与此同时，开发者经常疲于业务开发，对于编译和构建，以及公共库设计和前端生态的理解往往得过且过，但这些内容正是前端基础设施道路上的重要一环，也是开发者通往前端架构师的必经之路。建议你将本节知识融入自己手上的真实项目中，刨根问底，相信你一定会有更多收获！</p> <p data-nodeid="1602"><img src="https://s0.lgstatic.com/i/image/M00/8D/16/CgqCHl_4Ch-AQCAEAAVodGYCdmY431.png" alt="Lark20210108-153014.png" data-nodeid="1858"></p> <p data-nodeid="1603">最后，如果本节内容你难以一步到位地理解消化，请不要灰心，我们会在后续章节中不断巩固梳理。我们下一讲再见！</p> <hr> <h3 id="精选评论"><a href="#精选评论" class="header-anchor">#</a> 精选评论</h3> <h5 id="骏"><a href="#骏" class="header-anchor">#</a> **骏：</h5> <blockquote><p>作为一个库不应该把 axios 打包进去，因为业务方很可能也会使用 axios，这样会造成打包两次。正确的做法是将 axios 加入 peerDependencies，然后 webpack 中加入 external 排除掉</p></blockquote> <h5 id="俊"><a href="#俊" class="header-anchor">#</a> *俊：</h5> <blockquote><p>赞👍🏻</p></blockquote> <h5 id="野"><a href="#野" class="header-anchor">#</a> *野：</h5> <blockquote><p>照着做了一遍，引入webpack之后才能正确跑起来，明白了引入第三方js模块，比如axios的时候使用webpack工具的作用</p></blockquote> <h5 id="棉"><a href="#棉" class="header-anchor">#</a> **棉：</h5> <blockquote><p>受益匪浅~求问老师一般在工作上也很难有机会去构建大型的基础建设项目，这一部分经验的缺失平时该如何弥补，确实自己本身写demo的时候也很难会遇到那么多问题~平时应该如何锻炼呢</p></blockquote> <h6 id="讲师回复"><a href="#讲师回复" class="header-anchor">#</a>     讲师回复：</h6> <blockquote><p>    可以再看看开篇词吧，我在开篇词里有说过这个问题~</p></blockquote> <h5 id="_4550"><a href="#_4550" class="header-anchor">#</a> **4550：</h5> <blockquote><p>老师，这句话怎么理解：“为了兼容 ESM 特性，导出内容全部挂在了 default 属性”</p></blockquote> <h6 id="讲师回复-2"><a href="#讲师回复-2" class="header-anchor">#</a>     讲师回复：</h6> <blockquote><p>    这是因为 ESM 和 CommonJS 的规范，关于 default 设计的不同</p></blockquote></div></div> <div class="page-slot page-slot-bottom"><!-- 横向自适应 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/wu529778790/wu529778790.github.io/edit/master/docs/20.笔记/01.前端基础建设与架构 30 讲/09.从实战出发，从 0 到 1 构建一个符合标准的公共库.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/08/24, 09:28:28</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/3caede772e761/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">探索前端工具链生态，制定一个统一标准化 babel-preet</div></a> <a href="/pages/7f9d7786e6aa1/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">代码拆分和按需加载：缩减 bundle ize，把性能做到极致</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/3caede772e761/" class="prev">探索前端工具链生态，制定一个统一标准化 babel-preet</a></span> <span class="next"><a href="/pages/7f9d7786e6aa1/">代码拆分和按需加载：缩减 bundle ize，把性能做到极致</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/537e4ca5f546b/"><div>Code Review</div></a> <span>10-14</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/266a6e0607e5b/"><div>富强</div></a> <span>10-13</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/84b570b268311/"><div>ComfyUI</div></a> <span>10-11</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:529778790@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/wu529778790" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://shenzjd.com/shenzjd/music/" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Power by
  <a href="https://vuepress.vuejs.org/zh/" target="_blank" title="vuepress">vuepress</a> 
    | Copyright © 2015-2024
    <span>神族九帝</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><i class="close-but">×</i> <div><!-- 固定160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.6f32355a.js" defer></script><script src="/assets/js/3.1b204256.js" defer></script><script src="/assets/js/162.13cca27d.js" defer></script>
  </body>
</html>