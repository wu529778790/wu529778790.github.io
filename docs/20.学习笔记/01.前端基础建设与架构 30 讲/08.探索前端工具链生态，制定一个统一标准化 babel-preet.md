<p data-nodeid="7591" class="">å‰ç«¯ç”Ÿæ€æœ‰ç€ä¸ç”Ÿä¿±æ¥çš„æ··ä¹±å’Œä¸ä¹‹æŠ—è¡¡çš„ç§©åºï¼Œæœ‰ç€æ–°ç”ŸåŠ›é‡çš„å´›èµ·ä»¥åŠéšä¹‹è€Œæ¥çš„è§„èŒƒçº¦æŸã€‚åœ¨è¿™ä¸ªèƒŒæ™¯ä¸‹ï¼Œæ­£é¢æ¥çœ‹ï¼Œæ¬£æ¬£å‘è£çš„å‰ç«¯ç”Ÿæ€å¸¦æ¥äº†å¹¿é˜”çš„å‘å±•å‰æ™¯ï¼Œä½†ä¹Ÿé€ æˆäº†ä¸€äº›å›°æ‰°ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬éƒ½ç»å†è¿‡åœ¨å‰ç«¯åŸºç¡€è®¾æ–½å»ºè®¾ä¸­ï¼Œè¢«å„ç§å†—æ‚çš„é…ç½®é¡¹å›°æ‰°ï¼Œä¸€ä¸å°å¿ƒå°±æ˜¯ Errorï¼Œæ­¥å±¥è¹’è·šã€‚ä¹Ÿè®¸æˆ‘ä»¬å¯ä»¥é€šè¿‡æœç´¢å¼•æ“æš‚æ—¶è§£å†³é—®é¢˜ï¼Œä½†æ˜¯æææƒšæƒšã€éš¾ä»¥æ´æ‚‰é—®é¢˜æœ¬æºã€‚</p>
<p data-nodeid="7592">å¦ä¸€æ–¹é¢ï¼Œå‰ç«¯ç”Ÿæ€çš„é‡è¦ä¸€ç¯æ˜¯å…¬å…±åº“ã€‚å…¬å…±åº“çš„æ¨¡å—åŒ–è§„èŒƒã€ç¼–è¯‘æ ‡å‡†ï¼Œç”šè‡³å‹ç¼©æ–¹å¼éƒ½æœ‰è®²ç©¶ï¼ŒåŒæ—¶å…¬å…±åº“ä¸ä½¿ç”¨å®ƒä»¬çš„ä¸šåŠ¡é¡¹ç›®ä¹Ÿè¦å¯†åˆ‡é…åˆï¼Œè¿™æ ·æ‰èƒ½æ‰“é€ ä¸€ä¸ªé¡ºæ»‘çš„åŸºå»ºç»“æœã€‚è¯·ä½ ä»”ç»†å®¡è§†æ‰‹ä¸Šçš„é¡¹ç›®ï¼Œç¼–è¯‘æ„å»ºè¿‡ç¨‹æ˜¯å¦åšåˆ°äº†æœ€é«˜æ•ˆï¼Œäº§å‡ºä»£ç æ˜¯å¦è¾¾åˆ°äº†æœ€é«˜çº§åˆ«çš„å®‰å…¨ä¿éšœï¼Œæ˜¯å¦åšåˆ°äº†æ€§èƒ½ä½“éªŒçš„æœ€ä½³å®è·µï¼Ÿ</p>
<p data-nodeid="7593">è¿™ä¸€è®²ï¼Œå°±è®©æˆ‘ä»¬ä»å…¬å…±åº“çš„è§’åº¦å‡ºå‘ï¼Œæ¢³ç†å½“å‰å‰ç«¯ç”Ÿæ€ï¼Œæœ€ç»ˆè¿˜åŸä¸€ä¸ªè¶‹è¿‘å®Œç¾çš„å…¬å…±åº“è®¾è®¡æ ‡å‡†ã€‚</p>
<h3 data-nodeid="7594">ä»ä¸€ä¸ªå…¬å…±åº“å¤„ç†çš„é—®é¢˜ï¼Œè°ˆå¦‚ä½•åšå¥½â€œæ‰«é›·äººâ€</h3>
<p data-nodeid="7595">è¿™ä¸€éƒ¨åˆ†ï¼Œè®©æˆ‘ä»¬ä»¥ä¸€ç¯‡ç½‘çº¢æ–‡ç« â€œ<a href="https://juejin.im/post/6856815533749338125" data-nodeid="7749">æŠ¥å‘Šè€æ¿ï¼Œæˆ‘ä»¬çš„ H5 é¡µé¢åœ¨ iOS 11 ç³»ç»Ÿä¸Šç™½å±äº†ï¼</a>â€å¼€å§‹ï¼Œæˆ‘å…ˆç®€å•æ¢³ç†å’Œæ€»ç»“ä¸€ä¸‹æ–‡ç« å†…å®¹ï¼š</p>
<ul data-nodeid="7596">
<li data-nodeid="7597">
<p data-nodeid="7598">ç¬”è€…å‘ç°æŸäº›æœºå‹ä¸Šå‡ºç°é¡µé¢ç™½å±æƒ…å†µï¼›</p>
</li>
<li data-nodeid="7599">
<p data-nodeid="7600">å‡ºç°åœ¨æŠ¥é”™é¡µé¢ä¸Šçš„ä¿¡æ¯éå¸¸æ˜æ˜¾ï¼Œå³å½“å‰æµè§ˆå™¨ä¸æ”¯æŒ<code data-backticks="1" data-nodeid="7753">...</code>æ‰©å±•è¿ç®—ç¬¦ï¼›</p>
</li>
<li data-nodeid="7601">
<p data-nodeid="7602">å‡ºé”™çš„ä»£ç ï¼ˆä½¿ç”¨äº†æ‰©å±•è¿ç®—ç¬¦çš„ä»£ç ï¼‰å±äºæŸä¸ªå…¬å…±åº“ä»£ç ï¼Œå®ƒæ²¡æœ‰ä½¿ç”¨ Babel æ’ä»¶è¿›è¡Œé™çº§å¤„ç†ï¼Œå› æ­¤çº¿ä¸Šæºä»£ç å‡ºç°äº†<code data-backticks="1" data-nodeid="7756">...</code>æ‰©å±•è¿ç®—ç¬¦ã€‚</p>
</li>
</ul>
<p data-nodeid="7603">ç°åœ¨é—®é¢˜æ‰¾åˆ°äº†ï¼Œæˆ–è®¸ç›´æ¥å°†å‡ºç°é—®é¢˜çš„å…¬å…±åº“ä»£ç ç”¨ Babel è¿›è¡Œç¼–è¯‘é™çº§å°±å¯ä»¥äº†ï¼Œä½†é—®é¢˜ä¼¼ä¹è¿˜ä¼šæ›´åŠ å¤æ‚ã€‚åœ¨æ–‡ä¸­ç¯å¢ƒä¸‹ï¼Œéœ€è¦åœ¨<code data-backticks="1" data-nodeid="7759">vue.config.js</code>ä¸­åŠ å…¥å¯¹é—®é¢˜å…¬å…±åº“<code data-backticks="1" data-nodeid="7761">module-name/library-name</code>çš„ Babel ç¼–è¯‘æµç¨‹ï¼š</p>
<pre class="lang-java" data-nodeid="7604"><code data-language="java">transpileDependencies: [
  <span class="hljs-string">'module-name/library-name'</span> <span class="hljs-comment">// å‡ºç°é—®é¢˜çš„é‚£ä¸ªåº“</span>
],
</code></pre>
<p data-nodeid="7605">vue-cli å¯¹<a href="https://cli.vuejs.org/zh/config/#transpiledependencies" data-nodeid="7766">transpileDependencies</a> ä¹Ÿæœ‰å¦‚ä¸‹è¯´æ˜ï¼š</p>
<blockquote data-nodeid="7606">
<p data-nodeid="7607">é»˜è®¤æƒ…å†µä¸‹ babel-loader ä¼šå¿½ç•¥æ‰€æœ‰<code data-backticks="1" data-nodeid="7769">node_modules</code>ä¸­çš„æ–‡ä»¶ã€‚å¦‚æœä½ æƒ³è¦é€šè¿‡ Babel æ˜¾å¼è½¬è¯‘ä¸€ä¸ªä¾èµ–ï¼Œå¯ä»¥åœ¨è¿™ä¸ªé€‰é¡¹ä¸­åˆ—å‡ºæ¥ã€‚</p>
</blockquote>
<p data-nodeid="7608">æŒ‰ç…§ä¸Šè¿°æ“ä½œï¼Œå´å¾—åˆ°äº†æ–°çš„æŠ¥é”™ï¼š<code data-backticks="1" data-nodeid="7772">Uncaught TypeError: Cannot assign to read only property 'exports' of object '#&lt;Object&gt;'</code>ã€‚ç©¶å…¶åŸå› ï¼Œ<code data-backticks="1" data-nodeid="7774">module-name/library-name</code>è¿™ä¸ªåº“å¯¹å¤–è¾“å‡ºçš„æ˜¯ CommonJS ç±»å‹æºç ï¼Œè€Œé¡¹ç›®åŸºç¡€è®¾æ–½ä¸­ babel-transform-runtime åœ¨ç¼–è¯‘æ—¶å¢åŠ çš„ helper ä»£ç ï¼Œä½¿ç”¨çš„æ˜¯ import å¼•å…¥ã€‚<strong data-nodeid="7780">æœ€ç»ˆç¼–è¯‘ç»“æœå‡ºç°äº† ESM åŒ…å« CommonJS çš„æƒ…å†µï¼Œæ˜¯ä¸ä¼šè¢« Webpack å¤„ç†çš„</strong>ã€‚</p>
<p data-nodeid="7609">å‡ºç°é—®é¢˜çš„åŸå› æ€»ç»“å¦‚ä¸‹ï¼š</p>
<ul data-nodeid="7610">
<li data-nodeid="7611">
<p data-nodeid="7612">plugin-transform-runtime ä¼šæ ¹æ® sourceType é€‰æ‹©æ³¨å…¥ import æˆ–è€… requireï¼ŒsourceType çš„é»˜è®¤å€¼æ˜¯ moduleï¼Œå°±ä¼šé»˜è®¤æ³¨å…¥ importï¼›</p>
</li>
<li data-nodeid="7613">
<p data-nodeid="7614">Webpack ä¸ä¼šå¤„ç†åŒ…å« import/export çš„æ–‡ä»¶ä¸­çš„ module.exports å¯¼å‡ºï¼Œæ‰€ä»¥éœ€è¦è®© Babel è‡ªåŠ¨åˆ¤æ–­ sourceTypeï¼Œæ ¹æ®æ–‡ä»¶å†…æ˜¯å¦å­˜åœ¨ import/export æ¥å†³å®šæ³¨å…¥ä»€ä¹ˆæ ·çš„ä»£ç ã€‚</p>
</li>
</ul>
<p data-nodeid="7615">ä¸ºäº†é€‚é…ä¸Šè¿°é—®é¢˜ï¼ŒBabel è®¾ç½®äº†<code data-backticks="1" data-nodeid="7785">sourceType</code>å±æ€§ï¼Œ<code data-backticks="1" data-nodeid="7787">sourceTypeï¼šunambiguous</code>è¡¨ç¤º Babel ä¼šæ ¹æ®æ–‡ä»¶ä¸Šä¸‹æ–‡ï¼ˆæ¯”å¦‚æ˜¯å¦å«æœ‰ import/exportï¼‰æ¥å†³å®šæ˜¯å¦æŒ‰ç…§ ESM è¯­æ³•å¤„ç†æ–‡ä»¶ã€‚</p>
<p data-nodeid="7616">è¿™æ—¶å€™å°±éœ€è¦é…ç½® Babel å†…å®¹äº†ï¼š</p>
<pre class="lang-java" data-nodeid="7617"><code data-language="java"><span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {
  ...  <span class="hljs-comment">// çœç•¥çš„é…ç½®</span>
  sourceType: <span class="hljs-string">'unambiguous'</span>,
  ...  <span class="hljs-comment">// çœç•¥çš„é…ç½®</span>
}
</code></pre>
<p data-nodeid="7618">ä½†æ˜¯è¿™ç§åšæ³•åœ¨å·¥ç¨‹ä¸Šå¹¶ä¸æ¨èï¼Œä¸Šè¿°æ›´æ”¹æ–¹å¼å¯¹æ‰€æœ‰ç¼–è¯‘æ–‡ä»¶éƒ½ç”Ÿæ•ˆï¼Œä½†ä¹Ÿ<strong data-nodeid="7801">å¢åŠ äº†ç¼–è¯‘æˆæœ¬</strong>ï¼ˆå› ä¸ºè®¾ç½®<code data-backticks="1" data-nodeid="7795">sourceTypeï¼šunambiguous</code>åï¼Œç¼–è¯‘æ—¶éœ€è¦åšçš„äº‹æƒ…æ›´å¤šï¼‰ï¼Œè¿˜æœ‰ä¸ª<a href="https://babeljs.io/docs/en/options#sourcetype" data-nodeid="7799">æ½œåœ¨é—®é¢˜</a>ï¼š</p>
<blockquote data-nodeid="7619">
<p data-nodeid="7620">Unambiguous can be quite useful in contexts where the type is unknown, but it can lead to false matches because it's perfectly valid to have a module file that does not use import/export statements.</p>
</blockquote>
<p data-nodeid="7621">ç¿»è¯‘è¿‡æ¥ï¼Œå°±æ˜¯è¯´å¹¶ä¸æ˜¯æ‰€æœ‰çš„ ESM æ¨¡å—ï¼ˆè¿™é‡ŒæŒ‡ä½¿ç”¨ ESNext ç‰¹æ€§çš„æ–‡ä»¶ï¼‰éƒ½å«æœ‰ import/exportï¼Œå› æ­¤å³ä¾¿æŸä¸ªå¾…ç¼–è¯‘æ–‡ä»¶å±äº ESM æ¨¡å—ï¼Œä¹Ÿå¯èƒ½è¢« Babel é”™è¯¯åœ°åˆ¤æ–­ä¸º CommonJS æ¨¡å—è€Œå¼•å‘è¯¯åˆ¤ã€‚</p>
<p data-nodeid="7622">åŸºäºè¿™ä¸€ç‚¹ï¼Œä¸€ä¸ªæ›´åˆé€‚çš„åšæ³•æ˜¯ï¼šåªå¯¹ç›®æ ‡ç¬¬ä¸‰æ–¹åº“<code data-backticks="1" data-nodeid="7807">'module-name/library-name'</code>ä½¿ç”¨<code data-backticks="1" data-nodeid="7809">sourceTypeï¼šunambiguous</code>ï¼Œè¿™æ—¶ï¼ŒBabel <a href="https://babeljs.io/docs/en/options#overrides" data-nodeid="7813">overrides å±æ€§</a>å°±æ´¾ä¸Šç”¨åœºäº†ï¼š</p>
<blockquote data-nodeid="7623">
<p data-nodeid="7624">Allows users to provide an array of options that will be merged into the current configuration one at a time. This feature is best used alongside the "test"/"include"/"exclude" options to provide conditions for which an override should apply.</p>
</blockquote>
<p data-nodeid="7625">å…·ä½“ä½¿ç”¨æ–¹å¼ï¼š</p>
<pre class="lang-java" data-nodeid="7626"><code data-language="java"><span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {
	...&nbsp;&nbsp;<span class="hljs-comment">//&nbsp;çœç•¥çš„é…ç½®</span>
	overrides:&nbsp;[
		{&nbsp;include:&nbsp;<span class="hljs-string">'./node_modules/module-name/library-name/name.common.js'</span>,&nbsp;&nbsp;<span class="hljs-comment">//&nbsp;ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“</span>
		sourceType:&nbsp;<span class="hljs-string">'unambiguous'</span>
		}
	],&nbsp;
	&nbsp;...&nbsp;&nbsp;<span class="hljs-comment">//&nbsp;çœç•¥çš„é…ç½®</span>
};
</code></pre>
<p data-nodeid="7627">è‡³æ­¤ï¼Œè¿™ä¸ªâ€œiOS 11 ç³»ç»Ÿç™½å±â€é—®é¢˜å°±ç®—å‘Šä¸€æ®µè½äº†ã€‚æˆ‘æ•´ç†äº†è§£å†³è·¯çº¿ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p data-nodeid="7628"><img src="https://s0.lgstatic.com/i/image2/M01/04/A5/CgpVE1_0NWKAaju0AAMFDVpRq7Y221.png" alt="Lark20210105-174532.png" data-nodeid="7832"></p>
<p data-nodeid="7629">æˆ‘ä»¬å›è¿‡å¤´å†æ¥çœ‹è¿™ä¸ªé—®é¢˜ï¼Œå®é™…ä¸Š<strong data-nodeid="7838">ä¸šåŠ¡æ–¹å¯¹çº¿ä¸Šæµ‹è¯•å›å½’ä¸å½»åº•</strong>æ˜¯é€ æˆé—®é¢˜çš„ç›´æ¥åŸå› ï¼Œä½†é—®é¢˜å…¶å®å‡ºç°åœ¨ä¸€ä¸ªå…¬å…±åº“ä¸Šï¼Œå› è€Œå‰ç«¯ç”Ÿæ€çš„æ··ä¹±å’Œå¤æ‚ä¹Ÿè®¸æ˜¯æ›´æœ¬è´¨çš„åŸå› ã€‚è¿™é‡Œæ¶‰åŠä¸¤æ–¹é¢é—®é¢˜ï¼š</p>
<ul data-nodeid="7630">
<li data-nodeid="7631">
<p data-nodeid="7632">ä½œä¸ºå…¬å…±åº“ï¼Œæˆ‘åº”è¯¥å¦‚ä½•æ„å»ºç¼–è¯‘ä»£ç ï¼Œè®©ä¸šåŠ¡æ–¹æ›´æœ‰ä¿éšœåœ°ä½¿ç”¨ï¼Ÿ</p>
</li>
<li data-nodeid="7633">
<p data-nodeid="7634">ä½œä¸ºä½¿ç”¨è€…ï¼Œæˆ‘åº”è¯¥å¦‚ä½•å¤„ç†ç¬¬ä¸‰æ–¹å…¬å…±åº“ï¼Œæ˜¯å¦è¿˜éœ€è¦å¯¹å…¶è¿›è¡Œé¢å¤–ç¼–è¯‘å’Œå¤„ç†ï¼Ÿ</p>
</li>
</ul>
<p data-nodeid="7635">è¢«åŠ¨åœ°å‘ç°é—®é¢˜ã€è§£å†³é—®é¢˜åªä¼šè®©æˆ‘ä»¬è¢«â€œç‰µç€é¼»å­èµ°â€â€”â€”è¿™ä¸æ˜¯æˆ‘ä»¬çš„ç›®çš„ã€‚æˆ‘ä»¬åº”è¯¥ä»æ›´åº•å±‚æ‹†è§£é—®é¢˜ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹çœ‹æ›´åº•å±‚çš„å†…å®¹ã€‚</p>
<h3 data-nodeid="7636">åº”ç”¨é¡¹ç›®æ„å»ºå’Œå…¬å…±åº“æ„å»ºçš„å·®å¼‚</h3>
<p data-nodeid="7637">é¦–å…ˆæˆ‘ä»¬è¦è®¤æ¸…åº”ç”¨é¡¹ç›®æ„å»ºå’Œå…¬å…±åº“æ„å»ºçš„å·®åˆ«ã€‚ä½œä¸ºå‰ç«¯å›¢é˜Ÿï¼Œæˆ‘ä»¬æ„å»ºäº†å¾ˆå¤šåº”ç”¨é¡¹ç›®ï¼Œå¯¹äºä¸€ä¸ªåº”ç”¨é¡¹ç›®æ¥è¯´ï¼Œâ€œåªè¦èƒ½åœ¨éœ€è¦å…¼å®¹çš„ç¯å¢ƒä¸­è·‘èµ·æ¥â€å°±è¾¾åˆ°äº†åŸºæœ¬ç›®çš„ã€‚è€Œå¯¹äºä¸€ä¸ªå…¬å…±åº“æ¥è¯´ï¼Œæˆ‘ä»¬çš„å…¬å…±åº“å¯èƒ½è¢«å„ç§ç¯å¢ƒæ‰€å¼•ç”¨æˆ–éœ€è¦æ”¯æŒå„ç§å…¼å®¹éœ€æ±‚ï¼Œå› æ­¤<strong data-nodeid="7848">å…¬å…±åº“å°±è¦å…¼é¡¾æ€§èƒ½å’Œæ˜“ç”¨æ€§ï¼Œè¦æ³¨é‡è´¨é‡å’Œå¹¿æ³›åº¦</strong>ã€‚ç”±æ­¤çœ‹æ¥ï¼Œå…¬å…±åº“ç†è®ºä¸Šæ„å»ºæœºåˆ¶å°±æ›´åŠ å¤æ‚ã€‚</p>
<p data-nodeid="7638">è¯´åˆ°åº•ï¼Œå¦‚æœä½ èƒ½å¤Ÿè®¾è®¡å¥½ä¸€ä¸ªå…¬å…±åº“ï¼Œé‚£ä¹ˆé€šå¸¸ä¹Ÿèƒ½ä½¿ç”¨å¥½ä¸€ä¸ªå…¬å…±åº“ã€‚å› æ­¤ï¼Œä¸‹é¢æˆ‘ä»¬é‡ç‚¹è®¨è®ºå¦‚ä½•è®¾è®¡å¹¶äº§å‡ºä¸€ä¸ªä¼ä¸šçº§å…¬å…±åº“ï¼Œä»¥åŠå¦‚ä½•åœ¨ä¸šåŠ¡ä¸­æ›´å¥½åœ°é…åˆä½¿ç”¨ã€‚</p>
<h3 data-nodeid="7639">åˆ¶å®šä¸€ä¸ªä¼ä¸šçº§å…¬å…±åº“çš„è®¾è®¡åŸåˆ™</h3>
<p data-nodeid="7640">è¿™é‡Œè¯´çš„ä¼ä¸šçº§å…¬å…±åº“ä¸»è¦æ˜¯æŒ‡åœ¨ä¼ä¸šå†…å¤ç”¨çš„å…¬å…±åº“ï¼Œå®ƒå¯ä»¥è¢«å‘å¸ƒåˆ° npm ä¸Šè¿›è¡Œç¤¾åŒºå…±äº«ï¼Œä¹Ÿå¯ä»¥åœ¨ä¼ä¸šå†…çš„ç§æœ‰ npm ä¸­é™å®šèŒƒå›´åœ°å…±äº«ã€‚æ€»ä¹‹ï¼Œä¼ä¸šçº§å…¬å…±åº“æ˜¯éœ€è¦åœ¨ä¸šåŠ¡ä¸­è¢«ä½¿ç”¨çš„ã€‚æˆ‘è®¤ä¸ºä¸€ä¸ªä¼ä¸šçº§å…¬å…±åº“çš„è®¾è®¡åŸåˆ™åº”è¯¥åŒ…æ‹¬ä»¥ä¸‹å‡ ç‚¹ã€‚</p>
<ol data-nodeid="7641">
<li data-nodeid="7642">
<p data-nodeid="7643"><strong data-nodeid="7856">å¯¹äºå¼€å‘è€…å…±åˆ›å…¬å…±åº“ï¼Œæœ€å¤§åŒ–ç¡®ä¿å¼€å‘ä½“éªŒ</strong>ï¼š</p>
</li>
</ol>
<ul data-nodeid="7644">
<li data-nodeid="7645">
<p data-nodeid="7646">æœ€å¿«åœ°æ­å»ºè°ƒè¯•å’Œå¼€å‘ç¯å¢ƒ</p>
</li>
<li data-nodeid="7647">
<p data-nodeid="7648">å®‰å…¨åœ°å‘ç‰ˆç»´æŠ¤</p>
</li>
</ul>
<ol start="2" data-nodeid="7649">
<li data-nodeid="7650">
<p data-nodeid="7651"><strong data-nodeid="7863">å¯¹äºä½¿ç”¨è€…ï¼Œæœ€å¤§åŒ–ç¡®ä¿ä½¿ç”¨ä½“éªŒ</strong>ï¼š</p>
</li>
</ol>
<ul data-nodeid="7652">
<li data-nodeid="7653">
<p data-nodeid="7654">å…¬å…±åº“æ–‡æ¡£å»ºè®¾å®Œå–„</p>
</li>
<li data-nodeid="7655">
<p data-nodeid="7656">å…¬å…±åº“è´¨é‡æœ‰ä¿éšœ</p>
</li>
<li data-nodeid="7657">
<p data-nodeid="7658">æ¥å…¥å’Œä½¿ç”¨è´Ÿæ‹…æœ€å°</p>
</li>
</ul>
<p data-nodeid="7659">åŸºäºä¸Šè¿°åŸåˆ™ï¼Œåœ¨å›¢é˜Ÿé‡Œï¼Œè®¾è®¡ä¸€ä¸ªå…¬å…±åº“å‰ï¼Œä½ éœ€è¦è€ƒè™‘ï¼š</p>
<ul data-nodeid="7660">
<li data-nodeid="7661">
<p data-nodeid="7662">è‡ªç ”å…¬å…±åº“è¿˜æ˜¯ä½¿ç”¨ç¤¾åŒºå·²æœ‰è½®å­ï¼›</p>
</li>
<li data-nodeid="7663">
<p data-nodeid="7664">å…¬å…±åº“çš„è¿è¡Œç¯å¢ƒæ˜¯ä»€ä¹ˆï¼Œè¿™å°†å†³å®šå…¬å…±åº“çš„ç¼–è¯‘æ„å»ºç›®æ ‡ï¼›</p>
</li>
<li data-nodeid="7665">
<p data-nodeid="7666">å…¬å…±åº“æ˜¯åå‘ä¸šåŠ¡è¿˜æ˜¯ä¸šåŠ¡ freeï¼Œè¿™å°†å†³å®šå…¬å…±åº“çš„èŒè´£å’Œè¾¹ç•Œã€‚</p>
</li>
</ul>
<p data-nodeid="7667">ä¸Šè¿°å†…å®¹å¹¶éçº¯ç†è®ºåŸåˆ™ï¼Œè€Œæ˜¯ç›´æ¥å†³å®šäº†å…¬å…±åº“å®ç°çš„æŠ€æœ¯é€‰å‹ã€‚æ¯”å¦‚ï¼Œä¸ºäº†å®ç°æ›´å®Œå–„çš„æ–‡æ¡£å»ºè®¾ï¼Œå°¤å…¶æ˜¯ UI ç»„ä»¶ç±»æ–‡æ¡£ï¼Œå¯ä»¥è€ƒè™‘éƒ¨ç½²é™æ€ç»„ä»¶å±•ç¤ºç«™ç‚¹ï¼Œè¿›è¡Œç»„ä»¶å±•ç¤ºä»¥åŠç”¨æ³•è¯´æ˜ã€‚æ›´æ™ºèƒ½ã€å·¥ç¨‹åŒ–çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨ç±»ä¼¼ <a href="https://github.com/jsdoc/jsdoc" data-nodeid="7874">JSDoc</a> æ¥å®ç° JavaScript API æ–‡æ¡£ç”Ÿæˆï¼Œç»„ä»¶ç±»å…¬å…±åº“å¯ä»¥è€ƒè™‘ <a href="https://storybook.js.org/" data-nodeid="7878">Storybook</a> æˆ–è€… <a href="http://styleguides.io/" data-nodeid="7882">Styleguides</a> ä½œä¸ºæ ‡å‡†æ¥å…¥æ–¹æ¡ˆã€‚</p>
<p data-nodeid="7668">å†æ¯”å¦‚ï¼Œæˆ‘ä»¬çš„<strong data-nodeid="7889">å…¬å…±åº“é€‚é…ç¯å¢ƒ</strong>æ˜¯ä»€ä¹ˆï¼Ÿä¸€èˆ¬æ¥è®²å¯èƒ½éœ€è¦å…¼å®¹ï¼šæµè§ˆå™¨/Node.js/åŒæ„ç¯å¢ƒç­‰ã€‚ä¸åŒç¯å¢ƒå¯¹åº”äº†ä¸åŒçš„ç¼–è¯‘å’Œæ‰“åŒ…æ ‡å‡†ï¼Œè¿™å°±éœ€è¦ä½ è¿›è¡Œæ€è€ƒï¼šå¦‚æœç›®æ ‡æ˜¯æµè§ˆå™¨ç¯å¢ƒï¼Œé‚£ä¹ˆå¦‚ä½•æ‰èƒ½å……åˆ†å®ç°æ€§èƒ½æœ€ä¼˜è§£ï¼Ÿå¦‚å¸®åŠ©ä¸šåŠ¡æ–¹å®ç° tree-shaking ç­‰ä¼˜åŒ–æŠ€æœ¯ã€‚</p>
<p data-nodeid="7669">åŒæ—¶ï¼Œä¸ºäº†å‡è½»ä¸šåŠ¡ä½¿ç”¨è´Ÿæ‹…ï¼Œä½œä¸ºä¼ä¸šçº§å…¬å…±åº“ï¼Œä»¥åŠå¯¹åº”ä½¿ç”¨è¿™äº›ä¼ä¸šçº§å…¬å…±åº“çš„åº”ç”¨é¡¹ç›®ï¼Œå¯ä»¥æŒ‡å®šæ ‡å‡†è§„èŒƒçš„ babel-presetï¼Œä¿è¯ç¼–è¯‘äº§å‡ºçš„ç»Ÿä¸€ã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸šåŠ¡é¡¹ç›®ï¼ˆå³ä½¿ç”¨å…¬å…±åº“æ–¹ï¼‰å¯ä»¥ä»¥ç»Ÿä¸€çš„æ¥å…¥æ ‡å‡†å¼•å…¥ã€‚</p>
<p data-nodeid="7670">ä¸‹é¢æ˜¯æˆ‘åŸºäºå¯¹ç›®å‰å‰ç«¯ç”Ÿæ€çš„ç†è§£ï¼Œè‰æ‹Ÿçš„ä¸€ä»½ babel-presetï¼ˆè¯¥ preset è®¾è®¡æ–¹æ¡ˆå…·æœ‰æ—¶æ•ˆæ€§ï¼‰ã€‚è¯·ç»§ç»­é˜…è¯»ä¸‹æ–‡ï¼Œæˆ‘ä»¬æ¥å¯¹ @lucas/babel-preset ä¸€æ¢ç©¶ç«Ÿã€‚</p>
<h3 data-nodeid="7671">åˆ¶å®šä¸€ä¸ªç»Ÿä¸€æ ‡å‡†åŒ– babel-preset</h3>
<p data-nodeid="7672">ä¼ä¸šä¸­ï¼Œæ‰€æœ‰å…¬å…±åº“æˆ–åº”ç”¨é¡¹ç›®éƒ½ä½¿ç”¨ä¸€å¥— @lucas/babel-xxx-presetï¼ŒæŒ‰ç…§ @lucas/babel-xxx-preset çš„ç¼–è¯‘è¦æ±‚è¿›è¡Œç¼–è¯‘ï¼Œè¿™æ ·ä¸šåŠ¡ä½¿ç”¨æ—¶ï¼Œæ¥å…¥æ ‡å‡†ç»Ÿä¸€ã€‚</p>
<p data-nodeid="7673">åŸåˆ™ä¸Šè®²ï¼Œè¿™æ ·çš„ç»Ÿä¸€åŒ–èƒ½å¤Ÿæœ‰æ•ˆé¿å…æœ¬æ–‡å¼€å¤´çš„â€œçº¿ä¸Šé—®é¢˜â€ã€‚åŒæ—¶è¿™ä¸ª @lucas/babel-preset åº”è¯¥èƒ½å¤Ÿé€‚åº”å„ç§é¡¹ç›®éœ€æ±‚ï¼Œæ¯”å¦‚ä½¿ç”¨ TypeScript/Flow ç­‰æ‰©å±•è¯­æ³•çš„é¡¹ç›®ã€‚</p>
<p data-nodeid="7674">è¿™é‡Œç»™å‡ºä¸€ä»½è®¾è®¡æ–¹æ¡ˆï¼Œä¾›ä½ å‚è€ƒå’Œè®¨è®ºã€‚</p>
<ol data-nodeid="7675">
<li data-nodeid="7676">
<p data-nodeid="7677">æ”¯æŒ NODE_ENV = 'development' | 'production' | 'test' ä¸‰ç§ç¯å¢ƒï¼Œå¹¶æœ‰å¯¹åº”çš„ä¼˜åŒ–ã€‚</p>
</li>
<li data-nodeid="7678">
<p data-nodeid="7679">é…ç½®æ’ä»¶é»˜è®¤ä¸å¼€å¯ Babel<code data-backticks="1" data-nodeid="7916">loose: true</code>é…ç½®ï¼Œè®©æ’ä»¶çš„è¡Œä¸ºå°½å¯èƒ½åœ°éµå¾ªè§„èŒƒï¼Œä½†å¯¹æœ‰è¾ƒä¸¥é‡æ€§èƒ½æŸè€—æˆ–æœ‰å…¼å®¹æ€§é—®é¢˜çš„æƒ…å†µä¿ç•™ä¿®æ”¹å…¥å£ã€‚</p>
</li>
<li data-nodeid="7680">
<p data-nodeid="7681">è¿™ä»½è®¾è®¡æ–¹æ¡ˆè½åœ°åäº§å‡ºï¼Œåº”è¯¥<strong data-nodeid="7923">æ”¯æŒåº”ç”¨ç¼–è¯‘å’Œå…¬å…±åº“ç¼–è¯‘</strong>ï¼Œå³å¯ä»¥æŒ‰ç…§ @lucas/babel-preset/appï¼Œ@lucas/babel-preset/dependencies å’Œ @lucas/babel-preset/libraryï¼Œ@lucas/babel-preset/library/compact è¿›è¡ŒåŒºåˆ†ä½¿ç”¨ï¼ˆå…·ä½“ä¸åŒé¢„è®¾é›†åˆçš„è§’è‰²ï¼Œä¸‹é¢ä¼šè¯¦ç»†å±•å¼€ï¼‰ã€‚</p>
</li>
</ol>
<p data-nodeid="7682">@lucas/babel-preset/appï¼Œ@lucas/babel-preset/dependencies éƒ½å¯ä»¥ä½œä¸ºç¼–è¯‘åº”ç”¨é¡¹ç›®çš„é¢„è®¾ä½¿ç”¨ï¼Œä½†ä»–ä»¬ä¹Ÿæœ‰æ‰€å·®åˆ«ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p>
<ul data-nodeid="7683">
<li data-nodeid="7684">
<p data-nodeid="7685">@lucas/babel-preset/app è´Ÿè´£ç¼–è¯‘é™¤<code data-backticks="1" data-nodeid="7926">node_modules</code>å¤–çš„ä¸šåŠ¡ä»£ç ï¼›</p>
</li>
<li data-nodeid="7686">
<p data-nodeid="7687">@lucas/babel-preset/dependencies ç¼–è¯‘<code data-backticks="1" data-nodeid="7929">node_modules</code>ç¬¬ä¸‰æ–¹ä»£ç ï¼›</p>
</li>
<li data-nodeid="7688">
<p data-nodeid="7689">@lucas/babel-preset/library å’Œ @lucas/babel-preset/library/compact ä½œä¸ºç¼–è¯‘å…¬å…±åº“ä½¿ç”¨çš„é¢„è®¾ï¼Œä»–ä»¬ä¹Ÿæœ‰æ‰€å·®åˆ«ï¼Œ@lucas/babel-preset/library æŒ‰ç…§å½“å‰ Node ç¯å¢ƒç¼–è¯‘è¾“å‡ºä»£ç ï¼Œè€Œ @lucas/babel-preset/library/compact ä¼šç¼–è¯‘é™çº§ä¸º ES5ã€‚</p>
</li>
</ul>
<ol start="4" data-nodeid="7690">
<li data-nodeid="7691">
<p data-nodeid="7692">å¯¹äºä¼ä¸šçº§å…¬å…±åº“ï¼Œå»ºè®®ä½¿ç”¨æ ‡å‡† ES ç‰¹æ€§å‘å¸ƒï¼›å¯¹ tree-shaking æœ‰å¼ºçƒˆéœ€æ±‚çš„åº“ï¼Œåº”åŒæ—¶å‘å¸ƒ ES module æ ¼å¼ä»£ç ã€‚</p>
</li>
<li data-nodeid="7693">
<p data-nodeid="7694">å¯¹äºä¼ä¸šçº§å…¬å…±åº“ï¼Œå‘å¸ƒçš„ä»£ç ä¸åŒ…å« polyfillsï¼Œç”±ä½¿ç”¨æ–¹ç»Ÿä¸€å¤„ç†ã€‚</p>
</li>
<li data-nodeid="7695">
<p data-nodeid="7696">å¯¹äºåº”ç”¨ç¼–è¯‘ï¼Œä½¿ç”¨ @babel/preset-env åŒæ—¶ç¼–è¯‘åº”ç”¨ä»£ç ä¸ç¬¬ä¸‰æ–¹åº“ä»£ç ã€‚</p>
</li>
<li data-nodeid="7697">
<p data-nodeid="7698">å¯¹äºåº”ç”¨ç¼–è¯‘ï¼Œéœ€è¦å¯¹<code data-backticks="1" data-nodeid="7936">node_modules</code>è¿›è¡Œç¼–è¯‘ï¼Œå¹¶ä¸”ä¸º<code data-backticks="1" data-nodeid="7938">node_modules</code>é…ç½®<code data-backticks="1" data-nodeid="7940">sourceType: 'unambiguous'</code>ï¼Œä»¥ç¡®ä¿ç¬¬ä¸‰æ–¹ä¾èµ–åŒ…ä¸­çš„ CommonJS æ¨¡å—èƒ½å¤Ÿè¢«æ­£ç¡®å¤„ç†ã€‚</p>
</li>
<li data-nodeid="7699">
<p data-nodeid="7700">å¯¹äºåº”ç”¨ç¼–è¯‘ï¼Œå¯ç”¨ plugin-transform-runtimeï¼Œé¿å…åŒæ ·çš„ helper ä»£ç è¢«é‡å¤æ³¨å…¥å¤šä¸ªæ–‡ä»¶ï¼Œä»¥ç¼©å‡æ‰“åŒ…åæ–‡ä»¶çš„ä½“ç§¯ã€‚åŒæ—¶è‡ªåŠ¨æ³¨å…¥ regenerator-runtimeï¼Œé¿å…æ±¡æŸ“å…¨å±€å˜é‡ã€‚</p>
</li>
<li data-nodeid="7701">
<p data-nodeid="7702">æ³¨å…¥ç»å¯¹è·¯å¾„å¼•ç”¨çš„ @babel/runtime åŒ…ä¸­å¯¹åº”çš„ helperï¼Œä»¥ç¡®ä¿èƒ½å¤Ÿå¼•ç”¨åˆ°æ­£ç¡®ç‰ˆæœ¬çš„ @babel/runtime åŒ…ä¸­çš„æ–‡ä»¶ã€‚</p>
</li>
</ol>
<p data-nodeid="7703">æ­¤å¤–ï¼Œç¬¬ä¸‰æ–¹åº“å¯èƒ½é€šè¿‡ dependencies ä¾èµ–è‡ªå·±çš„ @babel/runtimeï¼Œè€Œ @babel/runtime ä¸åŒç‰ˆæœ¬ä¹‹é—´ä¸èƒ½ç¡®ä¿å…¼å®¹ (æ¯”å¦‚ 6.x å’Œ 7.x ä¹‹é—´)ï¼Œè¿™å°±éœ€è¦ç¡®ä¿æˆ‘ä»¬ä¸º<code data-backticks="1" data-nodeid="7945">node_modules</code>å†…ä»£ç ç»è¿‡ Babel ç¼–è¯‘æ³¨å…¥ runtime æ—¶ä½¿ç”¨æ­£ç¡®è·¯å¾„çš„ @babel/runtime åŒ…ã€‚</p>
<p data-nodeid="7704">åŸºäºä»¥ä¸Šè®¾è®¡ï¼Œå¯¹äº CSR åº”ç”¨çš„ Babel ç¼–è¯‘æµç¨‹ï¼Œé¢„è®¡ä¸šåŠ¡æ–¹ä½¿ç”¨é¢„è®¾ä¸ºï¼š</p>
<pre class="lang-java" data-nodeid="7705"><code data-language="java"><span class="hljs-comment">// webpack.config.js</span>
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {
  presets: [<span class="hljs-string">'@lucas/babel-preset/app'</span>],
}
<span class="hljs-comment">// ç›¸å…³ webpack é…ç½®</span>
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {
  <span class="hljs-keyword">module</span>: {
    rules: [
      {
        test: /\.js$/,
        oneOf: [
          {
            exclude: /node_modules/,
            loader: <span class="hljs-string">'babel-loader'</span>,
            options: {
              cacheDirectory: <span class="hljs-keyword">true</span>,
            },
          },
          {
            loader: <span class="hljs-string">'babel-loader'</span>,
            options: {
              cacheDirectory: <span class="hljs-keyword">true</span>,
              configFile: <span class="hljs-keyword">false</span>,
              <span class="hljs-comment">// ä½¿ç”¨æˆ‘ä»¬çš„ preset</span>
              presets: [<span class="hljs-string">'@lucas/babel-preset/dependencies'</span>],
              compact: <span class="hljs-keyword">false</span>,
            },
          },
        ],
      },
    ],
  },
}
</code></pre>
<p data-nodeid="7706">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸Šè¿°ä½¿ç”¨æ–¹å¼æŒ‰ç…§<code data-backticks="1" data-nodeid="7949">node_modules</code>è¿›è¡Œäº†åŒºåˆ†ï¼Œå¯¹äº<code data-backticks="1" data-nodeid="7951">node_modules</code>æˆ‘ä»¬å¼€å¯ cacheDirectory ç¼“å­˜ã€‚å¯¹äºåº”ç”¨ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨ babel-loader è¿›è¡Œç¼–è¯‘ï¼Œå¹¶ä½¿ç”¨<code data-backticks="1" data-nodeid="7953">@lucas/babel-preset/dependencies</code>è¿™ä¸ª Babel presetï¼Œå…¶å†…å®¹ä¸ºï¼š</p>
<pre class="lang-java" data-nodeid="7707"><code data-language="java"><span class="hljs-keyword">const</span> path = require(<span class="hljs-string">'path'</span>)
<span class="hljs-keyword">const</span> {declare} = require(<span class="hljs-string">'@babel/helper-plugin-utils'</span>)
<span class="hljs-keyword">const</span> getAbsoluteRuntimePath = () =&gt; {
  <span class="hljs-keyword">return</span> path.dirname(require.resolve(<span class="hljs-string">'@babel/runtime/package.json'</span>))
}
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = ({
  targets,
  ignoreBrowserslistConfig = <span class="hljs-keyword">false</span>,
  forceAllTransforms = <span class="hljs-keyword">false</span>,
  transformRuntime = <span class="hljs-keyword">true</span>,
  absoluteRuntime = <span class="hljs-keyword">false</span>,
  supportsDynamicImport = <span class="hljs-keyword">false</span>,
} = {}) =&gt; {
  <span class="hljs-keyword">return</span> declare(
    (
      api,
      {modules = <span class="hljs-string">'auto'</span>, absoluteRuntimePath = getAbsoluteRuntimePath()},
    ) =&gt; {
      api.assertVersion(<span class="hljs-number">7</span>)
      <span class="hljs-comment">// è¿”å›é…ç½®å†…å®¹</span>
      <span class="hljs-keyword">return</span> {
        <span class="hljs-comment">// https://github.com/webpack/webpack/issues/4039#issuecomment-419284940</span>
        sourceType: <span class="hljs-string">'unambiguous'</span>,
        exclude: /<span class="hljs-meta">@babel</span>\/runtime/,
        presets: [
          [
            require(<span class="hljs-string">'@babel/preset-env'</span>).<span class="hljs-keyword">default</span>,
            {
              <span class="hljs-comment">// ç»Ÿä¸€ @babel/preset-env é…ç½®</span>
              useBuiltIns: <span class="hljs-keyword">false</span>,
              modules,
              targets,
              ignoreBrowserslistConfig,
              forceAllTransforms,
              exclude: [<span class="hljs-string">'transform-typeof-symbol'</span>],
            },
          ],
        ],
        plugins: [
          transformRuntime &amp;&amp; [
            require(<span class="hljs-string">'@babel/plugin-transform-runtime'</span>).<span class="hljs-keyword">default</span>,
            {
              absoluteRuntime: absoluteRuntime ? absoluteRuntimePath : <span class="hljs-keyword">false</span>,
            },
          ],
          require(<span class="hljs-string">'@babel/plugin-syntax-dynamic-import'</span>).<span class="hljs-keyword">default</span>,
          !supportsDynamicImport &amp;&amp;
            !api.caller(caller =&gt; caller &amp;&amp; caller.supportsDynamicImport) &amp;&amp;
            require(<span class="hljs-string">'babel-plugin-dynamic-import-node'</span>),
          [
            require(<span class="hljs-string">'@babel/plugin-proposal-object-rest-spread'</span>).<span class="hljs-keyword">default</span>,
            {loose: <span class="hljs-keyword">true</span>, useBuiltIns: <span class="hljs-keyword">true</span>},
          ],
        ].filter(Boolean),
        env: {
          test: {
            presets: [
              [
                require(<span class="hljs-string">'@babel/preset-env'</span>).<span class="hljs-keyword">default</span>,
                {
                  useBuiltIns: <span class="hljs-keyword">false</span>,
                  targets: {node: <span class="hljs-string">'current'</span>},
                  ignoreBrowserslistConfig: <span class="hljs-keyword">true</span>,
                  exclude: [<span class="hljs-string">'transform-typeof-symbol'</span>],
                },
              ],
            ],
            plugins: [
              [
                require(<span class="hljs-string">'@babel/plugin-transform-runtime'</span>).<span class="hljs-keyword">default</span>,
                {
                  absoluteRuntime: absoluteRuntimePath,
                },
              ],
              require(<span class="hljs-string">'babel-plugin-dynamic-import-node'</span>),
            ],
          },
        },
      }
    },
  )
}
</code></pre>
<p data-nodeid="7708">åŸºäºä»¥ä¸Šè®¾è®¡ï¼Œå¯¹äº SSR åº”ç”¨çš„ç¼–è¯‘æµç¨‹ï¼ˆéœ€è¦ç¼–è¯‘é€‚é… Node.js ç¯å¢ƒï¼‰ä½¿ç”¨æ–¹æ³•ä¸ºï¼š</p>
<pre class="lang-java" data-nodeid="7709"><code data-language="java"><span class="hljs-comment">// webpack.config.js</span>
<span class="hljs-keyword">const</span> target = process.env.BUILD_TARGET <span class="hljs-comment">// 'web' | 'node'</span>
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {
  target,
  <span class="hljs-keyword">module</span>: {
    rules: [
      {
        test: /\.js$/,
        oneOf: [
          {
            exclude: /node_modules/,
            loader: <span class="hljs-string">'babel-loader'</span>,
            options: {
              cacheDirectory: <span class="hljs-keyword">true</span>,
              presets: [[<span class="hljs-string">'@lucas/babel-preset/app'</span>, {target}]],
            },
          },
          {
            loader: <span class="hljs-string">'babel-loader'</span>,
            options: {
              cacheDirectory: <span class="hljs-keyword">true</span>,
              configFile: <span class="hljs-keyword">false</span>,
              presets: [[<span class="hljs-string">'@lucas/babel-preset/dependencies'</span>, {target}]],
              compact: <span class="hljs-keyword">false</span>,
            },
          },
        ],
      },
    ],
  },
}
</code></pre>
<p data-nodeid="7710">æˆ‘ä»¬åŒæ ·æŒ‰ç…§<code data-backticks="1" data-nodeid="7957">node_modules</code>è¿›è¡Œäº†åŒºåˆ†ï¼Œå¯¹äº<code data-backticks="1" data-nodeid="7959">node_modules</code>ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œä½¿ç”¨<code data-backticks="1" data-nodeid="7961">@lucas/babel-preset/dependencies</code>é¢„è®¾ï¼ŒåŒæ—¶ä¼ å…¥<code data-backticks="1" data-nodeid="7963">target</code>å‚æ•°ã€‚å¯¹äºé<code data-backticks="1" data-nodeid="7965">node_modules</code>çš„ä¸šåŠ¡ä»£ç ï¼Œä½¿ç”¨<code data-backticks="1" data-nodeid="7967">@lucas/babel-preset/app</code>è¿™ä¸ªé¢„è®¾ï¼ŒåŒæ—¶è®¾å®šç›¸åº”ç¯å¢ƒ targetï¼Œ<code data-backticks="1" data-nodeid="7969">@lucas/babel-preset/app</code>å†…å®¹ä¸ºï¼š</p>
<pre class="lang-java" data-nodeid="7711"><code data-language="java"><span class="hljs-keyword">const</span> path = require(<span class="hljs-string">'path'</span>)
<span class="hljs-keyword">const</span> {declare} = require(<span class="hljs-string">'@babel/helper-plugin-utils'</span>)
<span class="hljs-keyword">const</span> getAbsoluteRuntimePath = () =&gt; {
  <span class="hljs-keyword">return</span> path.dirname(require.resolve(<span class="hljs-string">'@babel/runtime/package.json'</span>))
}
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = ({
  targets,
  ignoreBrowserslistConfig = <span class="hljs-keyword">false</span>,
  forceAllTransforms = <span class="hljs-keyword">false</span>,
  transformRuntime = <span class="hljs-keyword">true</span>,
  absoluteRuntime = <span class="hljs-keyword">false</span>,
  supportsDynamicImport = <span class="hljs-keyword">false</span>,
} = {}) =&gt; {
  <span class="hljs-keyword">return</span> declare(
    (
      api,
      {
        modules = <span class="hljs-string">'auto'</span>,
        absoluteRuntimePath = getAbsoluteRuntimePath(),
        react = <span class="hljs-keyword">true</span>,
        presetReactOptions = {},
      },
    ) =&gt; {
      api.assertVersion(<span class="hljs-number">7</span>)
      <span class="hljs-keyword">return</span> {
        presets: [
          [
            require(<span class="hljs-string">'@babel/preset-env'</span>).<span class="hljs-keyword">default</span>,
            {
              useBuiltIns: <span class="hljs-keyword">false</span>,
              modules,
              targets,
              ignoreBrowserslistConfig,
              forceAllTransforms,
              exclude: [<span class="hljs-string">'transform-typeof-symbol'</span>],
            },
          ],
          react &amp;&amp; [
            require(<span class="hljs-string">'@babel/preset-react'</span>).<span class="hljs-keyword">default</span>,
            {useBuiltIns: <span class="hljs-keyword">true</span>, runtime: <span class="hljs-string">'automatic'</span>, ...presetReactOptions},
          ],
        ].filter(Boolean),
        plugins: [
          transformRuntime &amp;&amp; [
            require(<span class="hljs-string">'@babel/plugin-transform-runtime'</span>).<span class="hljs-keyword">default</span>,
            {
              useESModules: <span class="hljs-string">'auto'</span>,
              absoluteRuntime: absoluteRuntime ? absoluteRuntimePath : <span class="hljs-keyword">false</span>,
            },
          ],
          <span class="hljs-comment">// https://github.com/facebook/create-react-app/issues/4263</span>
          [
            require(<span class="hljs-string">'@babel/plugin-proposal-class-properties'</span>).<span class="hljs-keyword">default</span>,
            {loose: <span class="hljs-keyword">true</span>},
          ],
          require(<span class="hljs-string">'@babel/plugin-syntax-dynamic-import'</span>).<span class="hljs-keyword">default</span>,
          !supportsDynamicImport &amp;&amp;
            !api.caller(caller =&gt; caller &amp;&amp; caller.supportsDynamicImport) &amp;&amp;
            require(<span class="hljs-string">'babel-plugin-dynamic-import-node'</span>),
          [
            require(<span class="hljs-string">'@babel/plugin-proposal-object-rest-spread'</span>).<span class="hljs-keyword">default</span>,
            {loose: <span class="hljs-keyword">true</span>, useBuiltIns: <span class="hljs-keyword">true</span>},
          ],
          require(<span class="hljs-string">'@babel/plugin-proposal-nullish-coalescing-operator'</span>).<span class="hljs-keyword">default</span>,
          require(<span class="hljs-string">'@babel/plugin-proposal-optional-chaining'</span>).<span class="hljs-keyword">default</span>,
        ].filter(Boolean),
        env: {
          development: {
            presets: [
              react &amp;&amp; [
                require(<span class="hljs-string">'@babel/preset-react'</span>).<span class="hljs-keyword">default</span>,
                {
                  useBuiltIns: <span class="hljs-keyword">true</span>,
                  development: <span class="hljs-keyword">true</span>,
                  runtime: <span class="hljs-string">'automatic'</span>,
                  ...presetReactOptions,
                },
              ],
            ].filter(Boolean),
          },
          test: {
            presets: [
              [
                require(<span class="hljs-string">'@babel/preset-env'</span>).<span class="hljs-keyword">default</span>,
                {
                  useBuiltIns: <span class="hljs-keyword">false</span>,
                  targets: {node: <span class="hljs-string">'current'</span>},
                  ignoreBrowserslistConfig: <span class="hljs-keyword">true</span>,
                  exclude: [<span class="hljs-string">'transform-typeof-symbol'</span>],
                },
              ],
              react &amp;&amp; [
                require(<span class="hljs-string">'@babel/preset-react'</span>).<span class="hljs-keyword">default</span>,
                {
                  useBuiltIns: <span class="hljs-keyword">true</span>,
                  development: <span class="hljs-keyword">true</span>,
                  runtime: <span class="hljs-string">'automatic'</span>,
                  ...presetReactOptions,
                },
              ],
            ].filter(Boolean),
            plugins: [
              [
                require(<span class="hljs-string">'@babel/plugin-transform-runtime'</span>).<span class="hljs-keyword">default</span>,
                {
                  useESModules: <span class="hljs-string">'auto'</span>,
                  absoluteRuntime: absoluteRuntimePath,
                },
              ],
              require(<span class="hljs-string">'babel-plugin-dynamic-import-node'</span>),
            ],
          },
        },
      }
    },
  )
}
</code></pre>
<p data-nodeid="7712">è€Œå¯¹äºä¸€ä¸ªå…¬å…±åº“ï¼Œä½¿ç”¨æ–¹å¼ä¸ºï¼š</p>
<pre class="lang-java" data-nodeid="7713"><code data-language="java"><span class="hljs-comment">// babel.config.js</span>
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {
  presets: [<span class="hljs-string">'@lucas/babel-preset/library'</span>],
}
</code></pre>
<p data-nodeid="7714">å¯¹åº”<code data-backticks="1" data-nodeid="7973">@lucas/babel-preset/library</code>å†…å®¹ä¸ºï¼š</p>
<pre class="lang-java" data-nodeid="7715"><code data-language="java"><span class="hljs-keyword">const</span> create = require(<span class="hljs-string">'../app/create'</span>)
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = create({
  targets: {node: <span class="hljs-string">'current'</span>},
  ignoreBrowserslistConfig: <span class="hljs-keyword">true</span>,
  supportsDynamicImport: <span class="hljs-keyword">true</span>,
})
</code></pre>
<p data-nodeid="7716">è¿™é‡Œçš„é¢„è®¾ä¼šå°†å…¬å…±åº“æŒ‰ç…§å½“å‰ Node.js ç¯å¢ƒæ ‡å‡†ç¼–è¯‘ã€‚å¦‚æœéœ€è¦å°†è¯¥å…¬å…±åº“ç¼–è¯‘é™çº§åˆ° ES5ï¼Œéœ€è¦ä½¿ç”¨<code data-backticks="1" data-nodeid="7976">@lucas/babel-preset/library/compact</code>å†…å®¹ä¸ºï¼š</p>
<pre class="lang-java" data-nodeid="7717"><code data-language="java"><span class="hljs-keyword">const</span> create = require(<span class="hljs-string">'../app/create'</span>)
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = create({
  ignoreBrowserslistConfig: <span class="hljs-keyword">true</span>,
  supportsDynamicImport: <span class="hljs-keyword">true</span>,
})
</code></pre>
<p data-nodeid="7718">è¿™é‡Œçš„<code data-backticks="1" data-nodeid="7979">../app/create.js</code>å³ä¸ºä¸Šè¿°<code data-backticks="1" data-nodeid="7981">@lucas/babel-preset/app</code>å†…å®¹ã€‚</p>
<p data-nodeid="7719">æˆ‘ä»¬é€šè¿‡å›¾ç¤ºæ¥è¡¨è¿°æ•´ä½“æ¶æ„ï¼š</p>
<p data-nodeid="7720"><img src="https://s0.lgstatic.com/i/image/M00/8C/C6/CgqCHl_0Bs2AS-oEABN0rwjVVsY144.png" alt="Drawing 1.png" data-nodeid="7986"></p>
<p data-nodeid="7721">éœ€è¦è¯´æ˜ä»¥ä¸‹å†…å®¹ã€‚</p>
<p data-nodeid="7722"><strong data-nodeid="8011">1. @lucas/babel-preset/appï¼š</strong><br>
åº”ç”¨é¡¹ç›®ä½¿ç”¨ï¼Œç¼–è¯‘é¡¹ç›®ä»£ç ã€‚SSR é¡¹ç›®å¯ä»¥é…ç½®å‚æ•° target: 'web' | 'node'ã€‚<strong data-nodeid="8012">é»˜è®¤æ”¯æŒ JSX è¯­æ³•ï¼Œå¹¶æ”¯æŒä¸€äº›å¸¸ç”¨çš„è¯­æ³•ææ¡ˆ</strong>(å¦‚ class properties)ã€‚</p>
<ul data-nodeid="7723">
<li data-nodeid="7724">
<p data-nodeid="7725">webï¼šå¼€å¯å…¨éƒ¨ transforms</p>
</li>
<li data-nodeid="7726">
<p data-nodeid="7727">nodeï¼šç¼–è¯‘åˆ° node: 'current'</p>
</li>
</ul>
<p data-nodeid="7728"><strong data-nodeid="8042">2. @lucas/babel-preset/dependencies</strong>ï¼šåº”ç”¨é¡¹ç›®ä½¿ç”¨ï¼Œç¼–è¯‘ node_modulesã€‚SSR é¡¹ç›®å¯ä»¥é…ç½®å‚æ•° target: 'web' | 'node'ã€‚<strong data-nodeid="8043">åªæ”¯æŒå½“å‰ ES è§„èŒƒåŒ…å«çš„è¯­æ³•ï¼Œä¸åŒ…å« JSX è¯­æ³•åŠææ¡ˆä¸­çš„è¯­æ³•æ”¯æŒ</strong>ã€‚</p>
<ul data-nodeid="7729">
<li data-nodeid="7730">
<p data-nodeid="7731">webï¼šå¼€å¯å…¨éƒ¨ transforms</p>
</li>
<li data-nodeid="7732">
<p data-nodeid="7733">nodeï¼šç¼–è¯‘åˆ° node: 'current'</p>
</li>
</ul>
<p data-nodeid="7734"><strong data-nodeid="8065">3. @lucas/babel-preset/libraryï¼š</strong> å…¬å…±åº“é¡¹ç›®ä½¿ç”¨ã€‚ç”¨äº prepare é˜¶æ®µçš„ Babel ç¼–è¯‘ã€‚(å¦‚ ./src é€šè¿‡ Babel ç¼–è¯‘åˆ° ./lib)ã€‚<strong data-nodeid="8066">é»˜è®¤æ”¯æŒ JSX è¯­æ³•ï¼Œå¹¶æ”¯æŒä¸€äº›å¸¸ç”¨çš„è¯­æ³•ææ¡ˆ</strong>(å¦‚ class properties)ã€‚ç¼–è¯‘åˆ° node: 'current'ã€‚å¦‚æœéœ€è¦å°† library ç¼–è¯‘ä¸º ES5ï¼Œéœ€è¦ä½¿ç”¨ @lucas/babel-preset/library/compatï¼›library æ‰“åŒ…ç¼–è¯‘ä¸º UMDï¼Œä½¿ç”¨ @lucas/babel-preset/appã€‚</p>
<p data-nodeid="7735">ä¸Šè¿°è®¾è®¡ï¼Œæˆ‘å‚è€ƒäº†<a href="https://github.com/facebook/create-react-app/blob/master/packages/babel-preset-react-app/create.js" data-nodeid="8070">facebook/create-react-app</a>éƒ¨åˆ†å†…å®¹ï¼Œå»ºè®®ä½ é˜…è¯»æºç ï¼Œå¹¶ç»“åˆæ³¨é‡Šç†è§£å…¶ç»†èŠ‚ï¼Œæ¯”å¦‚<a href="https://github.com/facebook/create-react-app/blob/master/packages/babel-preset-react-app/create.js#L87" data-nodeid="8074">å¯¹äº transform-typeof-symbol çš„ç¼–è¯‘</a>ï¼š</p>
<pre class="lang-java" data-nodeid="7736"><code data-language="java">(isEnvProduction || isEnvDevelopment) &amp;&amp; [
    <span class="hljs-comment">// æœ€æ–°ç¨³å®šçš„ ECMAScript ç‰¹æ€§</span>
    require(<span class="hljs-string">'@babel/preset-env'</span>).<span class="hljs-keyword">default</span>,
    {
      useBuiltIns: <span class="hljs-string">'entry'</span>,
      corejs: <span class="hljs-number">3</span>,
      <span class="hljs-comment">// æ’é™¤ transform-typeof-symbolï¼Œè¿™ä¼šè®©ç¼–è¯‘è¿‡æ…¢</span>
      exclude: [<span class="hljs-string">'transform-typeof-symbol'</span>],
    },
  ],
</code></pre>
<p data-nodeid="7737">åœ¨ä½¿ç”¨<code data-backticks="1" data-nodeid="8077">@babel/preset-env</code>æ—¶ï¼Œä½¿ç”¨äº†<code data-backticks="1" data-nodeid="8079">useBuiltIns: 'entry'</code>è®¾ç½® polyfillsï¼ŒåŒæ—¶å°†<code data-backticks="1" data-nodeid="8081">@babel/plugin-transform-typeof-symbol</code>æ’é™¤åœ¨å¤–ï¼Œè¿™æ˜¯å› ä¸º<code data-backticks="1" data-nodeid="8083">@babel/plugin-transform-typeof-symbol</code>ä¼šåŠ«æŒ typeof ç‰¹æ€§ï¼Œä½¿å¾—ä»£ç è¿è¡Œæ—¶å˜æ…¢ã€‚ç›¸å…³è®¨è®ºå¯å‚è§ <a href="https://github.com/facebook/create-react-app/pull/5278" data-nodeid="8087">issue</a>ã€‚</p>
<p data-nodeid="7738">æœ€åï¼Œè¿™é‡Œçš„é¢„è®¾è§„èŒƒå¹¶ä¸ä»£è¡¨å®Œå…¨çš„æœ€ä½³å®è·µï¼Œè€Œæ˜¯ä»¥ React æŠ€æœ¯æ ˆé£æ ¼ï¼Œç»Ÿä¸€ä¸€ä¸ªä¼ä¸šçº§å…¬å…±åº“å’Œæ¥å…¥å‡†åˆ™ï¼ŒBabel ç¼–è¯‘é¢„è®¾å¯ä»¥æŒ‰ç…§å®é™…é¡¹ç›®å’Œä¼ä¸šçš„éœ€è¦è¿›è¡Œè®¾è®¡ï¼Œè¿™é‡Œæ›´å¤šæ˜¯ä¸€ä¸ªå¯è¿ªçš„ä½œç”¨ã€‚</p>
<h3 data-nodeid="7739">æ€»ç»“</h3>
<p data-nodeid="7740">è¿™ä¸€è®²æˆ‘ä»¬ä»ä¸€ä¸ªâ€œçº¿ä¸Šé—®é¢˜â€å‡ºå‘ï¼Œå‰–æäº†å…¬å…±åº“å’Œåº”ç”¨æ–¹çš„ä¸åŒç¼–è¯‘ç†å¿µï¼Œå¹¶é€šè¿‡è®¾è®¡ä¸€ä¸ªä¸‡èƒ½ Babel é¢„è®¾ï¼Œé˜æ˜äº†å…¬å…±åº“çš„ç¼–è¯‘å’Œåº”ç”¨çš„ä½¿ç”¨éœ€è¦å¯†åˆ‡é…åˆï¼Œæ‰èƒ½åœ¨å½“å‰å‰ç«¯ç”Ÿæ€ä¸­ä¿éšœä¸€ä¸ªæ›´åˆç†çš„åŸºç¡€å»ºè®¾æ ¹åŸºã€‚ç›¸å…³çŸ¥è¯†å¹¶æœªå®Œç»“ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€è®²ä¸­ï¼Œä»é›¶æ‰“é€ ä¸€ä¸ªå…¬å…±åº“æ¥å®è·µè¯´æ˜ç›¸å…³ç†è®ºã€‚</p>
<p data-nodeid="7741" class="te-preview-highlight"><img src="https://s0.lgstatic.com/i/image2/M01/04/A4/Cip5yF_0OaOAPb48AAf5-twsvFI497.png" alt="å‰ç«¯åŸºå»º é‡‘å¥.png" data-nodeid="8094"></p>

---

### ç²¾é€‰è¯„è®º

##### *é¹ï¼š
> çœ‹å®Œä¸¤çœ¼ä¸€æŠ¹é»‘ï¼Œæ‡µé€¼äº†ã€‚ å¯¹babelé›¶åŸºç¡€çš„åº”è¯¥å…ˆä»å“ªä¸‹æ‰‹ï¼Ÿ

 ###### &nbsp;&nbsp;&nbsp; è®²å¸ˆå›å¤ï¼š
> &nbsp;&nbsp;&nbsp; å®˜ç½‘å’Œç¤¾åŒºèµ„æ–™

##### **ç”¨æˆ·7560ï¼š
> ä¸ºå•¥æ„Ÿè§‰è¿™äº›ä¸œè¥¿æ²¡ç”¨è¿‡å‘¢ï¼Œ æˆ‘ä»¬ç”¨çš„presetæ˜¯ @babel/preset-envè¿™ä¸ªä¸œè¥¿

 ###### &nbsp;&nbsp;&nbsp; è®²å¸ˆå›å¤ï¼š
> &nbsp;&nbsp;&nbsp; éƒ½æ˜¯ @babel/preset-envï¼Œé‡Œé¢é…ç½®æœ‰æ‰€åŒºåˆ«

##### **0216ï¼š
> è€å¸ˆè®²çš„å¤ªå¥½äº†ï¼Œå…¬å…±åº“å¼€å‘ä½“éªŒæœ‰ä»€ä¹ˆå¥½çš„åŠæ³•å—ï¼Ÿæœ€è¿‘å°±åœ¨å†™ä¸€ä¸ªuiåº“ï¼Œå’Œä¸šåŠ¡æ–¹ä¸æ˜¯monorepoï¼Œå°±é‡åˆ°äº†è°ƒè¯•é—®é¢˜ï¼Œç°åœ¨ç”¨çš„æ–¹æ³•æ˜¯ nodemon ç›‘æ§uiåº“æ–‡ä»¶å˜åŒ–ï¼Œç„¶åä½¿ç”¨ yalc publishï¼Œä¸šåŠ¡æ–¹åˆ™ç”¨ yalc add modules å®ç°çƒ­æ›´æ–°è°ƒè¯•ã€‚ä¸è¿‡è¿™ä¸ªåŠæ³•ä¸šåŠ¡æ–¹å–åˆ°çš„æ˜¯ç¼–è¯‘åçš„ dist æ–‡ä»¶ï¼Œæ–­ç‚¹è°ƒè¯•å°±å¾ˆä¸æ–¹ä¾¿

 ###### &nbsp;&nbsp;&nbsp; è®²å¸ˆå›å¤ï¼š
> &nbsp;&nbsp;&nbsp; è¿™ä¹ˆçœ‹ä¸€èˆ¬ä½¿ç”¨ yarn/npm link å§ã€‚è¿™ä¸ªé—®é¢˜ä¸æ˜¯ monorepo çš„é—®é¢˜ï¼Œæ˜¯ä»»ä½•ä¸€ä¸ªå…¬å…±åº“éƒ½ä¼šé‡è§çš„é—®é¢˜ã€‚å› æ­¤å…¶å®å¹¶ä¸ç®—ä¸€ä¸ªé—®é¢˜ï¼Œä½ ä½œä¸ºåº“çš„å¼€å‘è€…ï¼Œåº”å½“ä¿è¯å‘ç‰ˆåçš„å¯ç”¨æ€§ï¼Œè€Œä¸šåŠ¡åšæˆ–è€…ä¸åšç›¸åº”çš„å‡çº§

##### **8621ï¼š
> è¿™ç¯‡å¤ªéš¾äº†ï¼Œç›®å‰æ°´å¹³çœ‹ä¸å¤ªæ‡‚ï¼Œå¥½å›°æƒ‘ï¼Œç­‰æˆ‘å†å­¦ä¹ å­¦ä¹ babelå†æ¥â€¦â€¦ğŸ˜¨

 ###### &nbsp;&nbsp;&nbsp; ç¼–è¾‘å›å¤ï¼š
> &nbsp;&nbsp;&nbsp; åŠ æ²¹~

##### **é»ï¼š
> æˆ‘åˆšçœ‹å®Œè¿™ç¯‡å°±é‡åˆ°äº†ä¸€ä¸ªios10.2çš„ç™½å±é—®é¢˜ï¼Œç§’è§£å†³ğŸ˜€

##### **é»ï¼š
> babelæ„Ÿè§‰è‡ªå·±å¾ˆé™Œç”Ÿï¼Œæœ‰ä»€ä¹ˆå¥½çš„å­¦ä¹ èµ„æ–™å—ï¼Ÿ

 ###### &nbsp;&nbsp;&nbsp; è®²å¸ˆå›å¤ï¼š
> &nbsp;&nbsp;&nbsp; å®˜ç½‘ï¼Œå®˜ç½‘åƒé€ï¼Œä½ å°±æ¯”æˆ‘å¼º~

##### Darcyï¼š
> æœŸå¾…æ–°ç« èŠ‚

 ###### &nbsp;&nbsp;&nbsp; ç¼–è¾‘å›å¤ï¼š
> &nbsp;&nbsp;&nbsp; å‘¨1/3æ›´æ–°å“ˆï¼Œä¸‹ä¸€è®²ä¹Ÿå¹²è´§æ»¡æ»¡ï¼

##### *ä¿Šï¼š
> ä½œä¸ºå‰ç«¯å·¥ç¨‹åŒ–çš„å†…å®¹å¾ˆå¥½ï¼Œè¿«ä¸åŠå¾…çœ‹å®Œ

