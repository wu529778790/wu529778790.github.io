<p data-nodeid="1489" class="">ä¸Šä¸€è®²æˆ‘ä»¬ä» Babel ç¼–è¯‘é¢„è®¾çš„è§’åº¦ç†æ¸…äº†å‰ç«¯ç”Ÿæ€ä¸­çš„å…¬å…±åº“å’Œåº”ç”¨çš„ä¸ç¼•å…³è”ï¼Œè¿™ä¸€è®²æˆ‘ä»¬å°±ä»å®æˆ˜å‡ºå‘ï¼ŒåŠ¨æ‰‹å‰–æä¸€ä¸ªå…¬å…±åº“ä»è®¾è®¡åˆ°å®Œæˆçš„è¿‡ç¨‹ã€‚</p>
<p data-nodeid="1490">ï¼ˆæºç å‡ºå¤„ï¼š<a href="https://github.com/intricatecloud/reusable-js-demo" data-nodeid="1608">Creating a simple npm library to use in and out of the browserï¼‰</a></p>
<h3 data-nodeid="1491">å®æˆ˜æ‰“é€ ä¸€ä¸ªå…¬å…±åº“</h3>
<p data-nodeid="1492">ä¸‹é¢æˆ‘ä»¬ä»å®æˆ˜å‡ºå‘ï¼Œä» 0 åˆ° 1 æ„å»ºä¸€ä¸ªç¬¦åˆæ ‡å‡†çš„å…¬å…±åº“ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ï¼Œå€ŸåŠ© <a href="https://github.com/public-apis/public-apis" data-nodeid="1613">Public APIs</a>ï¼Œé€šè¿‡ç½‘ç»œè¯·æ±‚è·å– dogs/cats/goats ä¸‰ç§åŠ¨ç‰©çš„éšæœºå›¾åƒï¼Œå¹¶è¿›è¡Œå±•ç¤ºã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå°†æ•´ä¸ªé€»è¾‘è¿‡ç¨‹æŠ½è±¡æˆå¯ä»¥åœ¨æµè§ˆå™¨ç«¯å’Œ Node.js ç«¯å¤ç”¨çš„ npm åŒ…ï¼Œç¼–è¯‘æ„å»ºä½¿ç”¨ Webpack å’Œ Babelã€‚</p>
<p data-nodeid="1493">é¦–å…ˆåˆ›å»ºæ–‡ä»¶ï¼š</p>
<pre class="lang-java" data-nodeid="1494"><code data-language="java">$ mkdir animal-api
$ cd animal-api
$ npm init
</code></pre>
<p data-nodeid="1495">å¹¶é€šè¿‡ npm init åˆå§‹åŒ–ä¸€ä¸ª package.json æ–‡ä»¶ï¼š</p>
<pre class="lang-java" data-nodeid="1496"><code data-language="java">{
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"animal-api"</span>,
  <span class="hljs-string">"version"</span>: <span class="hljs-string">"1.0.0"</span>,
  <span class="hljs-string">"description"</span>: <span class="hljs-string">""</span>,
  <span class="hljs-string">"main"</span>: <span class="hljs-string">"index.js"</span>,
  <span class="hljs-string">"scripts"</span>: {
    <span class="hljs-string">"test"</span>: <span class="hljs-string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>
  },
  <span class="hljs-string">"author"</span>: <span class="hljs-string">""</span>,
  <span class="hljs-string">"license"</span>: <span class="hljs-string">"ISC"</span>
}
</code></pre>
<p data-nodeid="1497">ç¼–å†™<code data-backticks="1" data-nodeid="1618">index.js</code>ä»£ç é€»è¾‘éå¸¸ç®€å•ï¼Œå¦‚ä¸‹ï¼š</p>
<pre class="lang-java" data-nodeid="1498"><code data-language="java"><span class="hljs-keyword">import</span> axios from <span class="hljs-string">'axios'</span>;
<span class="hljs-keyword">const</span> getCat = () =&gt; {
    <span class="hljs-comment">// å‘é€è¯·æ±‚</span>
    <span class="hljs-keyword">return</span> axios.get(<span class="hljs-string">'https://aws.random.cat/meow'</span>).then((response) =&gt; {
        <span class="hljs-keyword">const</span> imageSrc = response.data.file
        <span class="hljs-keyword">const</span> text = <span class="hljs-string">'CAT'</span>
        <span class="hljs-keyword">return</span> {imageSrc, text}
    })
}
<span class="hljs-keyword">const</span> getDog = () =&gt; {
    <span class="hljs-keyword">return</span> axios.get(<span class="hljs-string">'https://random.dog/woof.json'</span>).then((response) =&gt; {
        <span class="hljs-keyword">const</span> imageSrc = response.data.url
        <span class="hljs-keyword">const</span> text = <span class="hljs-string">'DOG'</span>
        <span class="hljs-keyword">return</span> {imageSrc, text}
    })
}
<span class="hljs-keyword">const</span> getGoat = () =&gt; {
    <span class="hljs-keyword">const</span> imageSrc = <span class="hljs-string">'http://placegoat.com/200'</span>
    <span class="hljs-keyword">const</span> text = <span class="hljs-string">'GOAT'</span>
    <span class="hljs-keyword">return</span> Promise.resolve({imageSrc, text})
}
export <span class="hljs-keyword">default</span> {
    getDog,
    getCat,
    getGoat
}
</code></pre>
<p data-nodeid="1499">æˆ‘ä»¬é€šè¿‡ä¸‰ä¸ªæ¥å£ï¼š</p>
<ul data-nodeid="1500">
<li data-nodeid="1501">
<p data-nodeid="1502">https://aws.random.cat/meow</p>
</li>
<li data-nodeid="1503">
<p data-nodeid="1504">https://random.dog/woof.json</p>
</li>
<li data-nodeid="1505">
<p data-nodeid="1506">http://placegoat.com/200</p>
</li>
</ul>
<p data-nodeid="1507">å°è£…äº†ä¸‰ä¸ªè·å–å›¾ç‰‡åœ°å€çš„å‡½æ•°ï¼š</p>
<ul data-nodeid="1508">
<li data-nodeid="1509">
<p data-nodeid="1510">getDog()</p>
</li>
<li data-nodeid="1511">
<p data-nodeid="1512">getCat()</p>
</li>
<li data-nodeid="1513">
<p data-nodeid="1514">getGoat()</p>
</li>
</ul>
<p data-nodeid="1515"><a href="https://github.com/intricatecloud/reusable-js-demo" data-nodeid="1630">æºç </a>é€šè¿‡ ESM çš„æ–¹å¼æä¾›å¯¹å¤–æ¥å£ï¼Œè¯·ä½ æ³¨æ„è¿™é‡Œçš„æ¨¡å—åŒ–æ–¹å¼ï¼Œè¿™æ˜¯ä¸€ä¸ªå…¬å…±åº“è®¾è®¡çš„å…³é”®ç‚¹ä¹‹ä¸€ï¼Œåæ–‡ä¼šæ›´è¯¦ç»†è§£æã€‚</p>
<p data-nodeid="1516">å¯¹å…¬å…±åº“æ¥è¯´ï¼Œè´¨é‡ä¿è¯è‡³å…³é‡è¦ã€‚æˆ‘ä»¬ä½¿ç”¨ Jest æ¥è¿›è¡Œ animal-api è¿™ä¸ªå…¬å…±åº“çš„å•å…ƒæµ‹è¯•ã€‚Jest ä½œä¸º devDependecies è¢«å®‰è£…ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre class="lang-java" data-nodeid="1517"><code data-language="java">npm install --save-dev jest
</code></pre>
<p data-nodeid="1518">ç¼–å†™æµ‹è¯•è„šæœ¬<code data-backticks="1" data-nodeid="1634">animal-api/spec/index.spec.js</code>ï¼š</p>
<pre class="lang-java" data-nodeid="1519"><code data-language="java"><span class="hljs-keyword">import</span> AnimalApi from <span class="hljs-string">'../index'</span>
describe(<span class="hljs-string">'animal-api'</span>, () =&gt; {
    it(<span class="hljs-string">'gets dogs'</span>, () =&gt; {
        <span class="hljs-keyword">return</span> AnimalApi.getDog()
            .then((animal) =&gt; {
                expect(animal.imageSrc).not.toBeUndefined()
                expect(animal.text).toEqual(<span class="hljs-string">'DOG'</span>)
            })
   })
})
</code></pre>
<p data-nodeid="1520">æ”¹å†™ package.json ä¸­ test script ä¸º "test": "jest"ï¼Œæˆ‘ä»¬é€šè¿‡è¿è¡Œ<code data-backticks="1" data-nodeid="1645">npm run test</code>æ¥æµ‹è¯•ã€‚</p>
<p data-nodeid="1521">è¿™æ—¶å€™ä¼šå¾—åˆ°æŠ¥é”™ï¼šSyntaxError: Unexpected identifierï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p data-nodeid="1522"><img src="https://s0.lgstatic.com/i/image/M00/8D/0B/Ciqc1F_4C52AbkzPAAJt3nzLhAo939.png" alt="Drawing 0.png" data-nodeid="1650"></p>
<p data-nodeid="1523">ä¸è¦æ…Œï¼Œè¿™æ˜¯å› ä¸º Jest å¹¶ä¸â€œè®¤è¯†â€import è¿™æ ·çš„å…³é”®å­—ã€‚Jest è¿è¡Œåœ¨ Node.js ç¯å¢ƒä¸­ï¼Œå¤§éƒ¨åˆ† Node.js ç‰ˆæœ¬ï¼ˆv10 ä»¥ä¸‹ï¼‰è¿è¡Œæ—¶å¹¶ä¸æ”¯æŒ ESMï¼Œä¸ºäº†å¯ä»¥ä½¿ç”¨ ESM æ–¹å¼ç¼–å†™æµ‹è¯•è„šæœ¬ï¼Œæˆ‘ä»¬éœ€è¦<strong data-nodeid="1656">å®‰è£… babel-jest å’Œ Babel ç›¸å…³ä¾èµ–åˆ°å¼€å‘ç¯å¢ƒä¸­</strong>ï¼š</p>
<pre class="lang-java" data-nodeid="1524"><code data-language="java">npm install --save-dev babel-jest <span class="hljs-meta">@babel</span>/core <span class="hljs-meta">@babel</span>/preset-env
</code></pre>
<p data-nodeid="1525">åŒæ—¶åˆ›å»º<code data-backticks="1" data-nodeid="1658">babel.config.js</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre class="lang-java" data-nodeid="1526"><code data-language="java"><span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {
  presets: [
    [
      <span class="hljs-string">'@babel/preset-env'</span>,
      {
        targets: {
          node: <span class="hljs-string">'current'</span>,
        },
      },
    ],
  ],
};
</code></pre>
<p data-nodeid="1527">æ³¨æ„ä¸Šè¿°ä»£ç ï¼Œæˆ‘ä»¬å°† @babel/preset-env çš„ targets.node å±æ€§è®¾ç½®ä¸ºå½“å‰ç¯å¢ƒ currentã€‚å†æ¬¡æ‰§è¡Œ<code data-backticks="1" data-nodeid="1661">npm run test</code>ï¼Œå¾—åˆ°æŠ¥é”™å¦‚ä¸‹ï¼šCannot find module 'axios' from 'index.js'ã€‚</p>
<p data-nodeid="1528"><img src="https://s0.lgstatic.com/i/image/M00/8D/0B/Ciqc1F_4C6iABmVIAAGxme4pZVw996.png" alt="Drawing 1.png" data-nodeid="1673"></p>
<p data-nodeid="1529">åŸå› çœ‹æŠ¥é”™ä¿¡æ¯å³å¯å¾—åˆ°ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£… axiosã€‚æ³¨æ„ï¼šaxios åº”è¯¥ä½œä¸ºç”Ÿäº§ä¾èµ–è¢«å®‰è£…ï¼š</p>
<pre class="lang-java" data-nodeid="1530"><code data-language="java">npm install --save axios
</code></pre>
<p data-nodeid="1531">ç°åœ¨ï¼Œæˆ‘ä»¬çš„æµ‹è¯•è„šæœ¬å°±å¯ä»¥æ­£å¸¸è¿è¡Œäº†ã€‚å¦‚ä¸‹å›¾ï¼š</p>
<p data-nodeid="1532"><img src="https://s0.lgstatic.com/i/image/M00/8D/16/CgqCHl_4C7CAd4ITAAJD5qJ-Ziw380.png" alt="Drawing 2.png" data-nodeid="1678"></p>
<p data-nodeid="1533">å½“ç„¶ï¼Œè¿™åªæ˜¯ç»™å…¬å…±åº“æ¥å…¥æµ‹è¯•ï¼Œâ€œä¸‡é‡Œé•¿å¾â€æ‰å¼€å§‹ç¬¬ä¸€æ­¥ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æŒ‰ç…§å„ç§åœºæ™¯è¿›è¡Œæ›´å¤šæ¢ç´¢ã€‚</p>
<h3 data-nodeid="1534">æ‰“é€ å…¬å…±åº“ï¼Œæ”¯æŒ script æ ‡ç­¾å¼•å…¥</h3>
<p data-nodeid="1535">åœ¨å¤§éƒ¨åˆ†ä¸æ”¯æŒ import è¯­æ³•ç‰¹æ€§çš„æµè§ˆå™¨ä¸­ï¼Œä¸ºäº†è®©æˆ‘ä»¬çš„è„šæœ¬ç›´æ¥åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ script æ ‡ç­¾å¼•å…¥ä»£ç ï¼Œé¦–å…ˆæˆ‘ä»¬<strong data-nodeid="1686">éœ€è¦å°†å·²æœ‰å…¬å…±åº“è„šæœ¬ç¼–è¯‘ä¸º UMD æ–¹å¼</strong>ã€‚ç±»ä¼¼ä¸Šé¢ä½¿ç”¨ babel-jest å°†æµ‹è¯•è„šæœ¬ç¼–è¯‘é™çº§ä¸ºå½“å‰ Node.js ç‰ˆæœ¬æ”¯æŒçš„ä»£ç ï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦ Babel è¿›è¡Œé™çº§ã€‚</p>
<p data-nodeid="1536">æ³¨æ„è¿™æ¬¡ä¸åŒä¹‹å¤„åœ¨äºï¼š<strong data-nodeid="1694">è¿™é‡Œçš„é™çº§éœ€è¦è¾“å‡ºä»£ç å†…å®¹åˆ°ä¸€ä¸ª output ç›®å½•ä¸­ï¼Œæµè§ˆå™¨å³å¯ç›´æ¥å¼•å…¥è¯¥ output ç›®å½•ä¸­çš„ç¼–è¯‘åèµ„æº</strong>ã€‚æˆ‘ä»¬ä½¿ç”¨<code data-backticks="1" data-nodeid="1692">@babel/plugin-transform-modules-umd</code>æ¥å®Œæˆå¯¹ä»£ç çš„é™çº§ç¼–è¯‘ï¼š</p>
<pre class="lang-java" data-nodeid="1537"><code data-language="java">$ npm install --save-dev <span class="hljs-meta">@babel</span>/plugin-transform-modules-umd <span class="hljs-meta">@babel</span>/core <span class="hljs-meta">@babel</span>/cli
</code></pre>
<p data-nodeid="1538">åŒæ—¶åœ¨ package.json ä¸­åŠ å…¥ç›¸å…³ script å†…å®¹ï¼š<code data-backticks="1" data-nodeid="1696">"build": "babel index.js -d lib"</code>ï¼Œæ‰§è¡Œ<code data-backticks="1" data-nodeid="1698">npm run build</code>ï¼Œå¾—åˆ°äº§å‡ºï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼š</p>
<p data-nodeid="1539"><img src="https://s0.lgstatic.com/i/image/M00/8D/0B/Ciqc1F_4C7iARwtEAAEQS1jliOM385.png" alt="Drawing 3.png" data-nodeid="1702"></p>
<p data-nodeid="1540">æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­éªŒè¯äº§å‡ºï¼š</p>
<pre class="lang-java" data-nodeid="1541"><code data-language="java">&lt;script src="./lib/index.js"&gt;&lt;/script&gt;
&lt;script&gt;
    AnimalApi.getDog().then(function(animal) {
        document.querySelector('#imageSrc').textContent = animal.imageSrc
        document.querySelector('#text').textContent = animal.text
    })
&lt;/script&gt;
</code></pre>
<p data-nodeid="1542">ç»“æœå‡ºç°äº†æŠ¥é”™ï¼š</p>
<pre class="lang-java" data-nodeid="1543"><code data-language="java">index.html:<span class="hljs-number">11</span> Uncaught ReferenceError: AnimalApi is not defined
    at index.html:<span class="hljs-number">11</span>
</code></pre>
<p data-nodeid="1544">å¹¶æ²¡æœ‰æ‰¾åˆ° AnimalApi è¿™ä¸ªå¯¹è±¡ï¼Œé‡æ–°ç¿»çœ‹ç¼–è¯‘äº§å‡ºæºç ï¼š</p>
<pre class="lang-java" data-nodeid="1545"><code data-language="java"><span class="hljs-string">"use strict"</span>;
Object.defineProperty(<span class="hljs-keyword">exports</span>, <span class="hljs-string">"__esModule"</span>, {
  value: <span class="hljs-keyword">true</span>
});
<span class="hljs-keyword">exports</span>.<span class="hljs-keyword">default</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;
<span class="hljs-comment">// å¼•å…¥ axios</span>
<span class="hljs-keyword">var</span> _axios = _interopRequireDefault(require(<span class="hljs-string">"axios"</span>));
<span class="hljs-comment">//  å…¼å®¹ default å¯¼å‡º</span>
<span class="hljs-function">function <span class="hljs-title">_interopRequireDefault</span><span class="hljs-params">(obj)</span> </span>{ <span class="hljs-keyword">return</span> obj &amp;&amp; obj.__esModule ? obj : { <span class="hljs-keyword">default</span>: obj }; }
<span class="hljs-comment">// åŸ getCat æ–¹æ³•</span>
<span class="hljs-keyword">const</span> getCat = () =&gt; {
  <span class="hljs-keyword">return</span> _axios.<span class="hljs-keyword">default</span>.get(<span class="hljs-string">'https://aws.random.cat/meow'</span>).then(response =&gt; {
    <span class="hljs-keyword">const</span> imageSrc = response.data.file;
    <span class="hljs-keyword">const</span> text = <span class="hljs-string">'CAT'</span>;
    <span class="hljs-keyword">return</span> {
      imageSrc,
      text
    };
  });
};
<span class="hljs-comment">// åŸ getDog æ–¹æ³•</span>
<span class="hljs-keyword">const</span> getDog = () =&gt; {
  <span class="hljs-keyword">return</span> _axios.<span class="hljs-keyword">default</span>.get(<span class="hljs-string">'https://random.dog/woof.json'</span>).then(response =&gt; {
    <span class="hljs-keyword">const</span> imageSrc = response.data.url;
    <span class="hljs-keyword">const</span> text = <span class="hljs-string">'DOG'</span>;
    <span class="hljs-keyword">return</span> {
      imageSrc,
      text
    };
  });
};
<span class="hljs-comment">// åŸ getGoat æ–¹æ³•</span>
<span class="hljs-keyword">const</span> getGoat = () =&gt; {
  <span class="hljs-keyword">const</span> imageSrc = <span class="hljs-string">'http://placegoat.com/200'</span>;
  <span class="hljs-keyword">const</span> text = <span class="hljs-string">'GOAT'</span>;
  <span class="hljs-keyword">return</span> Promise.resolve({
    imageSrc,
    text
  });
};
<span class="hljs-comment">// é»˜è®¤å¯¼å‡ºå¯¹è±¡</span>
<span class="hljs-keyword">var</span> _default = {
  getDog,
  getCat,
  getGoat
};
<span class="hljs-keyword">exports</span>.<span class="hljs-keyword">default</span> = _default;
</code></pre>
<p data-nodeid="1546">å‘ç°å‡ºç°æŠ¥é”™æ˜¯å› ä¸º Babel çš„ç¼–è¯‘äº§å‡ºå¦‚æœè¦æ”¯æŒå…¨å±€å‘½åï¼ˆAnimalApiï¼‰ç©ºé—´ï¼Œéœ€è¦æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š</p>
<pre class="lang-java" data-nodeid="1547"><code data-language="java">  plugins: [
      [<span class="hljs-string">"@babel/plugin-transform-modules-umd"</span>, {
      exactGlobals: <span class="hljs-keyword">true</span>,
      globals: {
        index: <span class="hljs-string">'AnimalApi'</span>
      }
    }]
  ],
</code></pre>
<p data-nodeid="1548">è°ƒæ•´åå†è¿è¡Œç¼–è¯‘ï¼Œå¾—åˆ°æºç ï¼š</p>
<pre class="lang-java" data-nodeid="1549"><code data-language="java"><span class="hljs-comment">// umd å¯¼å‡ºæ ¼å¼</span>
(function (global, factory) {
  <span class="hljs-comment">// å…¼å®¹ amd æ–¹å¼</span>
  <span class="hljs-keyword">if</span> (typeof define === <span class="hljs-string">"function"</span> &amp;&amp; define.amd) {
    define([<span class="hljs-string">"exports"</span>, <span class="hljs-string">"axios"</span>], factory);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (typeof <span class="hljs-keyword">exports</span> !== <span class="hljs-string">"undefined"</span>) {
    factory(<span class="hljs-keyword">exports</span>, require(<span class="hljs-string">"axios"</span>));
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> mod = {
      <span class="hljs-keyword">exports</span>: {}
    };
    factory(mod.<span class="hljs-keyword">exports</span>, global.axios);
    <span class="hljs-comment">// æŒ‚è½½ AnimalApi å¯¹è±¡</span>
    global.AnimalApi = mod.<span class="hljs-keyword">exports</span>;
  }
})(typeof globalThis !== <span class="hljs-string">"undefined"</span> ? globalThis : typeof self !== <span class="hljs-string">"undefined"</span> ? self : <span class="hljs-keyword">this</span>, function (_exports, _axios) {
  <span class="hljs-string">"use strict"</span>;
  Object.defineProperty(_exports, <span class="hljs-string">"__esModule"</span>, {
    value: <span class="hljs-keyword">true</span>
  });
  _exports.<span class="hljs-keyword">default</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;
  _axios = _interopRequireDefault(_axios);
  <span class="hljs-comment">// å…¼å®¹ default å¯¼å‡º</span>
  <span class="hljs-function">function <span class="hljs-title">_interopRequireDefault</span><span class="hljs-params">(obj)</span> </span>{ <span class="hljs-keyword">return</span> obj &amp;&amp; obj.__esModule ? obj : { <span class="hljs-keyword">default</span>: obj }; }
  <span class="hljs-keyword">const</span> getCat = () =&gt; {
    <span class="hljs-keyword">return</span> _axios.<span class="hljs-keyword">default</span>.get(<span class="hljs-string">'https://aws.random.cat/meow'</span>).then(response =&gt; {
      <span class="hljs-keyword">const</span> imageSrc = response.data.file;
      <span class="hljs-keyword">const</span> text = <span class="hljs-string">'CAT'</span>;
      <span class="hljs-keyword">return</span> {
        imageSrc,
        text
      };
    });
  };
  <span class="hljs-keyword">const</span> getDog = () =&gt; {
    <span class="hljs-comment">// ... çœç•¥</span>
  };
  <span class="hljs-keyword">const</span> getGoat = () =&gt; {
    <span class="hljs-comment">// ... çœç•¥</span>
  };
  <span class="hljs-keyword">var</span> _default = {
    getDog,
    getCat,
    getGoat
  };
  _exports.<span class="hljs-keyword">default</span> = _default;
});
</code></pre>
<p data-nodeid="1550">è¿™æ—¶ï¼Œ<strong data-nodeid="1713">ç¼–è¯‘æºç äº§å‡ºå†…å®¹æ”¹ä¸ºäº†ç”±ä¸€ä¸ª IIFE å½¢å¼å®ç°çš„å‘½åç©ºé—´</strong>ã€‚åŒæ—¶è§‚å¯Ÿæºç ï¼š</p>
<pre class="lang-java" data-nodeid="1551"><code data-language="java">global.AnimalApi = mod.<span class="hljs-keyword">exports</span>;
...
<span class="hljs-keyword">var</span> _default = {
    getDog,
    getCat,
    getGoat
  };
  _exports.<span class="hljs-keyword">default</span> = _default;
</code></pre>
<p data-nodeid="1552">ä¸ºäº†å…¼å®¹ ESM ç‰¹æ€§ï¼Œå¯¼å‡ºå†…å®¹å…¨éƒ¨æŒ‚åœ¨äº† default å±æ€§ä¸­ï¼ˆå¯ä»¥é€šè¿‡ libraryExport å±æ€§æ¥åˆ‡æ¢ï¼‰ï¼Œæˆ‘ä»¬çš„å¼•ç”¨æ–¹å¼éœ€è¦æ”¹ä¸ºï¼š</p>
<pre class="lang-java" data-nodeid="1553"><code data-language="java">AnimalApi.<span class="hljs-keyword">default</span>.getDog().then(function(animal) {
    ...
})
</code></pre>
<p data-nodeid="1554">è§£å†³äº†ä»¥ä¸Šæ‰€æœ‰é—®é¢˜ï¼Œçœ‹ä¼¼å¤§åŠŸå‘Šæˆäº†ï¼Œä½†æ˜¯å·¥ç¨‹çš„è®¾è®¡æ²¡æœ‰è¿™ä¹ˆç®€å•ã€‚äº‹å®ä¸Šï¼Œ<strong data-nodeid="1724">åœ¨æºç ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨å¼•å…¥å¹¶ç¼–è¯‘ index.js æ‰€éœ€è¦çš„ä¾èµ–</strong>ï¼Œæ¯”å¦‚ axios å¹¶æ²¡æœ‰è¢«å¼•å…¥å¤„ç†ã€‚æ­£ç¡®çš„æ–¹å¼åº”è¯¥æ˜¯<strong data-nodeid="1725">æŠŠå…¬å…±åº“éœ€è¦çš„ä¾èµ–ï¼Œä¸€å¹¶æŒ‰ç…§ä¾èµ–å…³ç³»è¿›è¡Œæ‰“åŒ…å’Œå¼•å…¥</strong>ã€‚</p>
<p data-nodeid="1555">ä¸ºäº†è§£å†³ä¸Šé¢è¿™ä¸ªé—®é¢˜ï¼Œæ­¤æ—¶éœ€è¦å¼•å…¥ Webpackï¼š</p>
<pre class="lang-java" data-nodeid="1556"><code data-language="java">npm install --save-dev webpack webpack-cli
</code></pre>
<p data-nodeid="1557">åŒæ—¶æ·»åŠ <code data-backticks="1" data-nodeid="1728">webpack.config.js</code>ï¼Œå†…å®¹ä¸ºï¼š</p>
<pre class="lang-java" data-nodeid="1558"><code data-language="java"><span class="hljs-keyword">const</span> path = require(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {
  entry: <span class="hljs-string">'./index.js'</span>,
  output: {
    path: path.resolve(__dirname, <span class="hljs-string">'lib'</span>),
    filename: <span class="hljs-string">'animal-api.js'</span>,
    library: <span class="hljs-string">'AnimalApi'</span>,
    libraryTarget: <span class="hljs-string">'var'</span>
  },
};
</code></pre>
<p data-nodeid="1559">æˆ‘ä»¬è®¾ç½®å…¥å£ä¸º<code data-backticks="1" data-nodeid="1731">./index.js</code>ï¼Œæ„å»ºäº§å‡ºä¸º<code data-backticks="1" data-nodeid="1733">./lib/animal-api.js</code>ï¼ŒåŒæ—¶é€šè¿‡è®¾ç½® library å’Œ libraryTarget å°† AnimalApi ä½œä¸ºå…¬å…±åº“å¯¹å¤–æš´éœ²çš„å‘½åç©ºé—´ã€‚ä¿®æ”¹<code data-backticks="1" data-nodeid="1735">package.json</code>ä¸­çš„ build script ä¸º<code data-backticks="1" data-nodeid="1737">"build": "webpack"</code>ï¼Œæ‰§è¡Œ<code data-backticks="1" data-nodeid="1739">npm run build</code>ï¼Œå¾—åˆ°äº§å‡ºï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p data-nodeid="1560"><img src="https://s0.lgstatic.com/i/image2/M01/04/EE/Cip5yF_4C9GAfFJAAAYFu4ci4cM274.png" alt="Drawing 4.png" data-nodeid="1743"></p>
<p data-nodeid="1561">è‡³æ­¤ï¼Œæˆ‘ä»¬ç»ˆäºæ„é€ å‡ºäº†èƒ½å¤Ÿåœ¨æµè§ˆå™¨ä¸­é€šè¿‡ script æ ‡ç­¾å¼•å…¥çš„å…¬å…±åº“ã€‚å½“ç„¶ï¼Œä¸€ä¸ªç°ä»£åŒ–çš„å…¬å…±åº“è¿˜éœ€è¦æ”¯æŒæ›´å¤šåœºæ™¯ï¼Œè¯·ç»§ç»­é˜…è¯»ã€‚</p>
<h3 data-nodeid="1562">æ‰“é€ å…¬å…±åº“ï¼Œæ”¯æŒ Node.js ç¯å¢ƒ</h3>
<p data-nodeid="1563">ç°åœ¨å·²ç»å®Œæˆäº†å…¬å…±åº“çš„æµè§ˆå™¨ç«¯æ”¯æŒï¼Œä¸‹é¢æˆ‘ä»¬è¦é›†ä¸­ç²¾åŠ›é€‚é…ä¸€ä¸‹ Node.js ç¯å¢ƒäº†ã€‚</p>
<p data-nodeid="1564">é¦–å…ˆç¼–å†™ä¸€ä¸ª<code data-backticks="1" data-nodeid="1748">node.test.js</code>æ–‡ä»¶ï¼Œè¿›è¡Œ Node.js ç¯å¢ƒçš„éªŒè¯ï¼š</p>
<pre class="lang-java" data-nodeid="1565"><code data-language="java"><span class="hljs-keyword">const</span> AnimalApi = require(<span class="hljs-string">'./index.js'</span>)
AnimalApi.getCat().then(animal =&gt; {
    console.log(animal)
})
</code></pre>
<p data-nodeid="1566">è¿™ä¸ªæ–‡ä»¶çš„æ„ä¹‰åœ¨äº<strong data-nodeid="1757">æµ‹è¯•å…¬å…±åº“æ˜¯å¦èƒ½åœ¨ Node.js ç¯å¢ƒä¸‹ä½¿ç”¨</strong>ã€‚æ‰§è¡Œ<code data-backticks="1" data-nodeid="1755">node node-test.js</code>ï¼Œä¸å‡ºæ„æ–™å¾—åˆ°æŠ¥é”™ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p data-nodeid="1567"><img src="https://s0.lgstatic.com/i/image2/M01/04/EE/Cip5yF_4C9iAVDQkAANk3PGzLdI933.png" alt="Drawing 5.png" data-nodeid="1760"></p>
<p data-nodeid="1568">è¿™ä¸ªé”™è¯¯æˆ‘ä»¬å¹¶ä¸é™Œç”Ÿï¼Œåœ¨ Node.js ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬ä¸èƒ½é€šè¿‡ require æ¥å¼•å…¥ä¸€ä¸ªé€šè¿‡ ESM ç¼–å†™çš„æ¨¡å—åŒ–æ–‡ä»¶ã€‚ä¸Šé¢çš„æ“ä½œä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ Webpack ç¼–è¯‘å‡ºæ¥äº†ç¬¦åˆ UMD è§„èŒƒçš„ä»£ç ï¼Œå°è¯•ä¿®æ”¹<code data-backticks="1" data-nodeid="1762">node.test.js</code>æ–‡ä»¶ä¸ºï¼š</p>
<pre class="lang-java" data-nodeid="1569"><code data-language="java"><span class="hljs-keyword">const</span> AnimalApi = require(<span class="hljs-string">'./lib/index'</span>).<span class="hljs-keyword">default</span>
AnimalApi.getCat().then((animal) =&gt; {
    console.log(animal)
})
</code></pre>
<p data-nodeid="1570">å¦‚ä¸Šä»£ç ï¼Œæˆ‘ä»¬æŒ‰ç…§<code data-backticks="1" data-nodeid="1765">require('./lib/index').default</code>çš„æ–¹å¼å¼•ç”¨ï¼Œå°±å¯ä»¥æ„‰å¿«åœ°åœ¨ Node.js ç¯å¢ƒä¸­è¿è¡Œäº†ã€‚</p>
<p data-nodeid="1571">äº‹å®ä¸Šï¼Œä¾èµ–ä¸Šä¸€æ­¥çš„æ„å»ºäº§å‡ºï¼Œæˆ‘ä»¬åªéœ€è¦æŒ‰ç…§æ­£ç¡®çš„å¼•ç”¨è·¯å¾„ï¼Œå°±å¯ä»¥è½»æ¾åœ°æ”¯æŒ Node.js ç¯å¢ƒäº†ã€‚æ˜¯ä¸æ˜¯æœ‰äº›æææƒšæƒšï¼šâ€œåŸºæœ¬ä»€ä¹ˆéƒ½æ²¡åšï¼Œè¿™å°±æå®šäº†â€ï¼Œä¸‹é¢ï¼Œæˆ‘ä»¬ä»ä»£ç åŸç†ä¸Šé˜è¿°è¯´æ˜ã€‚</p>
<p data-nodeid="1572">ç¬¦åˆ UMD è§„èŒƒçš„ä»£ç ï¼Œå½¢å¦‚ï¼š</p>
<pre class="lang-java" data-nodeid="1573"><code data-language="java">(function (root, factory) {
    <span class="hljs-keyword">if</span> (typeof define === <span class="hljs-string">'function'</span> &amp;&amp; define.amd) {
        <span class="hljs-comment">// AMD. Register as an anonymous module.</span>
        define([<span class="hljs-string">'b'</span>], factory);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (typeof <span class="hljs-keyword">module</span> === <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span>) {
        <span class="hljs-comment">// Node.</span>
        <span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = factory(require(<span class="hljs-string">'b'</span>));
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// Browser globals (root is window)</span>
        root.returnExports = factory(root.b);
    }
}(typeof self !== <span class="hljs-string">'undefined'</span> ? self : <span class="hljs-keyword">this</span>, function (b) {
    <span class="hljs-comment">// Use b in some fashion.</span>
    <span class="hljs-comment">// Just return a value to define the module export.</span>
    <span class="hljs-comment">// This example returns an object, but the module</span>
    <span class="hljs-comment">// can return a function as the exported value.</span>
    <span class="hljs-keyword">return</span> {};
}));
</code></pre>
<p data-nodeid="1574">å¦‚ä¸Šç»“æ„ï¼Œé€šè¿‡ if...else åˆ¤æ–­æ˜¯å¦æ ¹æ®ç¯å¢ƒåŠ è½½ä»£ç ã€‚æˆ‘ä»¬çš„ç¼–è¯‘äº§å‡ºç±»ä¼¼ä¸Šé¢ UMD æ ¼å¼ï¼Œå› æ­¤æ˜¯å¤©ç„¶æ”¯æŒæµè§ˆå™¨å’Œ Node.js ç¯å¢ƒçš„ã€‚</p>
<p data-nodeid="1575">ä½†æ˜¯è¿™æ ·çš„è®¾è®¡å°† Node.js å’Œæµè§ˆå™¨ç¯å¢ƒèåˆåœ¨äº†ä¸€ä¸ª bundle å½“ä¸­ï¼Œå¹¶ä¸ä¼˜é›…ï¼Œä¹Ÿä¸åˆ©äºä½¿ç”¨æ–¹ä¼˜åŒ–ã€‚å¦å¤–ä¸€ä¸ªå¸¸è§çš„åšæ³•æ˜¯<strong data-nodeid="1775">å°†å…¬å…±åº“æŒ‰ç¯å¢ƒåŒºåˆ†ï¼Œåˆ†åˆ«äº§å‡ºä¸¤ä¸ª bundleï¼Œåˆ†åˆ«æ”¯æŒ Node.js å’Œæµè§ˆå™¨ç¯å¢ƒ</strong>ã€‚å¦‚ä¸‹å›¾æ¶æ„ï¼š</p>
<p data-nodeid="1576"><img src="https://s0.lgstatic.com/i/image2/M01/04/F0/CgpVE1_4C-KADRY4AAFZJiKE29s142.png" alt="Drawing 6.png" data-nodeid="1778"></p>
<div data-nodeid="1577"><p style="text-align:center">å…¬å…±åº“æ”¯æŒæµè§ˆå™¨/Node.js ç¯å¢ƒæ–¹å¼ç¤ºæ„å›¾</p></div>
<p data-nodeid="7198" class="te-preview-highlight">å½“ç„¶ï¼Œå¦‚æœç¼–è¯‘å’Œäº§å‡ºä¸ºä¸¤ç§ä¸åŒç¯å¢ƒçš„èµ„æºï¼Œè¿˜å¾—éœ€è¦è®¾ç½® package.json ä¸­çš„ç›¸å…³å­—æ®µã€‚äº‹å®ä¸Šï¼Œ<strong data-nodeid="7217">å¦‚æœä¸€ä¸ª npm éœ€è¦åœ¨ä¸åŒç¯å¢ƒä¸‹åŠ è½½ npm åŒ…ä¸åŒçš„å…¥å£æ–‡ä»¶ï¼Œå°±ä¼šç‰µæ‰¯åˆ°</strong><code data-backticks="1" data-nodeid="7203">main</code><strong data-nodeid="7218">å­—æ®µ</strong>ã€<code data-backticks="1" data-nodeid="7208">module</code><strong data-nodeid="7219">ä»¥åŠ</strong><code data-backticks="1" data-nodeid="7212">browser</code><strong data-nodeid="7220">å­—æ®µ</strong>ã€‚ç®€å•æ¥è¯´ï¼š</p>









<ul data-nodeid="1579">
<li data-nodeid="1580">
<p data-nodeid="1581"><code data-backticks="1" data-nodeid="1798">main</code>å®šä¹‰äº†<code data-backticks="1" data-nodeid="1800">npm</code>åŒ…çš„å…¥å£æ–‡ä»¶ï¼ŒBrowser ç¯å¢ƒå’Œ Node ç¯å¢ƒå‡å¯ä½¿ç”¨ï¼›</p>
</li>
<li data-nodeid="1582">
<p data-nodeid="1583"><code data-backticks="1" data-nodeid="1802">module</code>å®šä¹‰<code data-backticks="1" data-nodeid="1804">npm</code>åŒ…çš„ ESM è§„èŒƒçš„å…¥å£æ–‡ä»¶ï¼ŒBrowser ç¯å¢ƒå’Œ Node ç¯å¢ƒå‡å¯ä½¿ç”¨ï¼›</p>
</li>
<li data-nodeid="1584">
<p data-nodeid="1585"><code data-backticks="1" data-nodeid="1806">browser</code>å®šä¹‰<code data-backticks="1" data-nodeid="1808">npm</code>åŒ…åœ¨ Browser ç¯å¢ƒä¸‹çš„å…¥å£æ–‡ä»¶ã€‚</p>
</li>
</ul>
<p data-nodeid="1586">è€Œè¿™ä¸‰ä¸ªå­—æ®µä¹Ÿéœ€è¦åŒºåˆ†ä¼˜å…ˆçº§ï¼Œæ‰“åŒ…å·¥å…·å¯¹äºä¸åŒç¯å¢ƒé€‚é…ä¸åŒå…¥å£çš„å­—æ®µåœ¨é€‰æ‹©ä¸Šè¿˜æ˜¯è¦ä»¥å®é™…æƒ…å†µä¸ºå‡†ã€‚ç»æˆ‘æµ‹è¯•åï¼Œåœ¨ç›®å‰çŠ¶æ€ï¼Œ<strong data-nodeid="1815">Webpack åœ¨ Web æµè§ˆå™¨ç¯å¢ƒé…ç½®ä¸‹ï¼Œä¼˜å…ˆé€‰æ‹©ï¼šbrowser &gt; module &gt; mainï¼Œåœ¨ Node.js ç¯å¢ƒä¸‹ module &gt; main</strong>ã€‚</p>
<h3 data-nodeid="1587">ä»å¼€æºåº“æ€»ç»“ç”Ÿæ€è®¾è®¡</h3>
<p data-nodeid="1588">æœ€åä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬é’ˆå¯¹ä¸€ä¸ªçœŸæ­£çš„å…¬å…±åº“ï¼Œæ¥æ€»ç»“ä¸€ä¸‹ç¼–è¯‘é€‚é…ä¸åŒç¯å¢ƒçš„â€œå…¬å…±åº“æœ€ä½³å®è·µâ€ã€‚<a href="https://www.npmjs.com/package/@riversun/simple-date-format" data-nodeid="1820">simple-date-format</a> å¯ä»¥å°† Date ç±»å‹è½¬æ¢ä¸ºæ ‡å‡†å®šä¹‰æ ¼å¼çš„å­—ç¬¦ä¸²ç±»å‹ï¼Œå®ƒæ”¯æŒäº†å¤šç§ç¯å¢ƒï¼š</p>
<pre class="lang-java" data-nodeid="1589"><code data-language="java">import SimpleDateFormat from "@riversun/simple-date-format";
const SimpleDateFormat = require('@riversun/simple-date-format');
&lt;script src="https://cdn.jsdelivr.net/npm/@riversun/simple-date-format@1.1.2/lib/simple-date-format.js"&gt;&lt;/script&gt;
</code></pre>
<p data-nodeid="1590">ä½¿ç”¨æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼š</p>
<pre class="lang-java" data-nodeid="1591"><code data-language="java"><span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> Date(<span class="hljs-string">'2018/07/17 12:08:56'</span>);
<span class="hljs-keyword">const</span> sdf = <span class="hljs-keyword">new</span> SimpleDateFormat();
console.log(sdf.formatWith(<span class="hljs-string">"yyyy-MM-dd'T'HH:mm:ssXXX"</span>, date));<span class="hljs-comment">//to be "2018-07-17T12:08:56+09:00"</span>
</code></pre>
<p data-nodeid="1592">æˆ‘ä»¬çœ‹è¿™ä¸ªå…¬å…±åº“çš„ç›¸å…³è®¾è®¡ï¼Œ<a href="https://github.com/riversun/simple-date-format/blob/master/webpack.config.js#L24" data-nodeid="1826">æºç </a>å¦‚ä¸‹ï¼š</p>
<pre class="lang-java" data-nodeid="1593"><code data-language="java"><span class="hljs-comment">// å…¥å£é…ç½®</span>
entry: {
  <span class="hljs-string">'simple-date-format'</span>: [<span class="hljs-string">'./src/simple-date-format.js'</span>],
},
<span class="hljs-comment">// äº§å‡ºé…ç½®</span>
output: {
  path: path.join(__dirname, <span class="hljs-string">'lib'</span>),
  publicPath: <span class="hljs-string">'/'</span>,
  <span class="hljs-comment">// æ ¹æ®ç¯å¢ƒäº§å‡ºä¸åŒçš„æ–‡ä»¶å</span>
  filename: argv.mode === <span class="hljs-string">'production'</span> ? `[name].js` : `[name].js`,  <span class="hljs-comment">//`[name].min.js`</span>
  library: <span class="hljs-string">'SimpleDateFormat'</span>,
  libraryExport: <span class="hljs-string">'default'</span>,
  <span class="hljs-comment">// umd æ¨¡å—åŒ–æ–¹å¼</span>
  libraryTarget: <span class="hljs-string">'umd'</span>,
  globalObject: <span class="hljs-string">'this'</span>,<span class="hljs-comment">//for both browser and node.js</span>
  umdNamedDefine: <span class="hljs-keyword">true</span>,
  <span class="hljs-comment">// åœ¨å’Œ output.library å’Œ output.libraryTarget ä¸€èµ·ä½¿ç”¨æ—¶ï¼ŒauxiliaryComment é€‰é¡¹å…è®¸ç”¨æˆ·å‘å¯¼å‡ºæ–‡ä»¶ä¸­æ’å…¥æ³¨é‡Š</span>
  auxiliaryComment: {
    root: <span class="hljs-string">'for Root'</span>,
    commonjs: <span class="hljs-string">'for CommonJS environment'</span>,
    commonjs2: <span class="hljs-string">'for CommonJS2 environment'</span>,
    amd: <span class="hljs-string">'for AMD environment'</span>
  }
},
</code></pre>
<p data-nodeid="1594">è®¾è®¡æ–¹å¼ä¸å‰æ–‡ç±»ä¼¼ï¼Œå› ä¸ºè¿™ä¸ªåº“çš„ç›®æ ‡å°±æ˜¯ï¼š<strong data-nodeid="1833">ä½œä¸ºä¸€ä¸ªå‡½æ•° helper åº“ï¼ŒåŒæ—¶æ”¯æŒæµè§ˆå™¨å’Œ Node.js ç¯å¢ƒ</strong>ã€‚å®ƒé‡‡å–äº†æ¯”è¾ƒâ€œå·æ‡’â€çš„æ–¹å¼ï¼Œä½¿ç”¨äº† UMD è§„èŒƒæ¥è¾“å‡ºä»£ç ã€‚</p>
<p data-nodeid="1595">æˆ‘ä»¬å†çœ‹å¦ä¸€ä¸ªä¾‹å­ï¼Œåœ¨ <a href="https://github.com/lodash/lodash/blob/master/package.json#L12" data-nodeid="1837">Lodash</a> çš„æ„å»ºè„šæœ¬ä¸­ï¼Œåˆ†ä¸ºäº†ï¼š</p>
<pre class="lang-java" data-nodeid="1596"><code data-language="java"><span class="hljs-string">"build"</span>: <span class="hljs-string">"npm run build:main &amp;&amp; npm run build:fp"</span>,
<span class="hljs-string">"build:fp"</span>: <span class="hljs-string">"node lib/fp/build-dist.js"</span>,
<span class="hljs-string">"build:fp-modules"</span>: <span class="hljs-string">"node lib/fp/build-modules.js"</span>,
<span class="hljs-string">"build:main"</span>: <span class="hljs-string">"node lib/main/build-dist.js"</span>,
<span class="hljs-string">"build:main-modules"</span>: <span class="hljs-string">"node lib/main/build-modules.js"</span>,
</code></pre>
<p data-nodeid="1597">å…¶ä¸­ä¸»å‘½ä»¤ä¸º buildï¼ŒåŒæ—¶æŒ‰ç…§ç¼–è¯‘æ‰€éœ€ï¼Œæä¾›ï¼šES ç‰ˆæœ¬ã€FP ç‰ˆæœ¬ç­‰ï¼ˆbuild:fp/build:fp-modules/build:main/build:main-modulesï¼‰ã€‚å®˜æ–¹ç”šè‡³æä¾›äº† <a href="https://www.npmjs.com/package/lodash-cli" data-nodeid="1842">lodash-cli</a> æ”¯æŒå¼€å‘è€…è‡ªå®šä¹‰æ„å»ºï¼Œæ›´å¤šç›¸å…³å†…å®¹å¯ä»¥å‚è€ƒ <a href="https://lodash.com/custom-builds" data-nodeid="1846">Custom Builds</a>ã€‚</p>
<p data-nodeid="1598">æˆ‘ä»¬åœ¨æ„å»ºç¯èŠ‚â€œé¢‡è´¹ç¬”å¢¨â€ï¼Œç›®çš„æ˜¯è®©ä½ ç†è§£å‰ç«¯ç”Ÿæ€å¤©ç”Ÿâ€œæ··ä¹±â€ï¼Œä¸ç»Ÿä¸€çš„è¿è¡Œç¯å¢ƒä½¿å¾—å…¬å…±åº“çš„æ¶æ„ï¼Œå°¤å…¶æ˜¯ç›¸å…³çš„æ„å»ºè®¾è®¡æ›´åŠ å¤æ‚ã€‚æ›´å¤šæ„å»ºç›¸å…³å†…å®¹ï¼Œæˆ‘ä»¬ä¼šåœ¨åç»­ç« èŠ‚ç»§ç»­è®¨è®ºï¼Œè¿™é‡Œå…ˆåˆ°æ­¤ä¸ºæ­¢ã€‚</p>
<h3 data-nodeid="1599">æ€»ç»“</h3>
<p data-nodeid="1600">è¿™ä¸¤èŠ‚è¯¾æˆ‘ä»¬ä»å…¬å…±åº“çš„è®¾è®¡å’Œä½¿ç”¨æ–¹æ¥å…¥ä¸¤ä¸ªæ–¹é¢è¿›è¡Œäº†æ¢³ç†ã€‚å½“å‰å‰ç«¯ç”Ÿæ€å¤šç§è§„èŒƒå¹¶è¡Œã€å¤šç±»ç¯å¢ƒå…±å­˜ï¼Œå› æ­¤ä½¿å¾—â€œå¯ç”¨æˆ–è®¾è®¡ä¸€ä¸ªå…¬å…±åº“â€å¹¶ä¸ç®€å•ï¼Œå•çº¯çš„ 'npm install' åï¼Œæ‰æ˜¯ä¸€ç³»åˆ—å·¥ç¨‹åŒ–é—®é¢˜çš„å¼€å§‹ã€‚</p>
<p data-nodeid="1601">ä¸æ­¤åŒæ—¶ï¼Œå¼€å‘è€…ç»å¸¸ç–²äºä¸šåŠ¡å¼€å‘ï¼Œå¯¹äºç¼–è¯‘å’Œæ„å»ºï¼Œä»¥åŠå…¬å…±åº“è®¾è®¡å’Œå‰ç«¯ç”Ÿæ€çš„ç†è§£å¾€å¾€å¾—è¿‡ä¸”è¿‡ï¼Œä½†è¿™äº›å†…å®¹æ­£æ˜¯å‰ç«¯åŸºç¡€è®¾æ–½é“è·¯ä¸Šçš„é‡è¦ä¸€ç¯ï¼Œä¹Ÿæ˜¯å¼€å‘è€…é€šå¾€å‰ç«¯æ¶æ„å¸ˆçš„å¿…ç»ä¹‹è·¯ã€‚å»ºè®®ä½ å°†æœ¬èŠ‚çŸ¥è¯†èå…¥è‡ªå·±æ‰‹ä¸Šçš„çœŸå®é¡¹ç›®ä¸­ï¼Œåˆ¨æ ¹é—®åº•ï¼Œç›¸ä¿¡ä½ ä¸€å®šä¼šæœ‰æ›´å¤šæ”¶è·ï¼</p>
<p data-nodeid="1602"><img src="https://s0.lgstatic.com/i/image/M00/8D/16/CgqCHl_4Ch-AQCAEAAVodGYCdmY431.png" alt="Lark20210108-153014.png" data-nodeid="1858"></p>
<p data-nodeid="1603" class="">æœ€åï¼Œå¦‚æœæœ¬èŠ‚å†…å®¹ä½ éš¾ä»¥ä¸€æ­¥åˆ°ä½åœ°ç†è§£æ¶ˆåŒ–ï¼Œè¯·ä¸è¦ç°å¿ƒï¼Œæˆ‘ä»¬ä¼šåœ¨åç»­ç« èŠ‚ä¸­ä¸æ–­å·©å›ºæ¢³ç†ã€‚æˆ‘ä»¬ä¸‹ä¸€è®²å†è§ï¼</p>

---

### ç²¾é€‰è¯„è®º

##### **éªï¼š
> ä½œä¸ºä¸€ä¸ªåº“ä¸åº”è¯¥æŠŠ axios æ‰“åŒ…è¿›å»ï¼Œå› ä¸ºä¸šåŠ¡æ–¹å¾ˆå¯èƒ½ä¹Ÿä¼šä½¿ç”¨ axiosï¼Œè¿™æ ·ä¼šé€ æˆæ‰“åŒ…ä¸¤æ¬¡ã€‚æ­£ç¡®çš„åšæ³•æ˜¯å°† axios åŠ å…¥ peerDependenciesï¼Œç„¶å webpack ä¸­åŠ å…¥ external æ’é™¤æ‰

##### *ä¿Šï¼š
> èµğŸ‘ğŸ»

##### *é‡ï¼š
> ç…§ç€åšäº†ä¸€éï¼Œå¼•å…¥webpackä¹‹åæ‰èƒ½æ­£ç¡®è·‘èµ·æ¥ï¼Œæ˜ç™½äº†å¼•å…¥ç¬¬ä¸‰æ–¹jsæ¨¡å—ï¼Œæ¯”å¦‚axiosçš„æ—¶å€™ä½¿ç”¨webpackå·¥å…·çš„ä½œç”¨

##### **æ£‰ï¼š
> å—ç›ŠåŒªæµ…~æ±‚é—®è€å¸ˆä¸€èˆ¬åœ¨å·¥ä½œä¸Šä¹Ÿå¾ˆéš¾æœ‰æœºä¼šå»æ„å»ºå¤§å‹çš„åŸºç¡€å»ºè®¾é¡¹ç›®ï¼Œè¿™ä¸€éƒ¨åˆ†ç»éªŒçš„ç¼ºå¤±å¹³æ—¶è¯¥å¦‚ä½•å¼¥è¡¥ï¼Œç¡®å®è‡ªå·±æœ¬èº«å†™demoçš„æ—¶å€™ä¹Ÿå¾ˆéš¾ä¼šé‡åˆ°é‚£ä¹ˆå¤šé—®é¢˜~å¹³æ—¶åº”è¯¥å¦‚ä½•é”»ç‚¼å‘¢

 ###### &nbsp;&nbsp;&nbsp; è®²å¸ˆå›å¤ï¼š
> &nbsp;&nbsp;&nbsp; å¯ä»¥å†çœ‹çœ‹å¼€ç¯‡è¯å§ï¼Œæˆ‘åœ¨å¼€ç¯‡è¯é‡Œæœ‰è¯´è¿‡è¿™ä¸ªé—®é¢˜~

##### **4550ï¼š
> è€å¸ˆï¼Œè¿™å¥è¯æ€ä¹ˆç†è§£ï¼šâ€œä¸ºäº†å…¼å®¹ ESM ç‰¹æ€§ï¼Œå¯¼å‡ºå†…å®¹å…¨éƒ¨æŒ‚åœ¨äº† default å±æ€§â€

 ###### &nbsp;&nbsp;&nbsp; è®²å¸ˆå›å¤ï¼š
> &nbsp;&nbsp;&nbsp; è¿™æ˜¯å› ä¸º ESM å’Œ CommonJS çš„è§„èŒƒï¼Œå…³äº default è®¾è®¡çš„ä¸åŒ

