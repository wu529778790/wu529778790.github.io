(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{386:function(t,v,_){"use strict";_.r(v);var a=_(4),s=Object(a.a)({},(function(){var t=this,v=t._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h2",{attrs:{id:"简述-https-加密过程"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#简述-https-加密过程"}},[t._v("#")]),t._v(" 简述 HTTPS 加密过程")]),t._v(" "),v("p",[v("img",{attrs:{src:"https://gcore.jsdelivr.net/gh/wu529778790/img.shenzjd.com/blog/20251208194017.png",alt:"20251208194017"}})]),t._v(" "),v("p",[t._v("HTTPS 使用 TLS/SSL 协议进行加密，主要包含以下步骤：")]),t._v(" "),v("h3",{attrs:{id:"_1-客户端发起请求"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-客户端发起请求"}},[t._v("#")]),t._v(" 1.客户端发起请求")]),t._v(" "),v("ul",[v("li",[t._v("发送支持的加密算法列表")]),t._v(" "),v("li",[t._v("发送随机数 Client Random")])]),t._v(" "),v("h3",{attrs:{id:"_2-服务器回应"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-服务器回应"}},[t._v("#")]),t._v(" 2.服务器回应")]),t._v(" "),v("ul",[v("li",[t._v("选择加密算法")]),t._v(" "),v("li",[t._v("发送数字证书（包含公钥）")]),t._v(" "),v("li",[t._v("发送随机数 Server Random")])]),t._v(" "),v("h3",{attrs:{id:"_3-客户端验证证书"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-客户端验证证书"}},[t._v("#")]),t._v(" 3.客户端验证证书")]),t._v(" "),v("ul",[v("li",[t._v("验证证书是否由可信 CA 签发")]),t._v(" "),v("li",[t._v("验证证书域名是否匹配")]),t._v(" "),v("li",[t._v("验证证书是否在有效期内")])]),t._v(" "),v("h3",{attrs:{id:"_4-生成会话密钥"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_4-生成会话密钥"}},[t._v("#")]),t._v(" 4.生成会话密钥")]),t._v(" "),v("ul",[v("li",[t._v("客户端生成随机数 Pre-master secret")]),t._v(" "),v("li",[t._v("使用服务器公钥加密 Pre-master secret")]),t._v(" "),v("li",[t._v("客户端和服务器都通过三个随机数生成会话密钥 (Client Random + Server Random + Pre-master secret)")])]),t._v(" "),v("h3",{attrs:{id:"_5-开始加密通信"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_5-开始加密通信"}},[t._v("#")]),t._v(" 5.开始加密通信")]),t._v(" "),v("ul",[v("li",[t._v("双方使用会话密钥进行对称加密通信")]),t._v(" "),v("li",[t._v("保证通信内容的机密性和完整性")])]),t._v(" "),v("p",[t._v("特点：")]),t._v(" "),v("ul",[v("li",[t._v("采用混合加密：非对称加密传输密钥，对称加密传输数据")]),t._v(" "),v("li",[t._v("数字证书保证服务器身份可信")]),t._v(" "),v("li",[t._v("具有防篡改和不可否认性")])]),t._v(" "),v("p",[t._v("扩展："),v("a",{attrs:{href:"https://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("图解SSL/TLS协议"),v("OutboundLink")],1)]),t._v(" "),v("h2",{attrs:{id:"tcp-是如何建立连接的-三次握手-四次挥手"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#tcp-是如何建立连接的-三次握手-四次挥手"}},[t._v("#")]),t._v(" TCP 是如何建立连接的，三次握手，四次挥手")]),t._v(" "),v("p",[v("img",{attrs:{src:"https://gcore.jsdelivr.net/gh/wu529778790/img.shenzjd.com/blog/20251208194623.png",alt:"20251208194623"}})]),t._v(" "),v("p",[t._v("三次握手")]),t._v(" "),v("ul",[v("li",[t._v("客户端向服务端发送建立连接请求，客户端进入 SYN-SEND 状态")]),t._v(" "),v("li",[t._v("服务端收到建立连接请求后，向客户端发送一个应答，服务端进入 SYN-RECEIVED 状态")]),t._v(" "),v("li",[t._v("客户端接收到应答后，向服务端发送确认接收到应答，客户端进入 ESTABLISHED 状态")])]),t._v(" "),v("p",[v("img",{attrs:{src:"https://gcore.jsdelivr.net/gh/wu529778790/img.shenzjd.com/blog/20251208194638.png",alt:"20251208194638"}})]),t._v(" "),v("p",[t._v("四次挥手")]),t._v(" "),v("ul",[v("li",[t._v("客户端向服务端发送断开连接请求")]),t._v(" "),v("li",[t._v("服务端收到断开连接请求后，告诉应用层去释放 tcp 连接")]),t._v(" "),v("li",[t._v("服务端向客户端发送最后一个数据包 FINBIT ，服务端进入 LAST-ACK 状态")]),t._v(" "),v("li",[t._v("客户端收到服务端的断开连接请求后，向服务端确认应答")])]),t._v(" "),v("blockquote",[v("p",[t._v("三次握手四次挥手，客户端都是主动方，服务端都是被动方。在状态方面：三次握手的客户端和服务端都是由原来的 closed 变为 established，四次挥手的客户端和服务端都是由原来的 established 变为 closed。")])]),t._v(" "),v("h2",{attrs:{id:"http-几个版本的区别"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#http-几个版本的区别"}},[t._v("#")]),t._v(" HTTP 几个版本的区别")]),t._v(" "),v("h3",{attrs:{id:"http-0-9"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#http-0-9"}},[t._v("#")]),t._v(" HTTP/0.9")]),t._v(" "),v("ul",[v("li",[t._v("仅支持 GET 请求，无请求头和请求体")]),t._v(" "),v("li",[t._v("只能传输 HTML 文件，返回 ASCII 字符流")]),t._v(" "),v("li",[t._v("无响应头")])]),t._v(" "),v("blockquote",[v("p",[t._v("缺点：功能极其有限")])]),t._v(" "),v("h3",{attrs:{id:"http-1-0-多类型支持"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#http-1-0-多类型支持"}},[t._v("#")]),t._v(" HTTP/1.0 多类型支持")]),t._v(" "),v("ul",[v("li",[t._v("支持多种文件类型（不限于 ASCII）")]),t._v(" "),v("li",[t._v("引入请求头和响应头（key-value 形式）")]),t._v(" "),v("li",[t._v("每个请求都需要建立新的 TCP 连接")])]),t._v(" "),v("blockquote",[v("p",[t._v("缺点：频繁连接导致性能开销")])]),t._v(" "),v("h3",{attrs:{id:"http-1-1-持久连接"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#http-1-1-持久连接"}},[t._v("#")]),t._v(" HTTP/1.1 持久连接")]),t._v(" "),v("ul",[v("li",[t._v("引入持久连接(keep-alive): 一个 TCP 连接可传输多个 HTTP 请求")]),t._v(" "),v("li",[t._v("默认开启 keep-alive，通常限制 6-8 个并发连接")]),t._v(" "),v("li",[t._v("引入 Host 字段，支持虚拟主机")]),t._v(" "),v("li",[t._v("引入 Chunk transfer 机制处理动态内容长度")])]),t._v(" "),v("blockquote",[v("p",[t._v("缺点：存在队头阻塞问题（前面的请求阻塞后续请求）")])]),t._v(" "),v("h3",{attrs:{id:"http-2-0-多路复用"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#http-2-0-多路复用"}},[t._v("#")]),t._v(" HTTP/2.0 多路复用")]),t._v(" "),v("ul",[v("li",[t._v("一个域名仅使用一个 TCP 长连接")]),t._v(" "),v("li",[t._v("引入二进制分帧层，实现多路复用（并行传输请求）")]),t._v(" "),v("li",[t._v("支持请求优先级")]),t._v(" "),v("li",[t._v("强制使用 HTTPS（HTTP + TLS 加密）")])]),t._v(" "),v("blockquote",[v("p",[t._v("仍依赖 TCP，存在 TCP 队头阻塞问题")])]),t._v(" "),v("h3",{attrs:{id:"http-3-0-quic-协议"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#http-3-0-quic-协议"}},[t._v("#")]),t._v(" HTTP/3.0 QUIC 协议")]),t._v(" "),v("ul",[v("li",[t._v("基于 UDP 协议而非 TCP")]),t._v(" "),v("li",[t._v("实现了类似 TCP 的流量控制和可靠传输")]),t._v(" "),v("li",[t._v("继承 TLS 加密")]),t._v(" "),v("li",[t._v("多路费用")]),t._v(" "),v("li",[t._v("解决 TCP 对头阻塞问题")])]),t._v(" "),v("h2",{attrs:{id:"http-常见的状态码"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#http-常见的状态码"}},[t._v("#")]),t._v(" HTTP 常见的状态码")]),t._v(" "),v("h3",{attrs:{id:"_1-2xx-成功状态码"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-2xx-成功状态码"}},[t._v("#")]),t._v(" "),v("strong",[t._v("1. 2xx 成功状态码")])]),t._v(" "),v("h4",{attrs:{id:"重点解析"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#重点解析"}},[t._v("#")]),t._v(" "),v("strong",[t._v("重点解析")])]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("200 OK")]),t._v("：最基础的成功状态码，表示请求完全成功。")]),t._v(" "),v("li",[v("strong",[t._v("204 No Content")]),t._v("：成功但无返回数据，适用于不需要返回内容的操作（如 "),v("code",[t._v("DELETE")]),t._v("）。")]),t._v(" "),v("li",[v("strong",[t._v("205 Reset Content")]),t._v("：要求客户端重置当前视图（如提交表单后清空输入框）。")]),t._v(" "),v("li",[v("strong",[t._v("206 Partial Content")]),t._v("：支持分块传输（如视频流、大文件下载）。")])]),t._v(" "),v("h4",{attrs:{id:"实际场景"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#实际场景"}},[t._v("#")]),t._v(" "),v("strong",[t._v("实际场景")])]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("204")]),t._v("：删除资源后，服务器只需确认成功，无需返回数据。")]),t._v(" "),v("li",[v("strong",[t._v("206")]),t._v("：浏览器下载大文件时，通过 "),v("code",[t._v("Range")]),t._v(" 头实现断点续传，服务器返回 "),v("code",[t._v("206")]),t._v(" 和部分内容。")])]),t._v(" "),v("hr"),t._v(" "),v("h3",{attrs:{id:"_2-3xx-重定向状态码"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-3xx-重定向状态码"}},[t._v("#")]),t._v(" "),v("strong",[t._v("2. 3xx 重定向状态码")])]),t._v(" "),v("h4",{attrs:{id:"重点解析-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#重点解析-2"}},[t._v("#")]),t._v(" "),v("strong",[t._v("重点解析")])]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("301 vs 302")]),t._v("：\n"),v("ul",[v("li",[v("strong",[t._v("301")]),t._v("：永久重定向，搜索引擎会更新链接到新地址。")]),t._v(" "),v("li",[v("strong",[t._v("302")]),t._v("：临时重定向，搜索引擎仍保留原地址。")])])]),t._v(" "),v("li",[v("strong",[t._v("303")]),t._v("：强制客户端用 "),v("code",[t._v("GET")]),t._v(" 方法访问新地址（避免 "),v("code",[t._v("POST")]),t._v(" 重复提交）。")]),t._v(" "),v("li",[v("strong",[t._v("304")]),t._v("：协商缓存，通过 "),v("code",[t._v("ETag")]),t._v(" 或 "),v("code",[t._v("Last-Modified")]),t._v(" 判断资源是否修改。")])]),t._v(" "),v("h4",{attrs:{id:"实际场景-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#实际场景-2"}},[t._v("#")]),t._v(" "),v("strong",[t._v("实际场景")])]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("301")]),t._v("：网站域名更换，旧域名永久跳转到新域名。")]),t._v(" "),v("li",[v("strong",[t._v("302")]),t._v("：用户未登录时临时跳转到登录页。")]),t._v(" "),v("li",[v("strong",[t._v("304")]),t._v("：浏览器缓存未过期，直接使用本地资源，减少服务器压力。")])]),t._v(" "),v("hr"),t._v(" "),v("h3",{attrs:{id:"_3-4xx-客户端错误状态码"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-4xx-客户端错误状态码"}},[t._v("#")]),t._v(" "),v("strong",[t._v("3. 4xx 客户端错误状态码")])]),t._v(" "),v("h4",{attrs:{id:"重点解析-3"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#重点解析-3"}},[t._v("#")]),t._v(" "),v("strong",[t._v("重点解析")])]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("400")]),t._v("：请求语法错误（如 JSON 格式错误）。")]),t._v(" "),v("li",[v("strong",[t._v("401 vs 403")]),t._v("：\n"),v("ul",[v("li",[v("strong",[t._v("401")]),t._v("：未认证（如未登录或 "),v("code",[t._v("token")]),t._v(" 失效）。")]),t._v(" "),v("li",[v("strong",[t._v("403")]),t._v("：已认证但无权限（如普通用户访问管理员接口）。")])])]),t._v(" "),v("li",[v("strong",[t._v("404")]),t._v("：资源不存在（可能是 URL 拼写错误）。")])]),t._v(" "),v("h4",{attrs:{id:"实际场景-3"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#实际场景-3"}},[t._v("#")]),t._v(" "),v("strong",[t._v("实际场景")])]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("401")]),t._v("：前端未携带 "),v("code",[t._v("token")]),t._v(" 访问需要认证的接口。")]),t._v(" "),v("li",[v("strong",[t._v("403")]),t._v("：用户尝试删除他人数据时被拒绝。")]),t._v(" "),v("li",[v("strong",[t._v("404")]),t._v("：输入错误的 API 路径。")])]),t._v(" "),v("hr"),t._v(" "),v("h3",{attrs:{id:"_4-5xx-服务端错误状态码"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_4-5xx-服务端错误状态码"}},[t._v("#")]),t._v(" "),v("strong",[t._v("4. 5xx 服务端错误状态码")])]),t._v(" "),v("h4",{attrs:{id:"重点解析-4"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#重点解析-4"}},[t._v("#")]),t._v(" "),v("strong",[t._v("重点解析")])]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("500")]),t._v("：服务器内部错误（如代码抛出未捕获的异常）。")]),t._v(" "),v("li",[v("strong",[t._v("501")]),t._v("：服务器不支持请求的功能（如调用了未实现的 API）。")]),t._v(" "),v("li",[v("strong",[t._v("503")]),t._v("：服务不可用（如服务器过载或维护）。")])]),t._v(" "),v("h4",{attrs:{id:"实际场景-4"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#实际场景-4"}},[t._v("#")]),t._v(" "),v("strong",[t._v("实际场景")])]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("500")]),t._v("：数据库连接失败导致服务崩溃。")]),t._v(" "),v("li",[v("strong",[t._v("503")]),t._v("：电商大促时服务器流量激增，暂时限流。")])]),t._v(" "),v("hr"),t._v(" "),v("h3",{attrs:{id:"面试加分点"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#面试加分点"}},[t._v("#")]),t._v(" "),v("strong",[t._v("面试加分点")])]),t._v(" "),v("ol",[v("li",[v("p",[v("strong",[t._v("缓存机制")]),t._v("：")]),t._v(" "),v("ul",[v("li",[t._v("提到 "),v("code",[t._v("304")]),t._v(" 时，可以展开说：\n"),v("ul",[v("li",[t._v("浏览器通过 "),v("code",[t._v("If-Modified-Since")]),t._v("（基于时间）或 "),v("code",[t._v("If-None-Match")]),t._v("（基于 "),v("code",[t._v("ETag")]),t._v("）发起条件请求。")]),t._v(" "),v("li",[t._v("服务器比对后决定返回 "),v("code",[t._v("304")]),t._v(" 或 "),v("code",[t._v("200")]),t._v("。")])])])])]),t._v(" "),v("li",[v("p",[v("strong",[t._v("安全设计")]),t._v("：")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("403")]),t._v(" 可以结合敏感词过滤或权限系统设计。")]),t._v(" "),v("li",[v("strong",[t._v("401")]),t._v(" 需提到 "),v("code",[t._v("JWT")]),t._v(" 或 "),v("code",[t._v("OAuth")]),t._v(" 认证流程。")])])]),t._v(" "),v("li",[v("p",[v("strong",[t._v("性能优化")]),t._v("：")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("206")]),t._v(" 用于优化大文件传输。")]),t._v(" "),v("li",[v("strong",[t._v("301")]),t._v(" 减少重复跳转的开销。")])])]),t._v(" "),v("li",[v("p",[v("strong",[t._v("高可用")]),t._v("：")]),t._v(" "),v("ul",[v("li",[t._v("如何避免 "),v("code",[t._v("503")]),t._v("？\n"),v("ul",[v("li",[t._v("答案：负载均衡、服务降级、限流策略（如令牌桶）。")])])])])])]),t._v(" "),v("hr"),t._v(" "),v("h3",{attrs:{id:"模拟面试问题"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#模拟面试问题"}},[t._v("#")]),t._v(" "),v("strong",[t._v("模拟面试问题")])]),t._v(" "),v("ol",[v("li",[v("p",[v("strong",[t._v("问题")]),t._v("：用户登录后访问某个接口返回 "),v("code",[t._v("403")]),t._v("，可能是什么原因？"),v("br"),t._v(" "),v("strong",[t._v("回答")]),t._v("：可能是权限不足（如普通用户访问管理员接口），或请求被风控系统拦截（如敏感操作）。")])]),t._v(" "),v("li",[v("p",[v("strong",[t._v("问题")]),t._v("：如何实现文件的断点续传？"),v("br"),t._v(" "),v("strong",[t._v("回答")]),t._v("：客户端通过 "),v("code",[t._v("Range")]),t._v(" 头指定下载范围，服务器返回 "),v("code",[t._v("206")]),t._v(" 和部分内容，并支持 "),v("code",[t._v("ETag")]),t._v(" 校验文件一致性。")])]),t._v(" "),v("li",[v("p",[v("strong",[t._v("问题")]),t._v("："),v("code",[t._v("304")]),t._v(" 是如何减少带宽消耗的？"),v("br"),t._v(" "),v("strong",[t._v("回答")]),t._v("：浏览器缓存资源后，下次请求携带 "),v("code",[t._v("If-None-Match")]),t._v("（"),v("code",[t._v("ETag")]),t._v("），若资源未修改，服务器返回 "),v("code",[t._v("304")]),t._v("，浏览器直接使用缓存。")])])]),t._v(" "),v("h2",{attrs:{id:"http-常见-header"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#http-常见-header"}},[t._v("#")]),t._v(" HTTP 常见 Header")]),t._v(" "),v("h3",{attrs:{id:"请求头"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#请求头"}},[t._v("#")]),t._v(" 请求头")]),t._v(" "),v("ul",[v("li",[t._v("accept: text/html 告诉服务端我期望接收到一个html的文件")]),t._v(" "),v("li",[t._v("accept-encoding: gzip, deflate, br 告诉服务端以这种方式压缩")]),t._v(" "),v("li",[t._v("accept-language: zh-CN 告诉服务端以中文的格式返回")]),t._v(" "),v("li",[t._v("authorization: 告诉服务端授权信息")]),t._v(" "),v("li",[t._v("cookie: 告诉服务端客户端存储的 cookie")]),t._v(" "),v("li",[t._v("origin: 告诉服务端请求的来源")])]),t._v(" "),v("h3",{attrs:{id:"响应头"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#响应头"}},[t._v("#")]),t._v(" 响应头")]),t._v(" "),v("ul",[v("li",[t._v("content-encoding: br 告诉浏览器压缩方式是br")]),t._v(" "),v("li",[t._v("content-type: text/html; charset=utf-8 告诉浏览器以这种方式，编码加载")]),t._v(" "),v("li",[t._v("cache-control: 告诉浏览器缓存策略")]),t._v(" "),v("li",[t._v("expires: 告诉浏览器缓存过期时间")]),t._v(" "),v("li",[t._v("set-cookie: 告诉浏览器设置 cookie")]),t._v(" "),v("li",[t._v("access-control-allow-origin: * 告诉浏览器允许跨域")])]),t._v(" "),v("h2",{attrs:{id:"url-包含哪些部分"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#url-包含哪些部分"}},[t._v("#")]),t._v(" URL 包含哪些部分")]),t._v(" "),v("ul",[v("li",[t._v("协议")]),t._v(" "),v("li",[t._v("域名")]),t._v(" "),v("li",[t._v("端口号")]),t._v(" "),v("li",[t._v("路径")]),t._v(" "),v("li",[t._v("查询参数")]),t._v(" "),v("li",[t._v("锚点")])]),t._v(" "),v("h2",{attrs:{id:"ajax-fetch-axios-三者有什么区别"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#ajax-fetch-axios-三者有什么区别"}},[t._v("#")]),t._v(" Ajax Fetch Axios 三者有什么区别")]),t._v(" "),v("p",[t._v("Ajax、Fetch 和 Axios 都是用于发送 HTTP 请求的技术，但有以下区别：")]),t._v(" "),v("h3",{attrs:{id:"ajax-asynchronous-javascript-and-xml"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#ajax-asynchronous-javascript-and-xml"}},[t._v("#")]),t._v(" Ajax (Asynchronous JavaScript and XML)")]),t._v(" "),v("ul",[v("li",[t._v("是一种技术统称，不是具体的 API")]),t._v(" "),v("li",[t._v("最常用的实现是 XMLHttpRequest (XHR)")]),t._v(" "),v("li",[t._v("写法比较繁琐，需要手动处理各种状态")]),t._v(" "),v("li",[t._v("回调地狱问题")]),t._v(" "),v("li",[t._v("不支持 Promise")])]),t._v(" "),v("h3",{attrs:{id:"fetch"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#fetch"}},[t._v("#")]),t._v(" Fetch")]),t._v(" "),v("ul",[v("li",[t._v("浏览器原生 API")]),t._v(" "),v("li",[t._v("基于 Promise")]),t._v(" "),v("li",[t._v("更简洁的写法")]),t._v(" "),v("li",[t._v("不需要额外引入")]),t._v(" "),v("li",[t._v("只对网络请求报错，对 400、500 都当做成功的请求")]),t._v(" "),v("li",[t._v("默认不带 cookie")]),t._v(" "),v("li",[t._v("不支持请求超时控制")]),t._v(" "),v("li",[t._v("不支持请求取消")]),t._v(" "),v("li",[t._v("不支持请求进度监控")])]),t._v(" "),v("h3",{attrs:{id:"axios"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#axios"}},[t._v("#")]),t._v(" Axios")]),t._v(" "),v("ul",[v("li",[t._v("第三方库，需要额外引入")]),t._v(" "),v("li",[t._v("基于 Promise")]),t._v(" "),v("li",[t._v("支持浏览器和 Node.js")]),t._v(" "),v("li",[t._v("请求/响应拦截器")]),t._v(" "),v("li",[t._v("自动转换 JSON 数据")]),t._v(" "),v("li",[t._v("客户端支持防止 XSRF")]),t._v(" "),v("li",[t._v("支持请求取消")]),t._v(" "),v("li",[t._v("支持请求超时控制")]),t._v(" "),v("li",[t._v("支持请求进度监控")]),t._v(" "),v("li",[t._v("支持并发请求")]),t._v(" "),v("li",[t._v("自动转换请求和响应数据")])]),t._v(" "),v("h2",{attrs:{id:"fetch-和-xmlhttprequest-有什么区别"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#fetch-和-xmlhttprequest-有什么区别"}},[t._v("#")]),t._v(" Fetch 和 XMLHTTPRequest 有什么区别")]),t._v(" "),v("p",[t._v("Fetch 和 XMLHTTPRequest 都是浏览器提供的 API，用于发送 HTTP 请求，但有以下区别：")]),t._v(" "),v("h3",{attrs:{id:"语法和使用"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#语法和使用"}},[t._v("#")]),t._v(" 语法和使用")]),t._v(" "),v("ul",[v("li",[t._v("Fetch 基于 Promise，代码更简洁优雅")]),t._v(" "),v("li",[t._v("XHR 使用回调函数，容易产生回调地狱")]),t._v(" "),v("li",[t._v("Fetch 的 API 设计更简单现代")]),t._v(" "),v("li",[t._v("XHR 的 API 设计较老，使用相对复杂")])]),t._v(" "),v("h3",{attrs:{id:"功能特性"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#功能特性"}},[t._v("#")]),t._v(" 功能特性")]),t._v(" "),v("ul",[v("li",[t._v("Fetch 默认不发送 cookies，需要配置 credentials")]),t._v(" "),v("li",[t._v("XHR 默认发送 cookies")]),t._v(" "),v("li",[t._v("Fetch 不能监听上传进度")]),t._v(" "),v("li",[t._v("XHR 可以监听上传和下载进度")]),t._v(" "),v("li",[t._v("Fetch 不能直接取消请求（需要 AbortController）")]),t._v(" "),v("li",[t._v("XHR 可以通过 abort() 直接取消请求")])]),t._v(" "),v("h3",{attrs:{id:"错误处理"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#错误处理"}},[t._v("#")]),t._v(" 错误处理")]),t._v(" "),v("ul",[v("li",[t._v("Fetch 只有网络错误才会 reject，HTTP 错误码不会导致 reject")]),t._v(" "),v("li",[t._v("XHR 可以处理所有类型的错误，包括 HTTP 错误码")])]),t._v(" "),v("h3",{attrs:{id:"浏览器支持"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#浏览器支持"}},[t._v("#")]),t._v(" 浏览器支持")]),t._v(" "),v("ul",[v("li",[t._v("Fetch 是现代浏览器标准 API")]),t._v(" "),v("li",[t._v("XHR 有更好的浏览器兼容性，包括旧版本")])]),t._v(" "),v("h2",{attrs:{id:"什么是-restful-api"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#什么是-restful-api"}},[t._v("#")]),t._v(" 什么是 Restful API")]),t._v(" "),v("p",[t._v("RESTful API 是一种软件架构风格，用于设计网络应用程序的接口。主要特点：")]),t._v(" "),v("h3",{attrs:{id:"资源导向"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#资源导向"}},[t._v("#")]),t._v(" 资源导向")]),t._v(" "),v("ul",[v("li",[t._v("使用 URL 定位资源")]),t._v(" "),v("li",[t._v("每个资源都有唯一的 URL")]),t._v(" "),v("li",[t._v("资源可以有多种表现形式（如 JSON、XML）")])]),t._v(" "),v("h3",{attrs:{id:"http-方法对应操作"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#http-方法对应操作"}},[t._v("#")]),t._v(" HTTP 方法对应操作")]),t._v(" "),v("ul",[v("li",[t._v("GET：获取资源")]),t._v(" "),v("li",[t._v("POST：创建资源")]),t._v(" "),v("li",[t._v("PUT：更新资源（完整更新）")]),t._v(" "),v("li",[t._v("PATCH：更新资源（部分更新）")]),t._v(" "),v("li",[t._v("DELETE：删除资源")])]),t._v(" "),v("h3",{attrs:{id:"无状态"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#无状态"}},[t._v("#")]),t._v(" 无状态")]),t._v(" "),v("ul",[v("li",[t._v("服务器不保存客户端状态")]),t._v(" "),v("li",[t._v("每个请求包含所需的所有信息")]),t._v(" "),v("li",[t._v("有利于横向扩展")])]),t._v(" "),v("h3",{attrs:{id:"统一接口"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#统一接口"}},[t._v("#")]),t._v(" 统一接口")]),t._v(" "),v("ul",[v("li",[t._v("使用标准的 HTTP 方法")]),t._v(" "),v("li",[t._v("使用标准的 HTTP 状态码")]),t._v(" "),v("li",[t._v("返回格式一致（通常是 JSON）")])]),t._v(" "),v("h2",{attrs:{id:"什么是-graphql"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#什么是-graphql"}},[t._v("#")]),t._v(" 什么是 GraphQL")]),t._v(" "),v("p",[t._v("GraphQL 是一种用于 API 的查询语言和运行时，由 Facebook 开发。主要特点：")]),t._v(" "),v("h3",{attrs:{id:"查询灵活性"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#查询灵活性"}},[t._v("#")]),t._v(" 查询灵活性")]),t._v(" "),v("ul",[v("li",[t._v("客户端可以精确指定需要哪些数据")]),t._v(" "),v("li",[t._v("可以在一个请求中获取多个资源")]),t._v(" "),v("li",[t._v("避免了传统 REST API 的过度获取和获取不足问题")])]),t._v(" "),v("h3",{attrs:{id:"类型系统"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#类型系统"}},[t._v("#")]),t._v(" 类型系统")]),t._v(" "),v("ul",[v("li",[t._v("强类型的 Schema 定义")]),t._v(" "),v("li",[t._v("自动生成文档")]),t._v(" "),v("li",[t._v("开发时有更好的类型提示")])]),t._v(" "),v("h3",{attrs:{id:"单个端点"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#单个端点"}},[t._v("#")]),t._v(" 单个端点")]),t._v(" "),v("ul",[v("li",[t._v("只需要一个 API 端点")]),t._v(" "),v("li",[t._v("所有查询都发送到同一个地址")]),t._v(" "),v("li",[t._v("通过查询语句区分不同的操作")])]),t._v(" "),v("h3",{attrs:{id:"主要操作类型"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#主要操作类型"}},[t._v("#")]),t._v(" 主要操作类型")]),t._v(" "),v("ul",[v("li",[t._v("Query：获取数据")]),t._v(" "),v("li",[t._v("Mutation：修改数据")]),t._v(" "),v("li",[t._v("Subscription：实时数据订阅")])]),t._v(" "),v("h3",{attrs:{id:"优点"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#优点"}},[t._v("#")]),t._v(" 优点")]),t._v(" "),v("ul",[v("li",[t._v("减少网络请求")]),t._v(" "),v("li",[t._v("避免版本化问题")]),t._v(" "),v("li",[t._v("强类型保障")]),t._v(" "),v("li",[t._v("更好的开发体验")])]),t._v(" "),v("h3",{attrs:{id:"缺点"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#缺点"}},[t._v("#")]),t._v(" 缺点")]),t._v(" "),v("ul",[v("li",[t._v("学习成本较高")]),t._v(" "),v("li",[t._v("缓存较为复杂")]),t._v(" "),v("li",[t._v("服务端实现复杂度增加")])]),t._v(" "),v("h2",{attrs:{id:"如何理解-cookie"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#如何理解-cookie"}},[t._v("#")]),t._v(" 如何理解 cookie")]),t._v(" "),v("p",[t._v("Cookie 是服务器发送到用户浏览器并保存在本地的一小块数据。")]),t._v(" "),v("h3",{attrs:{id:"主要特点"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#主要特点"}},[t._v("#")]),t._v(" 主要特点")]),t._v(" "),v("ul",[v("li",[t._v("由服务器生成，浏览器进行存储")]),t._v(" "),v("li",[t._v("每次请求时会自动携带对应域名下的 cookie")]),t._v(" "),v("li",[t._v("可设置过期时间")]),t._v(" "),v("li",[t._v("默认情况下随着浏览器关闭而删除（会话 cookie）")])]),t._v(" "),v("h3",{attrs:{id:"常用属性"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#常用属性"}},[t._v("#")]),t._v(" 常用属性")]),t._v(" "),v("ul",[v("li",[t._v("name：cookie 名称")]),t._v(" "),v("li",[t._v("value：cookie 值")]),t._v(" "),v("li",[t._v("domain：指定 cookie 所属域名")]),t._v(" "),v("li",[t._v("path：指定 cookie 所属路径")]),t._v(" "),v("li",[t._v("expires/max-age：过期时间")]),t._v(" "),v("li",[t._v("secure：只在 HTTPS 下传输")]),t._v(" "),v("li",[t._v("httpOnly：禁止 JS 访问")]),t._v(" "),v("li",[t._v("sameSite：跨站点请求限制")])]),t._v(" "),v("h3",{attrs:{id:"使用场景"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#使用场景"}},[t._v("#")]),t._v(" 使用场景")]),t._v(" "),v("ul",[v("li",[t._v("会话状态管理（用户登录状态、购物车等）")]),t._v(" "),v("li",[t._v("个性化设置（用户偏好、主题等）")]),t._v(" "),v("li",[t._v("浏览器行为跟踪（分析用户行为等）")])]),t._v(" "),v("h3",{attrs:{id:"限制"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#限制"}},[t._v("#")]),t._v(" 限制")]),t._v(" "),v("ul",[v("li",[t._v("大小限制：通常为 4KB")]),t._v(" "),v("li",[t._v("数量限制：每个域名下的 cookie 数量有限")]),t._v(" "),v("li",[t._v("安全性：明文传输（除非使用 HTTPS）")]),t._v(" "),v("li",[t._v("作用域：只能在所属域名下使用")])]),t._v(" "),v("h2",{attrs:{id:"为何现代浏览器都禁用第三方-cookie"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#为何现代浏览器都禁用第三方-cookie"}},[t._v("#")]),t._v(" 为何现代浏览器都禁用第三方 cookie")]),t._v(" "),v("p",[t._v("主要原因是保护用户隐私和安全：")]),t._v(" "),v("h3",{attrs:{id:"隐私问题"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#隐私问题"}},[t._v("#")]),t._v(" 隐私问题")]),t._v(" "),v("ul",[v("li",[t._v("第三方 Cookie 可以跨站点追踪用户行为")]),t._v(" "),v("li",[t._v("广告商可以构建用户画像和浏览历史")]),t._v(" "),v("li",[t._v("用户数据可能被未经授权收集和使用")])]),t._v(" "),v("h3",{attrs:{id:"安全风险"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#安全风险"}},[t._v("#")]),t._v(" 安全风险")]),t._v(" "),v("ul",[v("li",[t._v("增加 CSRF（跨站请求伪造）攻击风险")]),t._v(" "),v("li",[t._v("可能被用于会话劫持")]),t._v(" "),v("li",[t._v("恶意网站可能滥用第三方 Cookie")])]),t._v(" "),v("h3",{attrs:{id:"技术影响"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#技术影响"}},[t._v("#")]),t._v(" 技术影响")]),t._v(" "),v("ul",[v("li",[t._v("Safari 和 Firefox 已默认禁用第三方 Cookie")]),t._v(" "),v("li",[t._v("Chrome 计划在 2024 年完全禁用第三方 Cookie")]),t._v(" "),v("li",[t._v("替代方案：\n"),v("ul",[v("li",[t._v("First-Party Cookie")]),t._v(" "),v("li",[t._v("localStorage")]),t._v(" "),v("li",[t._v("Privacy Sandbox")]),t._v(" "),v("li",[t._v("FLoC (Federated Learning of Cohorts)")])])])]),t._v(" "),v("h2",{attrs:{id:"如何理解-session"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#如何理解-session"}},[t._v("#")]),t._v(" 如何理解 Session")]),t._v(" "),v("p",[t._v("Session 是服务器端的会话管理机制：")]),t._v(" "),v("h3",{attrs:{id:"基本概念"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#基本概念"}},[t._v("#")]),t._v(" 基本概念")]),t._v(" "),v("ul",[v("li",[t._v("服务器为每个用户创建的临时会话存储空间")]),t._v(" "),v("li",[t._v("用于保存用户的会话状态")]),t._v(" "),v("li",[t._v("通过 SessionID 来识别不同用户")]),t._v(" "),v("li",[t._v("SessionID 通常保存在 Cookie 中")])]),t._v(" "),v("h3",{attrs:{id:"工作流程"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#工作流程"}},[t._v("#")]),t._v(" 工作流程")]),t._v(" "),v("ul",[v("li",[t._v("用户首次访问服务器时，服务器创建 Session 并生成 SessionID")]),t._v(" "),v("li",[t._v("服务器将 SessionID 通过 Cookie 发送给客户端")]),t._v(" "),v("li",[t._v("客户端后续请求会自动携带包含 SessionID 的 Cookie")]),t._v(" "),v("li",[t._v("服务器通过 SessionID 找到对应 Session 并识别用户")])]),t._v(" "),v("h3",{attrs:{id:"特点"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#特点"}},[t._v("#")]),t._v(" 特点")]),t._v(" "),v("ul",[v("li",[t._v("安全性较高：敏感数据存储在服务器")]),t._v(" "),v("li",[t._v("服务器负载较大：需要存储所有用户的 Session")]),t._v(" "),v("li",[t._v("依赖 Cookie：通常需要 Cookie 来存储 SessionID")]),t._v(" "),v("li",[t._v("集群问题：需要考虑 Session 共享")])]),t._v(" "),v("h3",{attrs:{id:"使用场景-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#使用场景-2"}},[t._v("#")]),t._v(" 使用场景")]),t._v(" "),v("ul",[v("li",[t._v("用户登录状态管理")]),t._v(" "),v("li",[t._v("购物车")]),t._v(" "),v("li",[t._v("权限验证")]),t._v(" "),v("li",[t._v("表单验证")])]),t._v(" "),v("h3",{attrs:{id:"与-cookie-的区别"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#与-cookie-的区别"}},[t._v("#")]),t._v(" 与 Cookie 的区别")]),t._v(" "),v("ul",[v("li",[t._v("存储位置：Session 在服务器，Cookie 在客户端")]),t._v(" "),v("li",[t._v("安全性：Session 较安全，Cookie 相对不安全")]),t._v(" "),v("li",[t._v("存储容量：Session 容量较大，Cookie 通常限制 4KB")]),t._v(" "),v("li",[t._v("性能：Session 消耗服务器资源，Cookie 消耗带宽资源")])]),t._v(" "),v("h2",{attrs:{id:"什么是-jwt-描述它的工作过程"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#什么是-jwt-描述它的工作过程"}},[t._v("#")]),t._v(" 什么是 JWT 描述它的工作过程")]),t._v(" "),v("p",[t._v("JWT (JSON Web Token) 是一种开放标准，用于在各方之间安全地传输信息。")]),t._v(" "),v("h3",{attrs:{id:"组成部分-用-分隔的三部分"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#组成部分-用-分隔的三部分"}},[t._v("#")]),t._v(" 组成部分（用 . 分隔的三部分）")]),t._v(" "),v("ul",[v("li",[t._v("Header（头部）：指定加密算法和令牌类型")]),t._v(" "),v("li",[t._v("Payload（负载）：包含声明（claims）的实际数据")]),t._v(" "),v("li",[t._v("Signature（签名）：对前两部分的签名，用于验证消息未被篡改")])]),t._v(" "),v("h3",{attrs:{id:"工作流程-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#工作流程-2"}},[t._v("#")]),t._v(" 工作流程")]),t._v(" "),v("h4",{attrs:{id:"_1-用户登录成功后-服务器创建-jwt"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-用户登录成功后-服务器创建-jwt"}},[t._v("#")]),t._v(" 1.用户登录成功后，服务器创建 JWT")]),t._v(" "),v("ul",[v("li",[t._v("设置 Header 和 Payload")]),t._v(" "),v("li",[t._v("使用密钥生成签名")]),t._v(" "),v("li",[t._v("将三部分组合成 token")])]),t._v(" "),v("h4",{attrs:{id:"_2-服务器将-token-返回给客户端"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-服务器将-token-返回给客户端"}},[t._v("#")]),t._v(" 2.服务器将 token 返回给客户端")]),t._v(" "),v("ul",[v("li",[t._v("客户端存储在 localStorage 或 cookie 中")])]),t._v(" "),v("h4",{attrs:{id:"_3-客户端后续请求携带-token"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-客户端后续请求携带-token"}},[t._v("#")]),t._v(" 3.客户端后续请求携带 token")]),t._v(" "),v("ul",[v("li",[t._v("通常放在 Authorization header")]),t._v(" "),v("li",[t._v("格式：Bearer "),v("code",[t._v("<token>")])])]),t._v(" "),v("h4",{attrs:{id:"_4-服务器验证-token"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_4-服务器验证-token"}},[t._v("#")]),t._v(" 4.服务器验证 token")]),t._v(" "),v("ul",[v("li",[t._v("检查签名是否有效")]),t._v(" "),v("li",[t._v("验证是否过期")]),t._v(" "),v("li",[t._v("验证其他声明（claims）")])]),t._v(" "),v("h3",{attrs:{id:"特点-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#特点-2"}},[t._v("#")]),t._v(" 特点")]),t._v(" "),v("ul",[v("li",[t._v("无状态：服务器不需要存储会话信息")]),t._v(" "),v("li",[t._v("可扩展：负载部分可以包含自定义数据")]),t._v(" "),v("li",[t._v("跨域友好：可以在不同域名下使用")]),t._v(" "),v("li",[t._v("性能好：验证在服务端完成，不需要查询数据库")])]),t._v(" "),v("h3",{attrs:{id:"安全考虑"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#安全考虑"}},[t._v("#")]),t._v(" 安全考虑")]),t._v(" "),v("ul",[v("li",[t._v("不要在 payload 中存储敏感信息")]),t._v(" "),v("li",[t._v("设置合理的过期时间")]),t._v(" "),v("li",[t._v("使用 HTTPS 传输")]),t._v(" "),v("li",[t._v("妥善保管签名密钥")])]),t._v(" "),v("h2",{attrs:{id:"jwt-如何自动更新-token"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#jwt-如何自动更新-token"}},[t._v("#")]),t._v(" JWT 如何自动更新 token")]),t._v(" "),v("p",[t._v("JWT token 自动更新主要有以下几种方案：")]),t._v(" "),v("h3",{attrs:{id:"双-token-机制"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#双-token-机制"}},[t._v("#")]),t._v(" 双 token 机制")]),t._v(" "),v("ul",[v("li",[t._v("access token：短期令牌，用于接口认证")]),t._v(" "),v("li",[t._v("refresh token：长期令牌，用于刷新 access token")]),t._v(" "),v("li",[t._v("优点：安全性高，即使 access token 泄露影响有限")]),t._v(" "),v("li",[t._v("缺点：实现相对复杂，需要额外存储 refresh token")])]),t._v(" "),v("h4",{attrs:{id:"工作流程-3"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#工作流程-3"}},[t._v("#")]),t._v(" 工作流程")]),t._v(" "),v("ul",[v("li",[t._v("用户登录后获取 access token 和 refresh token")]),t._v(" "),v("li",[t._v("使用 access token 访问接口")]),t._v(" "),v("li",[t._v("access token 过期时，使用 refresh token 获取新的 access token")]),t._v(" "),v("li",[t._v("refresh token 过期时，需要重新登录")])]),t._v(" "),v("div",{staticClass:"language-js extra-class"},[v("pre",{pre:!0,attrs:{class:"language-js"}},[v("code",[v("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 前端示例代码")]),t._v("\n"),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),v("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("url"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("options"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),v("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("headers")]),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),v("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("Authorization")]),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token template-string"}},[v("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),v("span",{pre:!0,attrs:{class:"token string"}},[t._v("Bearer ")]),v("span",{pre:!0,attrs:{class:"token interpolation"}},[v("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),v("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAccessToken")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),v("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),v("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token number"}},[t._v("401")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),v("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// access token 过期，尝试刷新")]),t._v("\n      "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" newToken "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token function"}},[t._v("refreshToken")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newToken"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),v("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用新 token 重试请求")]),t._v("\n        "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),v("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// refresh token 也过期，跳转登录")]),t._v("\n        "),v("span",{pre:!0,attrs:{class:"token function"}},[t._v("redirectToLogin")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" res\n  "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),v("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),v("h3",{attrs:{id:"滑动过期机制"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#滑动过期机制"}},[t._v("#")]),t._v(" 滑动过期机制")]),t._v(" "),v("ul",[v("li",[t._v("每次请求都刷新 token 过期时间")]),t._v(" "),v("li",[t._v("类似于会话超时机制")]),t._v(" "),v("li",[t._v("优点：实现简单，用户体验好")]),t._v(" "),v("li",[t._v("缺点：安全性相对较低")])]),t._v(" "),v("h3",{attrs:{id:"无感刷新机制"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#无感刷新机制"}},[t._v("#")]),t._v(" 无感刷新机制")]),t._v(" "),v("p",[t._v("在 token 即将过期时自动刷新\n可以通过定时器或请求拦截器实现\n优点：用户无感知，体验好\n缺点：需要处理并发请求的问题")]),t._v(" "),v("h3",{attrs:{id:"最佳实践"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践"}},[t._v("#")]),t._v(" 最佳实践")]),t._v(" "),v("ul",[v("li",[t._v("根据业务安全需求选择合适的方案")]),t._v(" "),v("li",[t._v("access token 过期时间不宜过长（如 2 小时）")]),t._v(" "),v("li",[t._v("refresh token 过期时间可以较长（如 7 天）")]),t._v(" "),v("li",[t._v("重要操作仍需要二次验证")]),t._v(" "),v("li",[t._v("考虑 token 注销机制")])]),t._v(" "),v("h2",{attrs:{id:"什么是-sso-单点登录-描述它的工作过程"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#什么是-sso-单点登录-描述它的工作过程"}},[t._v("#")]),t._v(" 什么是 SSO 单点登录，描述它的工作过程")]),t._v(" "),v("p",[t._v("SSO (Single Sign On) 单点登录是一种身份验证机制，允许用户使用一组凭证访问多个相关但独立的系统。")]),t._v(" "),v("h3",{attrs:{id:"基本概念-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#基本概念-2"}},[t._v("#")]),t._v(" 基本概念")]),t._v(" "),v("ul",[v("li",[t._v("一次登录，全局通用")]),t._v(" "),v("li",[t._v("多个子系统共享用户会话")]),t._v(" "),v("li",[t._v("统一的认证中心")]),t._v(" "),v("li",[t._v("提高用户体验和安全性")])]),t._v(" "),v("h3",{attrs:{id:"工作流程-4"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#工作流程-4"}},[t._v("#")]),t._v(" 工作流程")]),t._v(" "),v("h4",{attrs:{id:"用户首次访问系统"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#用户首次访问系统"}},[t._v("#")]),t._v(" 用户首次访问系统")]),t._v(" "),v("ul",[v("li",[t._v("用户访问系统 A")]),t._v(" "),v("li",[t._v("系统 A 检查无登录状态")]),t._v(" "),v("li",[t._v("重定向到 SSO 认证中心")]),t._v(" "),v("li",[t._v("带上系统 A 的地址作为参数")])]),t._v(" "),v("h4",{attrs:{id:"sso-认证中心处理"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#sso-认证中心处理"}},[t._v("#")]),t._v(" SSO 认证中心处理")]),t._v(" "),v("ul",[v("li",[t._v("检查用户是否已登录 SSO")]),t._v(" "),v("li",[t._v("未登录则显示登录页面")]),t._v(" "),v("li",[t._v("用户输入账号密码")]),t._v(" "),v("li",[t._v("认证中心验证身份")])]),t._v(" "),v("h4",{attrs:{id:"回到系统-a"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#回到系统-a"}},[t._v("#")]),t._v(" 回到系统 A")]),t._v(" "),v("ul",[v("li",[t._v("SSO 生成票据（ticket）")]),t._v(" "),v("li",[t._v("重定向回系统 A")]),t._v(" "),v("li",[t._v("带上票据参数")]),t._v(" "),v("li",[t._v("系统 A 验证票据")]),t._v(" "),v("li",[t._v("创建本地会话")])]),t._v(" "),v("h4",{attrs:{id:"访问系统-b"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#访问系统-b"}},[t._v("#")]),t._v(" 访问系统 B")]),t._v(" "),v("ul",[v("li",[t._v("用户访问系统 B")]),t._v(" "),v("li",[t._v("系统 B 检查无登录状态")]),t._v(" "),v("li",[t._v("重定向到 SSO 认证中心")]),t._v(" "),v("li",[t._v("SSO 发现用户已登录")]),t._v(" "),v("li",[t._v("直接生成票据返回")]),t._v(" "),v("li",[t._v("系统 B 验证票据")]),t._v(" "),v("li",[t._v("创建本地会话")])]),t._v(" "),v("h3",{attrs:{id:"实现方式"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#实现方式"}},[t._v("#")]),t._v(" 实现方式")]),t._v(" "),v("ul",[v("li",[t._v("基于 Cookie")]),t._v(" "),v("li",[t._v("基于 Token")]),t._v(" "),v("li",[t._v("基于 SAML")]),t._v(" "),v("li",[t._v("基于 OAuth")]),t._v(" "),v("li",[t._v("基于 CAS")])]),t._v(" "),v("h3",{attrs:{id:"优点-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#优点-2"}},[t._v("#")]),t._v(" 优点")]),t._v(" "),v("ul",[v("li",[t._v("提升用户体验")]),t._v(" "),v("li",[t._v("减少密码管理")]),t._v(" "),v("li",[t._v("统一认证流程")]),t._v(" "),v("li",[t._v("提高安全性")])]),t._v(" "),v("h3",{attrs:{id:"缺点-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#缺点-2"}},[t._v("#")]),t._v(" 缺点")]),t._v(" "),v("ul",[v("li",[t._v("认证中心单点故障")]),t._v(" "),v("li",[t._v("配置相对复杂")]),t._v(" "),v("li",[t._v("需要额外的安全考虑")])]),t._v(" "),v("h2",{attrs:{id:"什么是跨域-如何实现跨域通讯"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#什么是跨域-如何实现跨域通讯"}},[t._v("#")]),t._v(" 什么是跨域？如何实现跨域通讯")]),t._v(" "),v("p",[t._v("跨域是指浏览器的同源策略限制，当前域名的 JavaScript 代码试图访问其他域名下的资源时会受到限制。")]),t._v(" "),v("p",[t._v("同源的定义：")]),t._v(" "),v("ul",[v("li",[t._v("协议相同（http/https）")]),t._v(" "),v("li",[t._v("域名相同")]),t._v(" "),v("li",[t._v("端口相同")])]),t._v(" "),v("h3",{attrs:{id:"跨域解决方案"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#跨域解决方案"}},[t._v("#")]),t._v(" 跨域解决方案")]),t._v(" "),v("h4",{attrs:{id:"cors-跨域资源共享"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#cors-跨域资源共享"}},[t._v("#")]),t._v(" CORS（跨域资源共享）")]),t._v(" "),v("ul",[v("li",[t._v("服务器设置 Access-Control-Allow-Origin 等响应头")]),t._v(" "),v("li",[t._v("可以配置允许的请求方法、请求头、是否允许携带认证信息等")]),t._v(" "),v("li",[t._v("最常用的跨域解决方案")])]),t._v(" "),v("h4",{attrs:{id:"jsonp"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#jsonp"}},[t._v("#")]),t._v(" JSONP")]),t._v(" "),v("ul",[v("li",[t._v("利用 "),v("code",[t._v("<script>")]),t._v(" 标签不受同源策略限制的特点，实现跨域请求")]),t._v(" "),v("li",[t._v("只支持 GET 请求")]),t._v(" "),v("li",[t._v("需要服务器配合返回 JavaScript 代码")])]),t._v(" "),v("h4",{attrs:{id:"proxy代理服务器"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#proxy代理服务器"}},[t._v("#")]),t._v(" Proxy代理服务器")]),t._v(" "),v("ul",[v("li",[t._v("开发环境：webpack-dev-server、vite 等的 proxy 配置")]),t._v(" "),v("li",[t._v("生产环境：Nginx 反向代理")])]),t._v(" "),v("h4",{attrs:{id:"websocket"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#websocket"}},[t._v("#")]),t._v(" WebSocket")]),t._v(" "),v("ul",[v("li",[t._v("建立在 TCP 之上的协议")]),t._v(" "),v("li",[t._v("天然支持跨域")]),t._v(" "),v("li",[t._v("适合需要实时通信的场景")])]),t._v(" "),v("h4",{attrs:{id:"postmessage"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#postmessage"}},[t._v("#")]),t._v(" postMessage")]),t._v(" "),v("ul",[v("li",[t._v("HTML5 标准中的 API")]),t._v(" "),v("li",[t._v("用于不同窗口间的跨域通信")]),t._v(" "),v("li",[t._v("可以在父子页面（iframe）或者多窗口间通信")])]),t._v(" "),v("p",[t._v("最佳实践：")]),t._v(" "),v("ul",[v("li",[t._v("优先使用 CORS，配置得当的情况下最安全")]),t._v(" "),v("li",[t._v("需要兼容旧浏览器时可以考虑 JSONP")]),t._v(" "),v("li",[t._v("开发环境优先使用代理服务器")]),t._v(" "),v("li",[t._v("特殊场景（如页面通信）可以考虑 postMessage")]),t._v(" "),v("li",[t._v("需要实时通信时使用 WebSocket")])]),t._v(" "),v("h2",{attrs:{id:"http-请求跨域时为何要发送-options-请求"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#http-请求跨域时为何要发送-options-请求"}},[t._v("#")]),t._v(" HTTP 请求跨域时为何要发送 options 请求")]),t._v(" "),v("p",[t._v("OPTIONS 请求是 CORS 预检请求(Preflight Request)，用于检查实际请求是否可以安全地发送。")]),t._v(" "),v("p",[t._v("触发条件：")]),t._v(" "),v("ul",[v("li",[t._v("使用非简单请求方法：除 GET、POST、HEAD 之外的方法")]),t._v(" "),v("li",[t._v("使用非简单请求头：除 Accept、Accept-Language、Content-Language、Content-Type 之外的请求头")]),t._v(" "),v("li",[t._v("Content-Type 不是以下之一：\n"),v("ul",[v("li",[t._v("application/x-www-form-urlencoded")]),t._v(" "),v("li",[t._v("multipart/form-data")]),t._v(" "),v("li",[t._v("text/plain")])])])]),t._v(" "),v("h3",{attrs:{id:"工作流程-5"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#工作流程-5"}},[t._v("#")]),t._v(" 工作流程")]),t._v(" "),v("p",[t._v("浏览器发送 OPTIONS 预检请求，包含：")]),t._v(" "),v("ul",[v("li",[t._v("Origin：请求来源")]),t._v(" "),v("li",[t._v("Access-Control-Request-Method：实际请求使用的方法")]),t._v(" "),v("li",[t._v("Access-Control-Request-Headers：实际请求使用的请求头")])]),t._v(" "),v("p",[t._v("服务器响应预检请求，返回：")]),t._v(" "),v("ul",[v("li",[t._v("Access-Control-Allow-Origin：允许的源")]),t._v(" "),v("li",[t._v("Access-Control-Allow-Methods：允许的方法")]),t._v(" "),v("li",[t._v("Access-Control-Allow-Headers：允许的请求头")]),t._v(" "),v("li",[t._v("Access-Control-Max-Age：预检请求的缓存时间")])]),t._v(" "),v("p",[t._v("如果预检通过，浏览器才会发送实际请求")]),t._v(" "),v("p",[t._v("优化建议：")]),t._v(" "),v("ul",[v("li",[t._v("尽可能使用简单请求，避免触发预检")]),t._v(" "),v("li",[t._v("合理设置 Access-Control-Max-Age 缓存预检结果")]),t._v(" "),v("li",[t._v("服务端正确配置 CORS 响应头")])]),t._v(" "),v("h2",{attrs:{id:"options-请求会携带-cookie-吗"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#options-请求会携带-cookie-吗"}},[t._v("#")]),t._v(" options 请求会携带 cookie 吗")]),t._v(" "),v("p",[t._v("OPTIONS 请求通常不会携带 Cookie。它是一个预检请求，用于检查实际请求是否可以安全地发送。浏览器在发送 OPTIONS 请求时，不会自动附带 Cookie 和 Authorization 等认证信息，除非明确设置了 credentials 选项。")]),t._v(" "),v("p",[t._v("如果需要在 OPTIONS 请求中携带 Cookie，可以在请求中设置 credentials: 'include'，但通常不推荐这样做，因为 OPTIONS 请求的目的就是检查跨域请求的安全性，而不是进行身份验证。")]),t._v(" "),v("h2",{attrs:{id:"简述浏览器的缓存策略"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#简述浏览器的缓存策略"}},[t._v("#")]),t._v(" 简述浏览器的缓存策略")]),t._v(" "),v("p",[t._v("浏览器缓存策略主要分为两种：强缓存和协商缓存。")]),t._v(" "),v("h3",{attrs:{id:"强缓存"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#强缓存"}},[t._v("#")]),t._v(" 强缓存")]),t._v(" "),v("ul",[v("li",[t._v("不需要向服务器发送请求，直接使用本地缓存")]),t._v(" "),v("li",[t._v("通过 HTTP 响应头控制：\n"),v("ul",[v("li",[t._v("Cache-Control：\n"),v("ul",[v("li",[t._v("max-age：缓存有效时间（秒）")]),t._v(" "),v("li",[t._v("no-cache：需要和服务器协商验证")]),t._v(" "),v("li",[t._v("no-store：不使用任何缓存")]),t._v(" "),v("li",[t._v("private：仅浏览器可缓存")]),t._v(" "),v("li",[t._v("public：中间代理/CDN 等也可缓存")]),t._v(" "),v("li",[t._v("Expires：过期时间点（已被 Cache-Control 取代）")])])])])])]),t._v(" "),v("h3",{attrs:{id:"协商缓存"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#协商缓存"}},[t._v("#")]),t._v(" 协商缓存")]),t._v(" "),v("ul",[v("li",[t._v("需要向服务器发送请求验证资源是否有效")]),t._v(" "),v("li",[t._v("如果有效返回 304，使用本地缓存")]),t._v(" "),v("li",[t._v("通过以下响应头实现：\n"),v("ul",[v("li",[t._v("Last-Modified/If-Modified-Since：基于文件修改时间")]),t._v(" "),v("li",[t._v("ETag/If-None-Match：基于文件内容哈希值")])])])]),t._v(" "),v("h3",{attrs:{id:"缓存位置-优先级从高到低"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#缓存位置-优先级从高到低"}},[t._v("#")]),t._v(" 缓存位置（优先级从高到低）")]),t._v(" "),v("ul",[v("li",[t._v("Service Worker")]),t._v(" "),v("li",[t._v("Memory Cache（内存缓存）")]),t._v(" "),v("li",[t._v("Disk Cache（硬盘缓存）")]),t._v(" "),v("li",[t._v("Push Cache（HTTP/2）")])]),t._v(" "),v("h3",{attrs:{id:"缓存优先级"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#缓存优先级"}},[t._v("#")]),t._v(" 缓存优先级")]),t._v(" "),v("p",[t._v("Service Worker -> Memory Cache -> Disk Cache -> Push Cache")]),t._v(" "),v("h3",{attrs:{id:"缓存策略"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#缓存策略"}},[t._v("#")]),t._v(" 缓存策略")]),t._v(" "),v("ul",[v("li",[t._v("强缓存优先于协商缓存")]),t._v(" "),v("li",[t._v("协商缓存由服务器决定是否使用缓存")]),t._v(" "),v("li",[t._v("协商缓存失效，返回 200，重新返回资源和缓存标识，再存入浏览器缓存中")]),t._v(" "),v("li",[t._v("协商缓存生效，返回 304，继续使用缓存")])]),t._v(" "),v("h3",{attrs:{id:"最佳实践-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践-2"}},[t._v("#")]),t._v(" 最佳实践")]),t._v(" "),v("ul",[v("li",[t._v("HTML：使用协商缓存")]),t._v(" "),v("li",[t._v("CSS、JS、图片：使用强缓存，文件名带 hash")]),t._v(" "),v("li",[t._v("API 请求：根据业务需求设置合适的缓存策略")])]),t._v(" "),v("h2",{attrs:{id:"什么是图片防盗链-如何实现"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#什么是图片防盗链-如何实现"}},[t._v("#")]),t._v(" 什么是图片防盗链，如何实现")]),t._v(" "),v("p",[t._v("图片防盗链是指服务器通过 HTTP 协议中的 Referer 字段来判断请求是否来自合法站点，从而防止其他网站直接引用本站图片资源。")]),t._v(" "),v("p",[t._v("实现方式：")]),t._v(" "),v("p",[t._v("服务器端实现")]),t._v(" "),v("ul",[v("li",[t._v("检查 HTTP Referer 字段")]),t._v(" "),v("li",[t._v("判断请求来源是否在白名单中")]),t._v(" "),v("li",[t._v("对非法请求返回 403 或替代图片")])]),t._v(" "),v("div",{staticClass:"language-nginx extra-class"},[v("pre",{pre:!0,attrs:{class:"language-nginx"}},[v("code",[v("span",{pre:!0,attrs:{class:"token directive"}},[v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" ~ .*\\.(gif|jpg|jpeg|png|bmp)$")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),v("span",{pre:!0,attrs:{class:"token directive"}},[v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("valid_referers")]),t._v(" none blocked server_names *.example.com")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),v("span",{pre:!0,attrs:{class:"token directive"}},[v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" ("),v("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$invalid_referer")]),t._v(")")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),v("span",{pre:!0,attrs:{class:"token directive"}},[v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")])]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),v("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或者返回替代图片")]),t._v("\n        "),v("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# rewrite ^/ /path/to/default.jpg break;")]),t._v("\n    "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),v("h3",{attrs:{id:"其他防盗链方案"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#其他防盗链方案"}},[t._v("#")]),t._v(" 其他防盗链方案")]),t._v(" "),v("ul",[v("li",[t._v("给图片添加水印")]),t._v(" "),v("li",[t._v("使用 Token 验证")]),t._v(" "),v("li",[t._v("使用 CDN 提供的防盗链功能")]),t._v(" "),v("li",[t._v("对图片进行加密处理")])]),t._v(" "),v("h3",{attrs:{id:"注意事项"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[t._v("#")]),t._v(" 注意事项")]),t._v(" "),v("ul",[v("li",[t._v("Referer 可以被伪造，不能作为唯一判断依据")]),t._v(" "),v("li",[t._v("移动端 APP 可能不发送 Referer")]),t._v(" "),v("li",[t._v("部分浏览器可能禁用 Referer")]),t._v(" "),v("li",[t._v("需要考虑用户体验和 SEO 影响")])])])}),[],!1,null,null,null);v.default=s.exports}}]);